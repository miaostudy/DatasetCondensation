nohup: ignoring input
2024-11-21 20:46:30: eval_it_pool: [0, 500, 1000]
2024-11-21 20:46:38: 
================== Exp 0 ==================
 
2024-11-21 20:46:38: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'OrganCMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f5adcdf2ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_OrganCMNIST (INFO)>}
2024-11-21 20:46:38: Evaluation model pool: ['ConvNet']
2024-11-21 20:46:42: class c = 0: 1148 real images
2024-11-21 20:46:42: class c = 1: 619 real images
2024-11-21 20:46:42: class c = 2: 595 real images
2024-11-21 20:46:42: class c = 3: 600 real images
2024-11-21 20:46:42: class c = 4: 1088 real images
2024-11-21 20:46:42: class c = 5: 1170 real images
2024-11-21 20:46:42: class c = 6: 2986 real images
2024-11-21 20:46:42: class c = 7: 1002 real images
2024-11-21 20:46:42: class c = 8: 1022 real images
2024-11-21 20:46:42: class c = 9: 1173 real images
2024-11-21 20:46:42: class c = 10: 1572 real images
2024-11-21 20:46:42: real images channel 0, mean = 0.4942, std = 0.2834
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
main_base.py:125: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1666642975312/work/torch/csrc/utils/tensor_new.cpp:230.)
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-21 20:46:42: initialize synthetic data from random real images
2024-11-21 20:46:43: [2024-11-21 20:46:43] training begins
2024-11-21 20:46:43: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-21 20:46:43: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-21 20:46:43: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1666642975312/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 20:48:51: Evaluate 5 random ConvNet, ACCmean = 0.7138 ACCstd = 0.0036
-------------------------
2024-11-21 20:48:51: Evaluate 5 random ConvNet, F1mean = 0.6970 F!std = 0.0035
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 20:49:12: [2024-11-21 20:49:12] iter = 0000, loss = 55.7921
2024-11-21 20:51:57: [2024-11-21 20:51:57] iter = 0010, loss = 42.4587
2024-11-21 20:54:45: [2024-11-21 20:54:45] iter = 0020, loss = 39.4151
2024-11-21 20:57:26: [2024-11-21 20:57:26] iter = 0030, loss = 37.7040
2024-11-21 21:00:16: [2024-11-21 21:00:16] iter = 0040, loss = 38.5969
2024-11-21 21:03:05: [2024-11-21 21:03:05] iter = 0050, loss = 36.5392
2024-11-21 21:05:55: [2024-11-21 21:05:55] iter = 0060, loss = 45.0278
2024-11-21 21:08:46: [2024-11-21 21:08:46] iter = 0070, loss = 40.9386
2024-11-21 21:11:33: [2024-11-21 21:11:33] iter = 0080, loss = 37.2852
2024-11-21 21:14:18: [2024-11-21 21:14:18] iter = 0090, loss = 41.2706
2024-11-21 21:17:10: [2024-11-21 21:17:10] iter = 0100, loss = 37.0705
2024-11-21 21:19:53: [2024-11-21 21:19:53] iter = 0110, loss = 35.8520
2024-11-21 21:22:38: [2024-11-21 21:22:38] iter = 0120, loss = 29.1417
2024-11-21 21:25:33: [2024-11-21 21:25:33] iter = 0130, loss = 32.0482
2024-11-21 21:28:16: [2024-11-21 21:28:16] iter = 0140, loss = 37.0881
2024-11-21 21:31:00: [2024-11-21 21:31:00] iter = 0150, loss = 36.6902
2024-11-21 21:33:43: [2024-11-21 21:33:43] iter = 0160, loss = 28.7918
2024-11-21 21:36:29: [2024-11-21 21:36:29] iter = 0170, loss = 33.5779
2024-11-21 21:39:18: [2024-11-21 21:39:18] iter = 0180, loss = 32.6291
2024-11-21 21:42:02: [2024-11-21 21:42:02] iter = 0190, loss = 34.8978
2024-11-21 21:44:46: [2024-11-21 21:44:46] iter = 0200, loss = 32.1075
2024-11-21 21:47:27: [2024-11-21 21:47:27] iter = 0210, loss = 31.7015
2024-11-21 21:50:12: [2024-11-21 21:50:12] iter = 0220, loss = 43.6820
2024-11-21 21:52:53: [2024-11-21 21:52:53] iter = 0230, loss = 33.1994
2024-11-21 21:55:33: [2024-11-21 21:55:33] iter = 0240, loss = 26.5247
2024-11-21 21:58:15: [2024-11-21 21:58:15] iter = 0250, loss = 34.0198
2024-11-21 22:00:58: [2024-11-21 22:00:58] iter = 0260, loss = 30.9296
2024-11-21 22:03:37: [2024-11-21 22:03:37] iter = 0270, loss = 37.1486
2024-11-21 22:06:22: [2024-11-21 22:06:22] iter = 0280, loss = 33.6525
2024-11-21 22:09:06: [2024-11-21 22:09:06] iter = 0290, loss = 34.5922
2024-11-21 22:11:44: [2024-11-21 22:11:44] iter = 0300, loss = 29.1763
2024-11-21 22:14:26: [2024-11-21 22:14:26] iter = 0310, loss = 28.4859
2024-11-21 22:17:08: [2024-11-21 22:17:08] iter = 0320, loss = 27.8139
2024-11-21 22:19:48: [2024-11-21 22:19:48] iter = 0330, loss = 35.8767
2024-11-21 22:22:37: [2024-11-21 22:22:37] iter = 0340, loss = 35.4316
2024-11-21 22:25:17: [2024-11-21 22:25:17] iter = 0350, loss = 33.4208
2024-11-21 22:27:54: [2024-11-21 22:27:54] iter = 0360, loss = 28.9632
2024-11-21 22:30:36: [2024-11-21 22:30:36] iter = 0370, loss = 32.1560
2024-11-21 22:33:19: [2024-11-21 22:33:19] iter = 0380, loss = 36.5077
2024-11-21 22:35:59: [2024-11-21 22:35:59] iter = 0390, loss = 35.7058
2024-11-21 22:38:39: [2024-11-21 22:38:39] iter = 0400, loss = 36.3914
2024-11-21 22:41:19: [2024-11-21 22:41:19] iter = 0410, loss = 30.0628
2024-11-21 22:43:54: [2024-11-21 22:43:54] iter = 0420, loss = 33.4183
2024-11-21 22:46:33: [2024-11-21 22:46:33] iter = 0430, loss = 32.1708
2024-11-21 22:49:06: [2024-11-21 22:49:06] iter = 0440, loss = 31.3992
2024-11-21 22:51:59: [2024-11-21 22:51:59] iter = 0450, loss = 37.6834
2024-11-21 22:54:46: [2024-11-21 22:54:46] iter = 0460, loss = 35.7303
2024-11-21 22:57:30: [2024-11-21 22:57:30] iter = 0470, loss = 30.0115
2024-11-21 23:00:12: [2024-11-21 23:00:12] iter = 0480, loss = 38.3205
2024-11-21 23:03:00: [2024-11-21 23:03:00] iter = 0490, loss = 33.1717
2024-11-21 23:05:27: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-21 23:05:27: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-21 23:05:27: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 27275}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 23:07:24: Evaluate 5 random ConvNet, ACCmean = 0.7985 ACCstd = 0.0029
-------------------------
2024-11-21 23:07:24: Evaluate 5 random ConvNet, F1mean = 0.7824 F!std = 0.0030
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 23:07:40: [2024-11-21 23:07:40] iter = 0500, loss = 36.1830
2024-11-21 23:10:17: [2024-11-21 23:10:17] iter = 0510, loss = 28.0857
2024-11-21 23:12:59: [2024-11-21 23:12:59] iter = 0520, loss = 34.0332
2024-11-21 23:15:36: [2024-11-21 23:15:36] iter = 0530, loss = 35.5474
2024-11-21 23:18:12: [2024-11-21 23:18:12] iter = 0540, loss = 25.2434
2024-11-21 23:20:51: [2024-11-21 23:20:51] iter = 0550, loss = 27.4453
2024-11-21 23:23:30: [2024-11-21 23:23:30] iter = 0560, loss = 37.4980
2024-11-21 23:26:14: [2024-11-21 23:26:14] iter = 0570, loss = 36.5256
2024-11-21 23:28:56: [2024-11-21 23:28:56] iter = 0580, loss = 32.5705
2024-11-21 23:31:36: [2024-11-21 23:31:36] iter = 0590, loss = 29.7579
2024-11-21 23:34:21: [2024-11-21 23:34:21] iter = 0600, loss = 34.5793
2024-11-21 23:37:01: [2024-11-21 23:37:01] iter = 0610, loss = 29.1220
2024-11-21 23:39:42: [2024-11-21 23:39:42] iter = 0620, loss = 33.7398
2024-11-21 23:42:20: [2024-11-21 23:42:20] iter = 0630, loss = 35.0811
2024-11-21 23:44:49: [2024-11-21 23:44:48] iter = 0640, loss = 33.2222
2024-11-21 23:47:15: [2024-11-21 23:47:15] iter = 0650, loss = 36.6642
2024-11-21 23:49:45: [2024-11-21 23:49:45] iter = 0660, loss = 35.1217
2024-11-21 23:52:14: [2024-11-21 23:52:14] iter = 0670, loss = 26.7251
2024-11-21 23:54:50: [2024-11-21 23:54:50] iter = 0680, loss = 35.7210
2024-11-21 23:57:19: [2024-11-21 23:57:19] iter = 0690, loss = 28.0370
2024-11-21 23:59:51: [2024-11-21 23:59:51] iter = 0700, loss = 29.4814
2024-11-22 00:02:19: [2024-11-22 00:02:19] iter = 0710, loss = 29.0213
2024-11-22 00:04:47: [2024-11-22 00:04:47] iter = 0720, loss = 32.7370
2024-11-22 00:07:19: [2024-11-22 00:07:19] iter = 0730, loss = 26.5561
2024-11-22 00:09:53: [2024-11-22 00:09:53] iter = 0740, loss = 32.6411
2024-11-22 00:12:35: [2024-11-22 00:12:35] iter = 0750, loss = 33.0100
2024-11-22 00:15:12: [2024-11-22 00:15:12] iter = 0760, loss = 33.6146
2024-11-22 00:17:54: [2024-11-22 00:17:54] iter = 0770, loss = 31.2969
2024-11-22 00:20:36: [2024-11-22 00:20:36] iter = 0780, loss = 25.2617
2024-11-22 00:23:17: [2024-11-22 00:23:17] iter = 0790, loss = 25.7745
2024-11-22 00:26:00: [2024-11-22 00:26:00] iter = 0800, loss = 29.4051
2024-11-22 00:28:43: [2024-11-22 00:28:43] iter = 0810, loss = 33.7420
2024-11-22 00:31:21: [2024-11-22 00:31:21] iter = 0820, loss = 22.0757
2024-11-22 00:34:02: [2024-11-22 00:34:02] iter = 0830, loss = 30.6186
2024-11-22 00:36:45: [2024-11-22 00:36:45] iter = 0840, loss = 37.1284
2024-11-22 00:39:27: [2024-11-22 00:39:27] iter = 0850, loss = 31.1442
2024-11-22 00:42:04: [2024-11-22 00:42:04] iter = 0860, loss = 34.8139
2024-11-22 00:44:47: [2024-11-22 00:44:47] iter = 0870, loss = 25.9597
2024-11-22 00:47:45: [2024-11-22 00:47:45] iter = 0880, loss = 31.8536
2024-11-22 00:50:39: [2024-11-22 00:50:39] iter = 0890, loss = 32.1416
2024-11-22 00:53:21: [2024-11-22 00:53:21] iter = 0900, loss = 27.7989
2024-11-22 00:56:03: [2024-11-22 00:56:03] iter = 0910, loss = 25.0382
2024-11-22 00:58:42: [2024-11-22 00:58:42] iter = 0920, loss = 27.5131
2024-11-22 01:01:20: [2024-11-22 01:01:20] iter = 0930, loss = 31.1725
2024-11-22 01:03:53: [2024-11-22 01:03:53] iter = 0940, loss = 32.5130
2024-11-22 01:06:34: [2024-11-22 01:06:34] iter = 0950, loss = 31.1493
2024-11-22 01:09:08: [2024-11-22 01:09:08] iter = 0960, loss = 31.2889
2024-11-22 01:11:45: [2024-11-22 01:11:45] iter = 0970, loss = 24.0384
2024-11-22 01:14:39: [2024-11-22 01:14:39] iter = 0980, loss = 34.4275
2024-11-22 01:17:23: [2024-11-22 01:17:23] iter = 0990, loss = 31.0734
2024-11-22 01:19:54: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 01:19:54: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 01:19:54: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 94696}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 01:21:48: Evaluate 5 random ConvNet, ACCmean = 0.8106 ACCstd = 0.0018
-------------------------
2024-11-22 01:21:48: Evaluate 5 random ConvNet, F1mean = 0.7945 F!std = 0.0015
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 01:22:06: [2024-11-22 01:22:06] iter = 1000, loss = 28.4160
2024-11-22 01:22:06: 
================== Exp 1 ==================
 
2024-11-22 01:22:06: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'OrganCMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f5adcdf2ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_OrganCMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 01:22:06: Evaluation model pool: ['ConvNet']
2024-11-22 01:22:07: class c = 0: 1148 real images
2024-11-22 01:22:07: class c = 1: 619 real images
2024-11-22 01:22:07: class c = 2: 595 real images
2024-11-22 01:22:07: class c = 3: 600 real images
2024-11-22 01:22:07: class c = 4: 1088 real images
2024-11-22 01:22:07: class c = 5: 1170 real images
2024-11-22 01:22:07: class c = 6: 2986 real images
2024-11-22 01:22:07: class c = 7: 1002 real images
2024-11-22 01:22:07: class c = 8: 1022 real images
2024-11-22 01:22:07: class c = 9: 1173 real images
2024-11-22 01:22:07: class c = 10: 1572 real images
2024-11-22 01:22:07: real images channel 0, mean = 0.4942, std = 0.2834
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 01:22:07: initialize synthetic data from random real images
2024-11-22 01:22:07: [2024-11-22 01:22:07] training begins
2024-11-22 01:22:07: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 01:22:07: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 01:22:07: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 25772}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 01:24:05: Evaluate 5 random ConvNet, ACCmean = 0.7157 ACCstd = 0.0052
-------------------------
2024-11-22 01:24:05: Evaluate 5 random ConvNet, F1mean = 0.6996 F!std = 0.0041
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 01:24:21: [2024-11-22 01:24:21] iter = 0000, loss = 54.0399
2024-11-22 01:27:04: [2024-11-22 01:27:04] iter = 0010, loss = 58.5383
2024-11-22 01:29:41: [2024-11-22 01:29:41] iter = 0020, loss = 40.6198
2024-11-22 01:32:19: [2024-11-22 01:32:19] iter = 0030, loss = 45.3217
2024-11-22 01:34:57: [2024-11-22 01:34:57] iter = 0040, loss = 44.6719
2024-11-22 01:37:23: [2024-11-22 01:37:23] iter = 0050, loss = 35.0260
2024-11-22 01:39:53: [2024-11-22 01:39:53] iter = 0060, loss = 31.6308
2024-11-22 01:42:25: [2024-11-22 01:42:25] iter = 0070, loss = 31.4615
2024-11-22 01:44:58: [2024-11-22 01:44:58] iter = 0080, loss = 39.9108
2024-11-22 01:47:37: [2024-11-22 01:47:37] iter = 0090, loss = 30.2593
2024-11-22 01:50:12: [2024-11-22 01:50:12] iter = 0100, loss = 45.2458
2024-11-22 01:52:48: [2024-11-22 01:52:48] iter = 0110, loss = 31.4595
2024-11-22 01:55:20: [2024-11-22 01:55:20] iter = 0120, loss = 33.3512
2024-11-22 01:57:54: [2024-11-22 01:57:54] iter = 0130, loss = 34.2627
2024-11-22 02:00:26: [2024-11-22 02:00:26] iter = 0140, loss = 34.7326
2024-11-22 02:03:05: [2024-11-22 02:03:05] iter = 0150, loss = 38.4925
2024-11-22 02:05:42: [2024-11-22 02:05:42] iter = 0160, loss = 31.5168
2024-11-22 02:08:28: [2024-11-22 02:08:28] iter = 0170, loss = 39.1277
2024-11-22 02:11:15: [2024-11-22 02:11:15] iter = 0180, loss = 35.1394
2024-11-22 02:13:46: [2024-11-22 02:13:46] iter = 0190, loss = 37.0922
2024-11-22 02:16:24: [2024-11-22 02:16:24] iter = 0200, loss = 32.1400
2024-11-22 02:19:00: [2024-11-22 02:19:00] iter = 0210, loss = 35.2468
2024-11-22 02:21:34: [2024-11-22 02:21:34] iter = 0220, loss = 33.4806
2024-11-22 02:24:09: [2024-11-22 02:24:09] iter = 0230, loss = 39.0306
2024-11-22 02:26:59: [2024-11-22 02:26:59] iter = 0240, loss = 26.8632
2024-11-22 02:29:42: [2024-11-22 02:29:42] iter = 0250, loss = 34.7498
2024-11-22 02:32:24: [2024-11-22 02:32:24] iter = 0260, loss = 35.9532
2024-11-22 02:35:08: [2024-11-22 02:35:08] iter = 0270, loss = 32.3753
2024-11-22 02:37:47: [2024-11-22 02:37:47] iter = 0280, loss = 36.2098
2024-11-22 02:40:29: [2024-11-22 02:40:29] iter = 0290, loss = 27.3027
2024-11-22 02:43:11: [2024-11-22 02:43:11] iter = 0300, loss = 32.4957
2024-11-22 02:45:50: [2024-11-22 02:45:50] iter = 0310, loss = 40.4598
2024-11-22 02:48:26: [2024-11-22 02:48:26] iter = 0320, loss = 31.4535
2024-11-22 02:51:08: [2024-11-22 02:51:08] iter = 0330, loss = 37.0504
2024-11-22 02:53:54: [2024-11-22 02:53:54] iter = 0340, loss = 33.3561
2024-11-22 02:56:33: [2024-11-22 02:56:33] iter = 0350, loss = 26.8825
2024-11-22 02:59:12: [2024-11-22 02:59:12] iter = 0360, loss = 37.1500
2024-11-22 03:01:52: [2024-11-22 03:01:52] iter = 0370, loss = 36.5057
2024-11-22 03:04:30: [2024-11-22 03:04:30] iter = 0380, loss = 32.6832
2024-11-22 03:07:14: [2024-11-22 03:07:14] iter = 0390, loss = 29.1543
2024-11-22 03:09:52: [2024-11-22 03:09:52] iter = 0400, loss = 35.1083
2024-11-22 03:12:31: [2024-11-22 03:12:31] iter = 0410, loss = 32.5602
2024-11-22 03:15:12: [2024-11-22 03:15:12] iter = 0420, loss = 37.5909
2024-11-22 03:17:58: [2024-11-22 03:17:58] iter = 0430, loss = 32.6195
2024-11-22 03:20:38: [2024-11-22 03:20:38] iter = 0440, loss = 31.4997
2024-11-22 03:23:30: [2024-11-22 03:23:30] iter = 0450, loss = 37.6910
2024-11-22 03:26:10: [2024-11-22 03:26:10] iter = 0460, loss = 36.2865
2024-11-22 03:28:44: [2024-11-22 03:28:44] iter = 0470, loss = 33.0327
2024-11-22 03:31:24: [2024-11-22 03:31:24] iter = 0480, loss = 27.9410
2024-11-22 03:33:58: [2024-11-22 03:33:58] iter = 0490, loss = 27.3519
2024-11-22 03:36:22: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 03:36:22: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 03:36:22: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 82495}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 03:38:16: Evaluate 5 random ConvNet, ACCmean = 0.7948 ACCstd = 0.0047
-------------------------
2024-11-22 03:38:16: Evaluate 5 random ConvNet, F1mean = 0.7802 F!std = 0.0052
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 03:38:33: [2024-11-22 03:38:33] iter = 0500, loss = 31.1004
2024-11-22 03:41:11: [2024-11-22 03:41:11] iter = 0510, loss = 31.2803
2024-11-22 03:43:54: [2024-11-22 03:43:54] iter = 0520, loss = 32.7214
2024-11-22 03:46:34: [2024-11-22 03:46:34] iter = 0530, loss = 27.2444
2024-11-22 03:49:11: [2024-11-22 03:49:11] iter = 0540, loss = 33.4118
2024-11-22 03:51:46: [2024-11-22 03:51:46] iter = 0550, loss = 35.9265
2024-11-22 03:54:26: [2024-11-22 03:54:26] iter = 0560, loss = 32.3064
2024-11-22 03:57:00: [2024-11-22 03:57:00] iter = 0570, loss = 31.1613
2024-11-22 03:59:33: [2024-11-22 03:59:33] iter = 0580, loss = 31.9925
2024-11-22 04:02:12: [2024-11-22 04:02:12] iter = 0590, loss = 32.4156
2024-11-22 04:04:54: [2024-11-22 04:04:54] iter = 0600, loss = 33.2212
2024-11-22 04:07:26: [2024-11-22 04:07:26] iter = 0610, loss = 31.6477
2024-11-22 04:10:11: [2024-11-22 04:10:11] iter = 0620, loss = 29.1603
2024-11-22 04:12:51: [2024-11-22 04:12:51] iter = 0630, loss = 29.9536
2024-11-22 04:15:36: [2024-11-22 04:15:36] iter = 0640, loss = 27.4370
2024-11-22 04:18:20: [2024-11-22 04:18:20] iter = 0650, loss = 29.7615
2024-11-22 04:20:51: [2024-11-22 04:20:51] iter = 0660, loss = 30.1112
2024-11-22 04:23:28: [2024-11-22 04:23:28] iter = 0670, loss = 30.3167
2024-11-22 04:26:04: [2024-11-22 04:26:04] iter = 0680, loss = 32.8027
2024-11-22 04:28:40: [2024-11-22 04:28:40] iter = 0690, loss = 29.0443
2024-11-22 04:31:17: [2024-11-22 04:31:17] iter = 0700, loss = 40.4844
2024-11-22 04:33:58: [2024-11-22 04:33:58] iter = 0710, loss = 30.3030
2024-11-22 04:36:38: [2024-11-22 04:36:38] iter = 0720, loss = 29.7904
2024-11-22 04:39:13: [2024-11-22 04:39:13] iter = 0730, loss = 26.9479
2024-11-22 04:41:53: [2024-11-22 04:41:53] iter = 0740, loss = 29.5722
2024-11-22 04:44:36: [2024-11-22 04:44:36] iter = 0750, loss = 40.6298
2024-11-22 04:47:17: [2024-11-22 04:47:17] iter = 0760, loss = 33.2810
2024-11-22 04:49:58: [2024-11-22 04:49:58] iter = 0770, loss = 30.6084
2024-11-22 04:52:39: [2024-11-22 04:52:39] iter = 0780, loss = 34.5706
2024-11-22 04:55:22: [2024-11-22 04:55:22] iter = 0790, loss = 32.6745
2024-11-22 04:57:58: [2024-11-22 04:57:58] iter = 0800, loss = 28.9802
2024-11-22 05:00:33: [2024-11-22 05:00:33] iter = 0810, loss = 37.0781
2024-11-22 05:03:11: [2024-11-22 05:03:11] iter = 0820, loss = 30.3886
2024-11-22 05:05:50: [2024-11-22 05:05:50] iter = 0830, loss = 34.2924
2024-11-22 05:08:26: [2024-11-22 05:08:26] iter = 0840, loss = 31.0341
2024-11-22 05:11:08: [2024-11-22 05:11:08] iter = 0850, loss = 28.7150
2024-11-22 05:13:47: [2024-11-22 05:13:47] iter = 0860, loss = 29.9997
2024-11-22 05:16:30: [2024-11-22 05:16:30] iter = 0870, loss = 33.8389
2024-11-22 05:19:20: [2024-11-22 05:19:20] iter = 0880, loss = 32.7802
2024-11-22 05:22:00: [2024-11-22 05:22:00] iter = 0890, loss = 34.3501
2024-11-22 05:24:46: [2024-11-22 05:24:46] iter = 0900, loss = 28.6445
2024-11-22 05:27:22: [2024-11-22 05:27:22] iter = 0910, loss = 28.3679
2024-11-22 05:29:56: [2024-11-22 05:29:56] iter = 0920, loss = 34.1965
2024-11-22 05:32:28: [2024-11-22 05:32:28] iter = 0930, loss = 27.9179
2024-11-22 05:35:12: [2024-11-22 05:35:12] iter = 0940, loss = 32.5275
2024-11-22 05:38:00: [2024-11-22 05:38:00] iter = 0950, loss = 28.7767
2024-11-22 05:40:39: [2024-11-22 05:40:39] iter = 0960, loss = 30.8722
2024-11-22 05:43:18: [2024-11-22 05:43:18] iter = 0970, loss = 35.0107
2024-11-22 05:45:40: [2024-11-22 05:45:40] iter = 0980, loss = 28.4901
2024-11-22 05:48:02: [2024-11-22 05:48:02] iter = 0990, loss = 31.0008
2024-11-22 05:50:04: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 05:50:04: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 05:50:04: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 4053}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 05:51:36: Evaluate 5 random ConvNet, ACCmean = 0.8049 ACCstd = 0.0015
-------------------------
2024-11-22 05:51:36: Evaluate 5 random ConvNet, F1mean = 0.7895 F!std = 0.0013
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 05:51:50: [2024-11-22 05:51:50] iter = 1000, loss = 33.9754
2024-11-22 05:51:50: 
================== Exp 2 ==================
 
2024-11-22 05:51:50: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'OrganCMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f5adcdf2ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_OrganCMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 05:51:50: Evaluation model pool: ['ConvNet']
2024-11-22 05:51:51: class c = 0: 1148 real images
2024-11-22 05:51:51: class c = 1: 619 real images
2024-11-22 05:51:51: class c = 2: 595 real images
2024-11-22 05:51:51: class c = 3: 600 real images
2024-11-22 05:51:51: class c = 4: 1088 real images
2024-11-22 05:51:51: class c = 5: 1170 real images
2024-11-22 05:51:51: class c = 6: 2986 real images
2024-11-22 05:51:51: class c = 7: 1002 real images
2024-11-22 05:51:51: class c = 8: 1022 real images
2024-11-22 05:51:51: class c = 9: 1173 real images
2024-11-22 05:51:51: class c = 10: 1572 real images
2024-11-22 05:51:51: real images channel 0, mean = 0.4942, std = 0.2834
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 05:51:51: initialize synthetic data from random real images
2024-11-22 05:51:51: [2024-11-22 05:51:51] training begins
2024-11-22 05:51:51: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 05:51:51: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 05:51:51: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 10459}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 05:53:20: Evaluate 5 random ConvNet, ACCmean = 0.7006 ACCstd = 0.0067
-------------------------
2024-11-22 05:53:20: Evaluate 5 random ConvNet, F1mean = 0.6937 F!std = 0.0055
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 05:53:33: [2024-11-22 05:53:33] iter = 0000, loss = 57.6297
2024-11-22 05:55:35: [2024-11-22 05:55:35] iter = 0010, loss = 47.4811
2024-11-22 05:57:43: [2024-11-22 05:57:43] iter = 0020, loss = 45.3183
2024-11-22 05:59:50: [2024-11-22 05:59:50] iter = 0030, loss = 36.7173
2024-11-22 06:01:50: [2024-11-22 06:01:50] iter = 0040, loss = 40.4831
2024-11-22 06:03:49: [2024-11-22 06:03:49] iter = 0050, loss = 38.0852
2024-11-22 06:05:54: [2024-11-22 06:05:54] iter = 0060, loss = 46.3046
2024-11-22 06:07:52: [2024-11-22 06:07:52] iter = 0070, loss = 38.9852
2024-11-22 06:09:53: [2024-11-22 06:09:53] iter = 0080, loss = 33.4945
2024-11-22 06:11:57: [2024-11-22 06:11:57] iter = 0090, loss = 38.8250
2024-11-22 06:14:05: [2024-11-22 06:14:05] iter = 0100, loss = 31.5853
2024-11-22 06:16:12: [2024-11-22 06:16:12] iter = 0110, loss = 30.5237
2024-11-22 06:18:15: [2024-11-22 06:18:15] iter = 0120, loss = 35.3045
2024-11-22 06:20:23: [2024-11-22 06:20:23] iter = 0130, loss = 36.1799
2024-11-22 06:22:29: [2024-11-22 06:22:29] iter = 0140, loss = 37.1548
2024-11-22 06:24:42: [2024-11-22 06:24:42] iter = 0150, loss = 38.2962
2024-11-22 06:26:50: [2024-11-22 06:26:50] iter = 0160, loss = 31.0340
2024-11-22 06:29:04: [2024-11-22 06:29:04] iter = 0170, loss = 35.3534
2024-11-22 06:31:11: [2024-11-22 06:31:11] iter = 0180, loss = 35.0699
2024-11-22 06:33:17: [2024-11-22 06:33:17] iter = 0190, loss = 35.3518
2024-11-22 06:35:22: [2024-11-22 06:35:22] iter = 0200, loss = 32.1677
2024-11-22 06:37:33: [2024-11-22 06:37:33] iter = 0210, loss = 31.5956
2024-11-22 06:39:42: [2024-11-22 06:39:42] iter = 0220, loss = 34.4946
2024-11-22 06:41:55: [2024-11-22 06:41:55] iter = 0230, loss = 30.3118
2024-11-22 06:44:01: [2024-11-22 06:44:01] iter = 0240, loss = 38.0558
2024-11-22 06:46:10: [2024-11-22 06:46:10] iter = 0250, loss = 30.5150
2024-11-22 06:48:14: [2024-11-22 06:48:14] iter = 0260, loss = 30.9947
2024-11-22 06:50:22: [2024-11-22 06:50:22] iter = 0270, loss = 36.8074
2024-11-22 06:52:31: [2024-11-22 06:52:31] iter = 0280, loss = 35.9742
2024-11-22 06:54:36: [2024-11-22 06:54:36] iter = 0290, loss = 40.6685
2024-11-22 06:56:44: [2024-11-22 06:56:44] iter = 0300, loss = 38.5815
2024-11-22 06:58:56: [2024-11-22 06:58:56] iter = 0310, loss = 31.2359
2024-11-22 07:01:02: [2024-11-22 07:01:02] iter = 0320, loss = 32.3649
2024-11-22 07:03:12: [2024-11-22 07:03:12] iter = 0330, loss = 37.1225
2024-11-22 07:05:19: [2024-11-22 07:05:19] iter = 0340, loss = 34.4239
2024-11-22 07:07:28: [2024-11-22 07:07:28] iter = 0350, loss = 36.4889
2024-11-22 07:09:38: [2024-11-22 07:09:38] iter = 0360, loss = 31.4000
2024-11-22 07:11:43: [2024-11-22 07:11:43] iter = 0370, loss = 36.5247
2024-11-22 07:13:50: [2024-11-22 07:13:50] iter = 0380, loss = 31.5369
2024-11-22 07:15:58: [2024-11-22 07:15:58] iter = 0390, loss = 34.0775
2024-11-22 07:18:04: [2024-11-22 07:18:04] iter = 0400, loss = 34.4751
2024-11-22 07:20:07: [2024-11-22 07:20:07] iter = 0410, loss = 29.6035
2024-11-22 07:22:17: [2024-11-22 07:22:17] iter = 0420, loss = 35.2321
2024-11-22 07:24:25: [2024-11-22 07:24:25] iter = 0430, loss = 34.8643
2024-11-22 07:26:38: [2024-11-22 07:26:38] iter = 0440, loss = 35.4579
2024-11-22 07:28:54: [2024-11-22 07:28:54] iter = 0450, loss = 34.8809
2024-11-22 07:30:59: [2024-11-22 07:30:59] iter = 0460, loss = 31.3651
2024-11-22 07:33:05: [2024-11-22 07:33:05] iter = 0470, loss = 31.0440
2024-11-22 07:35:10: [2024-11-22 07:35:10] iter = 0480, loss = 33.8507
2024-11-22 07:37:16: [2024-11-22 07:37:16] iter = 0490, loss = 31.4592
2024-11-22 07:39:13: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 07:39:13: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 07:39:13: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 53291}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 07:40:39: Evaluate 5 random ConvNet, ACCmean = 0.7981 ACCstd = 0.0034
-------------------------
2024-11-22 07:40:39: Evaluate 5 random ConvNet, F1mean = 0.7837 F!std = 0.0038
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 07:40:50: [2024-11-22 07:40:50] iter = 0500, loss = 28.7026
2024-11-22 07:42:59: [2024-11-22 07:42:59] iter = 0510, loss = 30.5608
2024-11-22 07:45:15: [2024-11-22 07:45:15] iter = 0520, loss = 26.2022
2024-11-22 07:47:43: [2024-11-22 07:47:43] iter = 0530, loss = 28.0289
2024-11-22 07:49:58: [2024-11-22 07:49:58] iter = 0540, loss = 35.9290
2024-11-22 07:52:10: [2024-11-22 07:52:10] iter = 0550, loss = 34.1831
2024-11-22 07:54:21: [2024-11-22 07:54:21] iter = 0560, loss = 36.3539
2024-11-22 07:56:27: [2024-11-22 07:56:27] iter = 0570, loss = 33.3997
2024-11-22 07:58:33: [2024-11-22 07:58:33] iter = 0580, loss = 34.2962
2024-11-22 08:00:39: [2024-11-22 08:00:39] iter = 0590, loss = 26.6519
2024-11-22 08:02:42: [2024-11-22 08:02:42] iter = 0600, loss = 31.7597
2024-11-22 08:04:42: [2024-11-22 08:04:42] iter = 0610, loss = 28.1259
2024-11-22 08:06:44: [2024-11-22 08:06:44] iter = 0620, loss = 31.1060
2024-11-22 08:08:49: [2024-11-22 08:08:49] iter = 0630, loss = 33.8379
2024-11-22 08:10:50: [2024-11-22 08:10:50] iter = 0640, loss = 31.3492
2024-11-22 08:12:49: [2024-11-22 08:12:49] iter = 0650, loss = 27.1633
2024-11-22 08:14:55: [2024-11-22 08:14:55] iter = 0660, loss = 27.2790
2024-11-22 08:16:51: [2024-11-22 08:16:51] iter = 0670, loss = 30.2244
2024-11-22 08:18:34: [2024-11-22 08:18:34] iter = 0680, loss = 25.7573
2024-11-22 08:20:09: [2024-11-22 08:20:09] iter = 0690, loss = 29.3036
2024-11-22 08:21:48: [2024-11-22 08:21:48] iter = 0700, loss = 31.4073
2024-11-22 08:23:37: [2024-11-22 08:23:37] iter = 0710, loss = 35.5418
2024-11-22 08:25:26: [2024-11-22 08:25:26] iter = 0720, loss = 33.2063
2024-11-22 08:27:18: [2024-11-22 08:27:18] iter = 0730, loss = 36.5753
2024-11-22 08:29:08: [2024-11-22 08:29:08] iter = 0740, loss = 35.3948
2024-11-22 08:31:01: [2024-11-22 08:31:01] iter = 0750, loss = 38.9425
2024-11-22 08:32:51: [2024-11-22 08:32:51] iter = 0760, loss = 35.3333
2024-11-22 08:34:40: [2024-11-22 08:34:40] iter = 0770, loss = 25.8146
2024-11-22 08:36:28: [2024-11-22 08:36:28] iter = 0780, loss = 28.6959
2024-11-22 08:38:13: [2024-11-22 08:38:13] iter = 0790, loss = 25.3009
2024-11-22 08:39:58: [2024-11-22 08:39:58] iter = 0800, loss = 24.1226
2024-11-22 08:41:48: [2024-11-22 08:41:48] iter = 0810, loss = 30.9903
2024-11-22 08:43:34: [2024-11-22 08:43:34] iter = 0820, loss = 39.7141
2024-11-22 08:45:19: [2024-11-22 08:45:19] iter = 0830, loss = 27.7137
2024-11-22 08:47:04: [2024-11-22 08:47:04] iter = 0840, loss = 29.6831
2024-11-22 08:48:55: [2024-11-22 08:48:55] iter = 0850, loss = 29.3456
2024-11-22 08:50:46: [2024-11-22 08:50:46] iter = 0860, loss = 30.4098
2024-11-22 08:52:41: [2024-11-22 08:52:41] iter = 0870, loss = 32.4208
2024-11-22 08:54:35: [2024-11-22 08:54:35] iter = 0880, loss = 28.9905
2024-11-22 08:56:30: [2024-11-22 08:56:30] iter = 0890, loss = 35.9306
2024-11-22 08:58:19: [2024-11-22 08:58:19] iter = 0900, loss = 28.4729
2024-11-22 09:00:05: [2024-11-22 09:00:05] iter = 0910, loss = 29.1652
2024-11-22 09:01:54: [2024-11-22 09:01:54] iter = 0920, loss = 37.0493
2024-11-22 09:03:42: [2024-11-22 09:03:42] iter = 0930, loss = 29.7731
2024-11-22 09:05:26: [2024-11-22 09:05:26] iter = 0940, loss = 33.0736
2024-11-22 09:07:11: [2024-11-22 09:07:11] iter = 0950, loss = 35.0377
2024-11-22 09:09:00: [2024-11-22 09:09:00] iter = 0960, loss = 26.2673
2024-11-22 09:10:50: [2024-11-22 09:10:50] iter = 0970, loss = 25.1513
2024-11-22 09:12:41: [2024-11-22 09:12:41] iter = 0980, loss = 32.8742
2024-11-22 09:14:34: [2024-11-22 09:14:34] iter = 0990, loss = 35.3278
2024-11-22 09:16:09: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 09:16:09: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 09:16:09: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 69716}
Using downloaded and verified file: /data/users/xiongyuxuan/.medmnist/organcmnist.npz
Using downloaded and verified file: /data/users/xiongyuxuan/.medmnist/organcmnist.npz
Loaded the dataset:OrganCMNIST
[2024-11-21 20:47:08] Evaluate_00: epoch = 1000 train time = 25 s train loss = 0.011099 train acc = 1.0000, test acc = 0.7085, test_sen =0.6977, test_spe =0.9707, test_f1 =0.6938
[2024-11-21 20:47:34] Evaluate_01: epoch = 1000 train time = 24 s train loss = 0.065290 train acc = 0.9909, test acc = 0.7147, test_sen =0.7045, test_spe =0.9714, test_f1 =0.6961
[2024-11-21 20:47:59] Evaluate_02: epoch = 1000 train time = 24 s train loss = 0.033198 train acc = 1.0000, test acc = 0.7196, test_sen =0.7111, test_spe =0.9718, test_f1 =0.7038
[2024-11-21 20:48:25] Evaluate_03: epoch = 1000 train time = 25 s train loss = 0.002153 train acc = 1.0000, test acc = 0.7129, test_sen =0.7008, test_spe =0.9712, test_f1 =0.6953
[2024-11-21 20:48:51] Evaluate_04: epoch = 1000 train time = 24 s train loss = 0.001944 train acc = 1.0000, test acc = 0.7134, test_sen =0.7036, test_spe =0.9712, test_f1 =0.6960
[2024-11-21 23:05:51] Evaluate_00: epoch = 1000 train time = 22 s train loss = 0.008094 train acc = 1.0000, test acc = 0.7960, test_sen =0.7898, test_spe =0.9795, test_f1 =0.7797
[2024-11-21 23:06:13] Evaluate_01: epoch = 1000 train time = 21 s train loss = 0.006525 train acc = 1.0000, test acc = 0.8031, test_sen =0.7948, test_spe =0.9801, test_f1 =0.7862
[2024-11-21 23:06:36] Evaluate_02: epoch = 1000 train time = 22 s train loss = 0.039133 train acc = 1.0000, test acc = 0.8005, test_sen =0.7929, test_spe =0.9799, test_f1 =0.7847
[2024-11-21 23:07:00] Evaluate_03: epoch = 1000 train time = 22 s train loss = 0.004562 train acc = 1.0000, test acc = 0.7978, test_sen =0.7923, test_spe =0.9796, test_f1 =0.7829
[2024-11-21 23:07:24] Evaluate_04: epoch = 1000 train time = 23 s train loss = 0.004068 train acc = 1.0000, test acc = 0.7952, test_sen =0.7869, test_spe =0.9793, test_f1 =0.7783
[2024-11-22 01:20:18] Evaluate_00: epoch = 1000 train time = 22 s train loss = 0.003825 train acc = 1.0000, test acc = 0.8135, test_sen =0.8073, test_spe =0.9812, test_f1 =0.7973
[2024-11-22 01:20:42] Evaluate_01: epoch = 1000 train time = 23 s train loss = 0.089737 train acc = 0.9909, test acc = 0.8098, test_sen =0.8016, test_spe =0.9808, test_f1 =0.7934
[2024-11-22 01:21:04] Evaluate_02: epoch = 1000 train time = 21 s train loss = 0.020397 train acc = 1.0000, test acc = 0.8087, test_sen =0.8022, test_spe =0.9807, test_f1 =0.7935
[2024-11-22 01:21:24] Evaluate_03: epoch = 1000 train time = 19 s train loss = 0.007999 train acc = 1.0000, test acc = 0.8095, test_sen =0.8023, test_spe =0.9808, test_f1 =0.7935
[2024-11-22 01:21:48] Evaluate_04: epoch = 1000 train time = 22 s train loss = 0.018731 train acc = 1.0000, test acc = 0.8117, test_sen =0.8015, test_spe =0.9810, test_f1 =0.7949
[2024-11-22 01:22:30] Evaluate_00: epoch = 1000 train time = 22 s train loss = 0.001638 train acc = 1.0000, test acc = 0.7128, test_sen =0.6990, test_spe =0.9710, test_f1 =0.6975
[2024-11-22 01:22:55] Evaluate_01: epoch = 1000 train time = 23 s train loss = 0.012857 train acc = 1.0000, test acc = 0.7237, test_sen =0.7046, test_spe =0.9720, test_f1 =0.7055
[2024-11-22 01:23:19] Evaluate_02: epoch = 1000 train time = 22 s train loss = 0.008854 train acc = 1.0000, test acc = 0.7193, test_sen =0.7035, test_spe =0.9716, test_f1 =0.7031
[2024-11-22 01:23:42] Evaluate_03: epoch = 1000 train time = 22 s train loss = 0.005576 train acc = 1.0000, test acc = 0.7091, test_sen =0.6966, test_spe =0.9706, test_f1 =0.6941
[2024-11-22 01:24:05] Evaluate_04: epoch = 1000 train time = 22 s train loss = 0.008963 train acc = 1.0000, test acc = 0.7139, test_sen =0.6974, test_spe =0.9710, test_f1 =0.6978
[2024-11-22 03:36:46] Evaluate_00: epoch = 1000 train time = 23 s train loss = 0.007303 train acc = 1.0000, test acc = 0.8040, test_sen =0.7990, test_spe =0.9803, test_f1 =0.7902
[2024-11-22 03:37:07] Evaluate_01: epoch = 1000 train time = 19 s train loss = 0.041243 train acc = 1.0000, test acc = 0.7915, test_sen =0.7855, test_spe =0.9790, test_f1 =0.7771
[2024-11-22 03:37:30] Evaluate_02: epoch = 1000 train time = 21 s train loss = 0.017399 train acc = 1.0000, test acc = 0.7925, test_sen =0.7884, test_spe =0.9792, test_f1 =0.7782
[2024-11-22 03:37:52] Evaluate_03: epoch = 1000 train time = 22 s train loss = 0.008805 train acc = 1.0000, test acc = 0.7924, test_sen =0.7848, test_spe =0.9791, test_f1 =0.7758
[2024-11-22 03:38:16] Evaluate_04: epoch = 1000 train time = 22 s train loss = 0.032282 train acc = 1.0000, test acc = 0.7938, test_sen =0.7867, test_spe =0.9792, test_f1 =0.7795
[2024-11-22 05:50:22] Evaluate_00: epoch = 1000 train time = 17 s train loss = 0.031137 train acc = 1.0000, test acc = 0.8046, test_sen =0.7994, test_spe =0.9804, test_f1 =0.7885
[2024-11-22 05:50:41] Evaluate_01: epoch = 1000 train time = 18 s train loss = 0.018579 train acc = 1.0000, test acc = 0.8062, test_sen =0.8017, test_spe =0.9806, test_f1 =0.7903
[2024-11-22 05:51:00] Evaluate_02: epoch = 1000 train time = 18 s train loss = 0.022275 train acc = 1.0000, test acc = 0.8070, test_sen =0.8030, test_spe =0.9807, test_f1 =0.7916
[2024-11-22 05:51:18] Evaluate_03: epoch = 1000 train time = 17 s train loss = 0.023377 train acc = 1.0000, test acc = 0.8040, test_sen =0.7998, test_spe =0.9804, test_f1 =0.7884
[2024-11-22 05:51:36] Evaluate_04: epoch = 1000 train time = 17 s train loss = 0.029126 train acc = 1.0000, test acc = 0.8028, test_sen =0.7996, test_spe =0.9802, test_f1 =0.7887
[2024-11-22 05:52:09] Evaluate_00: epoch = 1000 train time = 17 s train loss = 0.001570 train acc = 1.0000, test acc = 0.7036, test_sen =0.7080, test_spe =0.9702, test_f1 =0.6981
[2024-11-22 05:52:26] Evaluate_01: epoch = 1000 train time = 17 s train loss = 0.005208 train acc = 1.0000, test acc = 0.6947, test_sen =0.6965, test_spe =0.9693, test_f1 =0.6880
[2024-11-22 05:52:44] Evaluate_02: epoch = 1000 train time = 17 s train loss = 0.032187 train acc = 1.0000, test acc = 0.7036, test_sen =0.7046, test_spe =0.9702, test_f1 =0.6964
[2024-11-22 05:53:03] Evaluate_03: epoch = 1000 train time = 17 s train loss = 0.011077 train acc = 1.0000, test acc = 0.7097, test_sen =0.7087, test_spe =0.9708, test_f1 =0.6997
[2024-11-22 05:53:20] Evaluate_04: epoch = 1000 train time = 16 s train loss = 0.011789 train acc = 1.0000, test acc = 0.6911, test_sen =0.6942, test_spe =0.9689, test_f1 =0.6862
[2024-11-22 07:39:30] Evaluate_00: epoch = 1000 train time = 16 s train loss = 0.009571 train acc = 1.0000, test acc = 0.7919, test_sen =0.7874, test_spe =0.9790, test_f1 =0.7772
[2024-11-22 07:39:47] Evaluate_01: epoch = 1000 train time = 16 s train loss = 0.035892 train acc = 1.0000, test acc = 0.7986, test_sen =0.7925, test_spe =0.9797, test_f1 =0.7844
[2024-11-22 07:40:04] Evaluate_02: epoch = 1000 train time = 16 s train loss = 0.010421 train acc = 1.0000, test acc = 0.8014, test_sen =0.7936, test_spe =0.9799, test_f1 =0.7881
[2024-11-22 07:40:22] Evaluate_03: epoch = 1000 train time = 16 s train loss = 0.025767 train acc = 1.0000, test acc = 0.8009, test_sen =0.7955, test_spe =0.9799, test_f1 =0.7864
[2024-11-22 07:40:39] Evaluate_04: epoch = 1000 train time = 16 s train loss = 0.017942 train acc = 1.0000, test acc = 0.7977, test_sen =0.7907, test_spe =0.9796, test_f1 =0.7824
[2024-11-22 09:16:24] Evaluate_00: epoch = 1000 train time = 13 s train loss = 0.006888 train acc = 1.0000, test acc = 0.7999, test_sen =0.7920, test_spe =0.9799, test_f1 =0.7842
[2024-11-22 09:16:38] Evaluate_01: epoch = 1000 train time = 13 s train loss = 0.007082 train acc = 1.0000, test acc = 0.7960, test_sen =0.7891, test_spe =0.9794, test_f1 =0.7799
[2024-11-22 09:16:51] Evaluate_02: epoch = 1000 train time = 12 s train loss = 0.006198 train acc = 1.0000, test acc = 0.8015, test_sen =0.7935, test_spe =0.9800, test_f1 =0.7852
[2024-11-22 09:17:04] Evaluate_03: epoch = 1000 train time = 13 s train loss = 0.029440 train acc = 1.0000, test acc = 0.7992, test_sen =0.7902, test_spe =0.9798, test_f1 =0.7834
[2024-11-22 09:17:19] Evaluate_04: epoch = 1000 train time = 14 s train loss = 0.009427 train acc = 1.0000, test acc = 0.8015, test_sen =0.7908, test_spe =0.9799, test_f1 =0.7852/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 09:17:19: Evaluate 5 random ConvNet, ACCmean = 0.7996 ACCstd = 0.0020
-------------------------
2024-11-22 09:17:19: Evaluate 5 random ConvNet, F1mean = 0.7836 F!std = 0.0020
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 09:17:30: [2024-11-22 09:17:30] iter = 1000, loss = 31.7976
2024-11-22 09:17:30: 
================== Exp 3 ==================
 
2024-11-22 09:17:30: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'OrganCMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f5adcdf2ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_OrganCMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 09:17:30: Evaluation model pool: ['ConvNet']
2024-11-22 09:17:31: class c = 0: 1148 real images
2024-11-22 09:17:31: class c = 1: 619 real images
2024-11-22 09:17:31: class c = 2: 595 real images
2024-11-22 09:17:31: class c = 3: 600 real images
2024-11-22 09:17:31: class c = 4: 1088 real images
2024-11-22 09:17:31: class c = 5: 1170 real images
2024-11-22 09:17:31: class c = 6: 2986 real images
2024-11-22 09:17:31: class c = 7: 1002 real images
2024-11-22 09:17:31: class c = 8: 1022 real images
2024-11-22 09:17:31: class c = 9: 1173 real images
2024-11-22 09:17:31: class c = 10: 1572 real images
2024-11-22 09:17:31: real images channel 0, mean = 0.4942, std = 0.2834
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 09:17:31: initialize synthetic data from random real images
2024-11-22 09:17:31: [2024-11-22 09:17:31] training begins
2024-11-22 09:17:31: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 09:17:31: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 09:17:31: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 50535}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 09:18:38: Evaluate 5 random ConvNet, ACCmean = 0.6970 ACCstd = 0.0099
-------------------------
2024-11-22 09:18:38: Evaluate 5 random ConvNet, F1mean = 0.6905 F!std = 0.0092
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 09:18:48: [2024-11-22 09:18:48] iter = 0000, loss = 57.6571
2024-11-22 09:20:33: [2024-11-22 09:20:33] iter = 0010, loss = 46.6087
2024-11-22 09:22:18: [2024-11-22 09:22:18] iter = 0020, loss = 42.4855
2024-11-22 09:24:03: [2024-11-22 09:24:03] iter = 0030, loss = 38.2793
2024-11-22 09:25:46: [2024-11-22 09:25:46] iter = 0040, loss = 42.5581
2024-11-22 09:27:30: [2024-11-22 09:27:30] iter = 0050, loss = 44.0350
2024-11-22 09:29:21: [2024-11-22 09:29:21] iter = 0060, loss = 40.5115
2024-11-22 09:31:10: [2024-11-22 09:31:10] iter = 0070, loss = 32.9555
2024-11-22 09:33:02: [2024-11-22 09:33:02] iter = 0080, loss = 32.7256
2024-11-22 09:34:56: [2024-11-22 09:34:56] iter = 0090, loss = 36.1465
2024-11-22 09:36:46: [2024-11-22 09:36:46] iter = 0100, loss = 25.9996
2024-11-22 09:38:34: [2024-11-22 09:38:34] iter = 0110, loss = 37.1857
2024-11-22 09:40:23: [2024-11-22 09:40:23] iter = 0120, loss = 35.0717
2024-11-22 09:42:06: [2024-11-22 09:42:06] iter = 0130, loss = 38.5860
2024-11-22 09:43:56: [2024-11-22 09:43:56] iter = 0140, loss = 40.8616
2024-11-22 09:45:46: [2024-11-22 09:45:46] iter = 0150, loss = 34.7510
2024-11-22 09:47:35: [2024-11-22 09:47:35] iter = 0160, loss = 28.9197
2024-11-22 09:49:22: [2024-11-22 09:49:22] iter = 0170, loss = 30.9738
2024-11-22 09:51:16: [2024-11-22 09:51:16] iter = 0180, loss = 32.7072
2024-11-22 09:53:10: [2024-11-22 09:53:10] iter = 0190, loss = 31.1366
2024-11-22 09:55:02: [2024-11-22 09:55:02] iter = 0200, loss = 39.6273
2024-11-22 09:56:49: [2024-11-22 09:56:49] iter = 0210, loss = 28.7426
2024-11-22 09:58:43: [2024-11-22 09:58:42] iter = 0220, loss = 33.8128
2024-11-22 10:00:36: [2024-11-22 10:00:36] iter = 0230, loss = 33.6817
2024-11-22 10:02:27: [2024-11-22 10:02:27] iter = 0240, loss = 27.9272
2024-11-22 10:04:27: [2024-11-22 10:04:27] iter = 0250, loss = 33.4095
2024-11-22 10:06:24: [2024-11-22 10:06:24] iter = 0260, loss = 32.1816
2024-11-22 10:08:09: [2024-11-22 10:08:09] iter = 0270, loss = 36.2250
2024-11-22 10:10:00: [2024-11-22 10:10:00] iter = 0280, loss = 37.4844
2024-11-22 10:11:58: [2024-11-22 10:11:58] iter = 0290, loss = 31.1025
2024-11-22 10:13:48: [2024-11-22 10:13:48] iter = 0300, loss = 32.1141
2024-11-22 10:15:37: [2024-11-22 10:15:37] iter = 0310, loss = 31.8035
2024-11-22 10:17:26: [2024-11-22 10:17:26] iter = 0320, loss = 31.1342
2024-11-22 10:19:18: [2024-11-22 10:19:18] iter = 0330, loss = 29.3309
2024-11-22 10:21:10: [2024-11-22 10:21:10] iter = 0340, loss = 35.6155
2024-11-22 10:23:01: [2024-11-22 10:23:01] iter = 0350, loss = 31.0061
2024-11-22 10:24:52: [2024-11-22 10:24:52] iter = 0360, loss = 28.8432
2024-11-22 10:26:38: [2024-11-22 10:26:38] iter = 0370, loss = 36.3978
2024-11-22 10:28:23: [2024-11-22 10:28:23] iter = 0380, loss = 32.1461
2024-11-22 10:30:06: [2024-11-22 10:30:06] iter = 0390, loss = 35.3730
2024-11-22 10:31:58: [2024-11-22 10:31:58] iter = 0400, loss = 40.3084
2024-11-22 10:33:49: [2024-11-22 10:33:49] iter = 0410, loss = 29.4371
2024-11-22 10:35:39: [2024-11-22 10:35:39] iter = 0420, loss = 38.9711
2024-11-22 10:37:19: [2024-11-22 10:37:19] iter = 0430, loss = 39.1679
2024-11-22 10:39:08: [2024-11-22 10:39:08] iter = 0440, loss = 28.4851
2024-11-22 10:40:56: [2024-11-22 10:40:56] iter = 0450, loss = 29.0539
2024-11-22 10:42:43: [2024-11-22 10:42:43] iter = 0460, loss = 31.4044
2024-11-22 10:44:25: [2024-11-22 10:44:25] iter = 0470, loss = 27.8440
2024-11-22 10:46:11: [2024-11-22 10:46:11] iter = 0480, loss = 27.4755
2024-11-22 10:47:57: [2024-11-22 10:47:57] iter = 0490, loss = 39.6278
2024-11-22 10:49:30: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 10:49:30: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 10:49:30: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 70510}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 10:50:41: Evaluate 5 random ConvNet, ACCmean = 0.7991 ACCstd = 0.0023
-------------------------
2024-11-22 10:50:41: Evaluate 5 random ConvNet, F1mean = 0.7808 F!std = 0.0025
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 10:50:51: [2024-11-22 10:50:51] iter = 0500, loss = 29.5603
2024-11-22 10:52:36: [2024-11-22 10:52:36] iter = 0510, loss = 32.3067
2024-11-22 10:54:26: [2024-11-22 10:54:26] iter = 0520, loss = 29.2465
2024-11-22 10:56:13: [2024-11-22 10:56:13] iter = 0530, loss = 25.7564
2024-11-22 10:58:04: [2024-11-22 10:58:04] iter = 0540, loss = 30.4138
2024-11-22 10:59:57: [2024-11-22 10:59:57] iter = 0550, loss = 31.4577
2024-11-22 11:01:51: [2024-11-22 11:01:51] iter = 0560, loss = 31.8259
2024-11-22 11:03:47: [2024-11-22 11:03:47] iter = 0570, loss = 30.7000
2024-11-22 11:05:37: [2024-11-22 11:05:37] iter = 0580, loss = 26.3304
2024-11-22 11:07:32: [2024-11-22 11:07:32] iter = 0590, loss = 37.1980
2024-11-22 11:09:27: [2024-11-22 11:09:27] iter = 0600, loss = 34.0790
2024-11-22 11:11:15: [2024-11-22 11:11:15] iter = 0610, loss = 26.5496
2024-11-22 11:13:08: [2024-11-22 11:13:08] iter = 0620, loss = 36.0349
2024-11-22 11:15:01: [2024-11-22 11:15:01] iter = 0630, loss = 29.3425
2024-11-22 11:16:51: [2024-11-22 11:16:51] iter = 0640, loss = 39.0638
2024-11-22 11:18:44: [2024-11-22 11:18:44] iter = 0650, loss = 33.0575
2024-11-22 11:20:30: [2024-11-22 11:20:30] iter = 0660, loss = 31.2802
2024-11-22 11:22:22: [2024-11-22 11:22:22] iter = 0670, loss = 31.4710
2024-11-22 11:24:11: [2024-11-22 11:24:11] iter = 0680, loss = 34.2868
2024-11-22 11:26:02: [2024-11-22 11:26:02] iter = 0690, loss = 33.0656
2024-11-22 11:27:51: [2024-11-22 11:27:51] iter = 0700, loss = 29.6704
2024-11-22 11:29:38: [2024-11-22 11:29:38] iter = 0710, loss = 27.2814
2024-11-22 11:31:18: [2024-11-22 11:31:18] iter = 0720, loss = 30.2026
2024-11-22 11:33:00: [2024-11-22 11:33:00] iter = 0730, loss = 28.1817
2024-11-22 11:34:43: [2024-11-22 11:34:43] iter = 0740, loss = 26.3159
2024-11-22 11:36:26: [2024-11-22 11:36:26] iter = 0750, loss = 31.4795
2024-11-22 11:38:12: [2024-11-22 11:38:12] iter = 0760, loss = 35.2875
2024-11-22 11:39:59: [2024-11-22 11:39:59] iter = 0770, loss = 32.5716
2024-11-22 11:41:45: [2024-11-22 11:41:45] iter = 0780, loss = 28.2509
2024-11-22 11:43:27: [2024-11-22 11:43:27] iter = 0790, loss = 29.9402
2024-11-22 11:45:13: [2024-11-22 11:45:13] iter = 0800, loss = 29.7639
2024-11-22 11:46:56: [2024-11-22 11:46:56] iter = 0810, loss = 38.8458
2024-11-22 11:48:43: [2024-11-22 11:48:43] iter = 0820, loss = 27.7308
2024-11-22 11:50:36: [2024-11-22 11:50:36] iter = 0830, loss = 35.4786
2024-11-22 11:52:26: [2024-11-22 11:52:26] iter = 0840, loss = 23.2845
2024-11-22 11:54:12: [2024-11-22 11:54:12] iter = 0850, loss = 28.9078
2024-11-22 11:55:58: [2024-11-22 11:55:58] iter = 0860, loss = 23.0375
2024-11-22 11:57:47: [2024-11-22 11:57:47] iter = 0870, loss = 34.1579
2024-11-22 11:59:33: [2024-11-22 11:59:33] iter = 0880, loss = 29.9714
2024-11-22 12:01:16: [2024-11-22 12:01:16] iter = 0890, loss = 32.3186
2024-11-22 12:03:04: [2024-11-22 12:03:04] iter = 0900, loss = 28.9225
2024-11-22 12:04:55: [2024-11-22 12:04:55] iter = 0910, loss = 24.3670
2024-11-22 12:06:39: [2024-11-22 12:06:39] iter = 0920, loss = 30.6178
2024-11-22 12:08:24: [2024-11-22 12:08:24] iter = 0930, loss = 29.0304
2024-11-22 12:10:19: [2024-11-22 12:10:19] iter = 0940, loss = 28.8259
2024-11-22 12:12:06: [2024-11-22 12:12:06] iter = 0950, loss = 29.1054
2024-11-22 12:13:44: [2024-11-22 12:13:44] iter = 0960, loss = 28.1916
2024-11-22 12:15:16: [2024-11-22 12:15:16] iter = 0970, loss = 37.0047
2024-11-22 12:16:45: [2024-11-22 12:16:45] iter = 0980, loss = 34.5277
2024-11-22 12:18:17: [2024-11-22 12:18:17] iter = 0990, loss = 31.0147
2024-11-22 12:19:39: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 12:19:39: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 12:19:39: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 79853}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 12:20:38: Evaluate 5 random ConvNet, ACCmean = 0.8067 ACCstd = 0.0036
-------------------------
2024-11-22 12:20:38: Evaluate 5 random ConvNet, F1mean = 0.7918 F!std = 0.0033
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 12:20:48: [2024-11-22 12:20:48] iter = 1000, loss = 31.9204
2024-11-22 12:20:48: 
================== Exp 4 ==================
 
2024-11-22 12:20:48: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'OrganCMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f5adcdf2ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_OrganCMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 12:20:48: Evaluation model pool: ['ConvNet']
2024-11-22 12:20:48: class c = 0: 1148 real images
2024-11-22 12:20:48: class c = 1: 619 real images
2024-11-22 12:20:48: class c = 2: 595 real images
2024-11-22 12:20:48: class c = 3: 600 real images
2024-11-22 12:20:48: class c = 4: 1088 real images
2024-11-22 12:20:48: class c = 5: 1170 real images
2024-11-22 12:20:48: class c = 6: 2986 real images
2024-11-22 12:20:48: class c = 7: 1002 real images
2024-11-22 12:20:48: class c = 8: 1022 real images
2024-11-22 12:20:48: class c = 9: 1173 real images
2024-11-22 12:20:48: class c = 10: 1572 real images
2024-11-22 12:20:48: real images channel 0, mean = 0.4942, std = 0.2834
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 12:20:48: initialize synthetic data from random real images
2024-11-22 12:20:48: [2024-11-22 12:20:48] training begins
2024-11-22 12:20:48: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 12:20:48: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 12:20:48: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 47941}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 12:21:43: Evaluate 5 random ConvNet, ACCmean = 0.7237 ACCstd = 0.0043
-------------------------
2024-11-22 12:21:43: Evaluate 5 random ConvNet, F1mean = 0.7127 F!std = 0.0038
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 12:21:52: [2024-11-22 12:21:52] iter = 0000, loss = 66.4120
2024-11-22 12:23:29: [2024-11-22 12:23:29] iter = 0010, loss = 47.9753
2024-11-22 12:25:04: [2024-11-22 12:25:04] iter = 0020, loss = 46.2738
2024-11-22 12:26:42: [2024-11-22 12:26:42] iter = 0030, loss = 44.6902
2024-11-22 12:28:22: [2024-11-22 12:28:22] iter = 0040, loss = 43.2435
2024-11-22 12:29:57: [2024-11-22 12:29:57] iter = 0050, loss = 35.7801
2024-11-22 12:31:28: [2024-11-22 12:31:28] iter = 0060, loss = 35.5713
2024-11-22 12:33:01: [2024-11-22 12:33:01] iter = 0070, loss = 33.8848
2024-11-22 12:34:39: [2024-11-22 12:34:39] iter = 0080, loss = 32.7457
2024-11-22 12:36:15: [2024-11-22 12:36:15] iter = 0090, loss = 32.9145
2024-11-22 12:37:48: [2024-11-22 12:37:48] iter = 0100, loss = 42.9473
2024-11-22 12:39:18: [2024-11-22 12:39:18] iter = 0110, loss = 38.1741
2024-11-22 12:40:46: [2024-11-22 12:40:46] iter = 0120, loss = 33.8971
2024-11-22 12:42:17: [2024-11-22 12:42:17] iter = 0130, loss = 40.1790
2024-11-22 12:43:50: [2024-11-22 12:43:50] iter = 0140, loss = 39.6975
2024-11-22 12:45:20: [2024-11-22 12:45:20] iter = 0150, loss = 37.1728
2024-11-22 12:46:58: [2024-11-22 12:46:58] iter = 0160, loss = 41.2170
2024-11-22 12:48:36: [2024-11-22 12:48:36] iter = 0170, loss = 35.6305
2024-11-22 12:50:12: [2024-11-22 12:50:12] iter = 0180, loss = 29.4897
2024-11-22 12:51:52: [2024-11-22 12:51:52] iter = 0190, loss = 31.0718
2024-11-22 12:53:29: [2024-11-22 12:53:29] iter = 0200, loss = 33.0691
2024-11-22 12:54:55: [2024-11-22 12:54:55] iter = 0210, loss = 30.6939
2024-11-22 12:56:22: [2024-11-22 12:56:22] iter = 0220, loss = 37.2002
2024-11-22 12:57:48: [2024-11-22 12:57:48] iter = 0230, loss = 32.5103
2024-11-22 12:59:15: [2024-11-22 12:59:15] iter = 0240, loss = 27.2056
2024-11-22 13:00:40: [2024-11-22 13:00:40] iter = 0250, loss = 30.3068
2024-11-22 13:02:04: [2024-11-22 13:02:04] iter = 0260, loss = 32.5231
2024-11-22 13:03:28: [2024-11-22 13:03:28] iter = 0270, loss = 29.7537
2024-11-22 13:04:56: [2024-11-22 13:04:56] iter = 0280, loss = 30.8986
2024-11-22 13:06:21: [2024-11-22 13:06:21] iter = 0290, loss = 33.3522
2024-11-22 13:07:47: [2024-11-22 13:07:47] iter = 0300, loss = 34.5721
2024-11-22 13:09:15: [2024-11-22 13:09:15] iter = 0310, loss = 33.1452
2024-11-22 13:10:40: [2024-11-22 13:10:40] iter = 0320, loss = 31.5674
2024-11-22 13:12:04: [2024-11-22 13:12:04] iter = 0330, loss = 32.0110
2024-11-22 13:13:31: [2024-11-22 13:13:31] iter = 0340, loss = 32.7842
2024-11-22 13:14:55: [2024-11-22 13:14:55] iter = 0350, loss = 30.3106
2024-11-22 13:16:20: [2024-11-22 13:16:20] iter = 0360, loss = 30.4642
2024-11-22 13:17:44: [2024-11-22 13:17:44] iter = 0370, loss = 32.5199
2024-11-22 13:19:07: [2024-11-22 13:19:07] iter = 0380, loss = 34.3532
2024-11-22 13:20:30: [2024-11-22 13:20:30] iter = 0390, loss = 36.5945
2024-11-22 13:21:55: [2024-11-22 13:21:55] iter = 0400, loss = 31.7243
2024-11-22 13:23:20: [2024-11-22 13:23:20] iter = 0410, loss = 34.2358
2024-11-22 13:24:42: [2024-11-22 13:24:42] iter = 0420, loss = 34.2468
2024-11-22 13:26:04: [2024-11-22 13:26:04] iter = 0430, loss = 41.6011
2024-11-22 13:27:30: [2024-11-22 13:27:29] iter = 0440, loss = 30.8477
2024-11-22 13:28:52: [2024-11-22 13:28:52] iter = 0450, loss = 38.1124
2024-11-22 13:30:15: [2024-11-22 13:30:15] iter = 0460, loss = 34.0859
2024-11-22 13:31:37: [2024-11-22 13:31:37] iter = 0470, loss = 34.7891
2024-11-22 13:33:00: [2024-11-22 13:33:00] iter = 0480, loss = 28.1998
2024-11-22 13:34:25: [2024-11-22 13:34:25] iter = 0490, loss = 30.7296
2024-11-22 13:35:41: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 13:35:41: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 13:35:41: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 41178}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 13:36:32: Evaluate 5 random ConvNet, ACCmean = 0.8043 ACCstd = 0.0028
-------------------------
2024-11-22 13:36:32: Evaluate 5 random ConvNet, F1mean = 0.7888 F!std = 0.0034
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 13:36:41: [2024-11-22 13:36:41] iter = 0500, loss = 33.3307
2024-11-22 13:38:05: [2024-11-22 13:38:05] iter = 0510, loss = 28.8095
2024-11-22 13:39:30: [2024-11-22 13:39:30] iter = 0520, loss = 31.9393
2024-11-22 13:40:56: [2024-11-22 13:40:56] iter = 0530, loss = 30.4388
2024-11-22 13:42:21: [2024-11-22 13:42:21] iter = 0540, loss = 36.4856
2024-11-22 13:43:45: [2024-11-22 13:43:45] iter = 0550, loss = 22.9132
2024-11-22 13:45:11: [2024-11-22 13:45:11] iter = 0560, loss = 27.8746
2024-11-22 13:46:35: [2024-11-22 13:46:35] iter = 0570, loss = 30.8143
2024-11-22 13:47:58: [2024-11-22 13:47:58] iter = 0580, loss = 30.0747
2024-11-22 13:49:20: [2024-11-22 13:49:20] iter = 0590, loss = 24.6300
2024-11-22 13:50:43: [2024-11-22 13:50:43] iter = 0600, loss = 37.5485
2024-11-22 13:52:06: [2024-11-22 13:52:06] iter = 0610, loss = 25.9304
2024-11-22 13:53:29: [2024-11-22 13:53:29] iter = 0620, loss = 29.0666
2024-11-22 13:54:54: [2024-11-22 13:54:54] iter = 0630, loss = 35.3533
2024-11-22 13:56:17: [2024-11-22 13:56:17] iter = 0640, loss = 38.4635
2024-11-22 13:57:40: [2024-11-22 13:57:40] iter = 0650, loss = 24.2556
2024-11-22 13:59:02: [2024-11-22 13:59:02] iter = 0660, loss = 33.7018
2024-11-22 14:00:26: [2024-11-22 14:00:26] iter = 0670, loss = 33.3411
2024-11-22 14:01:48: [2024-11-22 14:01:48] iter = 0680, loss = 32.1634
2024-11-22 14:03:12: [2024-11-22 14:03:12] iter = 0690, loss = 24.5212
2024-11-22 14:04:35: [2024-11-22 14:04:35] iter = 0700, loss = 32.0808
2024-11-22 14:05:57: [2024-11-22 14:05:57] iter = 0710, loss = 38.7127
2024-11-22 14:07:19: [2024-11-22 14:07:19] iter = 0720, loss = 31.4981
2024-11-22 14:08:42: [2024-11-22 14:08:42] iter = 0730, loss = 36.0418
2024-11-22 14:10:04: [2024-11-22 14:10:04] iter = 0740, loss = 35.0428
2024-11-22 14:11:27: [2024-11-22 14:11:27] iter = 0750, loss = 36.7859
2024-11-22 14:12:49: [2024-11-22 14:12:49] iter = 0760, loss = 38.1489
2024-11-22 14:14:10: [2024-11-22 14:14:10] iter = 0770, loss = 34.2600
2024-11-22 14:15:32: [2024-11-22 14:15:32] iter = 0780, loss = 27.5495
2024-11-22 14:16:53: [2024-11-22 14:16:53] iter = 0790, loss = 29.0794
2024-11-22 14:18:15: [2024-11-22 14:18:15] iter = 0800, loss = 31.8154
2024-11-22 14:19:37: [2024-11-22 14:19:37] iter = 0810, loss = 29.2173
2024-11-22 14:20:58: [2024-11-22 14:20:58] iter = 0820, loss = 33.9127
2024-11-22 14:22:20: [2024-11-22 14:22:20] iter = 0830, loss = 35.2973
2024-11-22 14:23:42: [2024-11-22 14:23:42] iter = 0840, loss = 31.8029
2024-11-22 14:25:04: [2024-11-22 14:25:04] iter = 0850, loss = 29.2990
2024-11-22 14:26:27: [2024-11-22 14:26:27] iter = 0860, loss = 34.7068
2024-11-22 14:27:48: [2024-11-22 14:27:48] iter = 0870, loss = 31.7937
2024-11-22 14:29:11: [2024-11-22 14:29:11] iter = 0880, loss = 30.8944
2024-11-22 14:30:32: [2024-11-22 14:30:32] iter = 0890, loss = 41.2418
2024-11-22 14:31:54: [2024-11-22 14:31:54] iter = 0900, loss = 29.8860
2024-11-22 14:33:16: [2024-11-22 14:33:16] iter = 0910, loss = 30.1867
2024-11-22 14:34:37: [2024-11-22 14:34:37] iter = 0920, loss = 30.7537
2024-11-22 14:35:59: [2024-11-22 14:35:59] iter = 0930, loss = 28.4720
2024-11-22 14:37:22: [2024-11-22 14:37:22] iter = 0940, loss = 32.2971
2024-11-22 14:38:46: [2024-11-22 14:38:46] iter = 0950, loss = 30.3548
2024-11-22 14:40:09: [2024-11-22 14:40:09] iter = 0960, loss = 27.9273
2024-11-22 14:41:30: [2024-11-22 14:41:30] iter = 0970, loss = 32.4272
2024-11-22 14:42:54: [2024-11-22 14:42:54] iter = 0980, loss = 27.7052
2024-11-22 14:44:17: [2024-11-22 14:44:17] iter = 0990, loss = 29.3276
2024-11-22 14:45:32: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 14:45:32: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 14:45:32: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 32148}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 14:46:21: Evaluate 5 random ConvNet, ACCmean = 0.8111 ACCstd = 0.0023
-------------------------
2024-11-22 14:46:21: Evaluate 5 random ConvNet, F1mean = 0.7941 F!std = 0.0015
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 14:46:30: [2024-11-22 14:46:30] iter = 1000, loss = 27.8159
2024-11-22 14:46:30: 
==================== Final Results ====================

2024-11-22 14:46:30: Run 5 experiments, train on ConvNet, evaluate 25 random ConvNet, mean  = 80.66%  std = 0.48%

[2024-11-22 09:17:45] Evaluate_00: epoch = 1000 train time = 13 s train loss = 0.003340 train acc = 1.0000, test acc = 0.6817, test_sen =0.6938, test_spe =0.9682, test_f1 =0.6764
[2024-11-22 09:17:58] Evaluate_01: epoch = 1000 train time = 12 s train loss = 0.011474 train acc = 1.0000, test acc = 0.7056, test_sen =0.7125, test_spe =0.9705, test_f1 =0.6996
[2024-11-22 09:18:12] Evaluate_02: epoch = 1000 train time = 13 s train loss = 0.001624 train acc = 1.0000, test acc = 0.6957, test_sen =0.7016, test_spe =0.9695, test_f1 =0.6890
[2024-11-22 09:18:25] Evaluate_03: epoch = 1000 train time = 12 s train loss = 0.009431 train acc = 1.0000, test acc = 0.6923, test_sen =0.7058, test_spe =0.9692, test_f1 =0.6862
[2024-11-22 09:18:38] Evaluate_04: epoch = 1000 train time = 13 s train loss = 0.045516 train acc = 0.9909, test acc = 0.7097, test_sen =0.7173, test_spe =0.9709, test_f1 =0.7015
[2024-11-22 10:49:45] Evaluate_00: epoch = 1000 train time = 14 s train loss = 0.023444 train acc = 1.0000, test acc = 0.7978, test_sen =0.7878, test_spe =0.9796, test_f1 =0.7798
[2024-11-22 10:49:56] Evaluate_01: epoch = 1000 train time = 11 s train loss = 0.031408 train acc = 1.0000, test acc = 0.7963, test_sen =0.7840, test_spe =0.9795, test_f1 =0.7770
[2024-11-22 10:50:10] Evaluate_02: epoch = 1000 train time = 12 s train loss = 0.007026 train acc = 1.0000, test acc = 0.8008, test_sen =0.7912, test_spe =0.9799, test_f1 =0.7833
[2024-11-22 10:50:25] Evaluate_03: epoch = 1000 train time = 15 s train loss = 0.007704 train acc = 1.0000, test acc = 0.8027, test_sen =0.7910, test_spe =0.9801, test_f1 =0.7837
[2024-11-22 10:50:41] Evaluate_04: epoch = 1000 train time = 14 s train loss = 0.025243 train acc = 1.0000, test acc = 0.7982, test_sen =0.7896, test_spe =0.9797, test_f1 =0.7803
[2024-11-22 12:19:52] Evaluate_00: epoch = 1000 train time = 11 s train loss = 0.004407 train acc = 1.0000, test acc = 0.8076, test_sen =0.8012, test_spe =0.9806, test_f1 =0.7925
[2024-11-22 12:20:04] Evaluate_01: epoch = 1000 train time = 11 s train loss = 0.019013 train acc = 1.0000, test acc = 0.8101, test_sen =0.8015, test_spe =0.9809, test_f1 =0.7943
[2024-11-22 12:20:15] Evaluate_02: epoch = 1000 train time = 11 s train loss = 0.003011 train acc = 1.0000, test acc = 0.8055, test_sen =0.8000, test_spe =0.9804, test_f1 =0.7920
[2024-11-22 12:20:26] Evaluate_03: epoch = 1000 train time = 10 s train loss = 0.006312 train acc = 1.0000, test acc = 0.8005, test_sen =0.7915, test_spe =0.9798, test_f1 =0.7856
[2024-11-22 12:20:38] Evaluate_04: epoch = 1000 train time = 11 s train loss = 0.039324 train acc = 1.0000, test acc = 0.8100, test_sen =0.8019, test_spe =0.9808, test_f1 =0.7947
[2024-11-22 12:21:00] Evaluate_00: epoch = 1000 train time = 11 s train loss = 0.011421 train acc = 1.0000, test acc = 0.7294, test_sen =0.7301, test_spe =0.9729, test_f1 =0.7180
[2024-11-22 12:21:11] Evaluate_01: epoch = 1000 train time = 10 s train loss = 0.005048 train acc = 1.0000, test acc = 0.7252, test_sen =0.7234, test_spe =0.9725, test_f1 =0.7131
[2024-11-22 12:21:23] Evaluate_02: epoch = 1000 train time = 11 s train loss = 0.000855 train acc = 1.0000, test acc = 0.7205, test_sen =0.7188, test_spe =0.9720, test_f1 =0.7111
[2024-11-22 12:21:33] Evaluate_03: epoch = 1000 train time = 10 s train loss = 0.010249 train acc = 1.0000, test acc = 0.7260, test_sen =0.7234, test_spe =0.9725, test_f1 =0.7145
[2024-11-22 12:21:43] Evaluate_04: epoch = 1000 train time = 9 s train loss = 0.007515 train acc = 1.0000, test acc = 0.7171, test_sen =0.7181, test_spe =0.9717, test_f1 =0.7066
[2024-11-22 13:35:51] Evaluate_00: epoch = 1000 train time = 9 s train loss = 0.033705 train acc = 1.0000, test acc = 0.8026, test_sen =0.7961, test_spe =0.9801, test_f1 =0.7869
[2024-11-22 13:36:01] Evaluate_01: epoch = 1000 train time = 9 s train loss = 0.074935 train acc = 0.9909, test acc = 0.8071, test_sen =0.8001, test_spe =0.9806, test_f1 =0.7923
[2024-11-22 13:36:11] Evaluate_02: epoch = 1000 train time = 9 s train loss = 0.091718 train acc = 0.9818, test acc = 0.8010, test_sen =0.7936, test_spe =0.9800, test_f1 =0.7847
[2024-11-22 13:36:22] Evaluate_03: epoch = 1000 train time = 10 s train loss = 0.006034 train acc = 1.0000, test acc = 0.8028, test_sen =0.7952, test_spe =0.9801, test_f1 =0.7867
[2024-11-22 13:36:32] Evaluate_04: epoch = 1000 train time = 10 s train loss = 0.020736 train acc = 1.0000, test acc = 0.8082, test_sen =0.8023, test_spe =0.9807, test_f1 =0.7933
[2024-11-22 14:45:42] Evaluate_00: epoch = 1000 train time = 9 s train loss = 0.006460 train acc = 1.0000, test acc = 0.8115, test_sen =0.8010, test_spe =0.9810, test_f1 =0.7941
[2024-11-22 14:45:52] Evaluate_01: epoch = 1000 train time = 9 s train loss = 0.026072 train acc = 1.0000, test acc = 0.8144, test_sen =0.8041, test_spe =0.9813, test_f1 =0.7967
[2024-11-22 14:46:01] Evaluate_02: epoch = 1000 train time = 9 s train loss = 0.004336 train acc = 1.0000, test acc = 0.8081, test_sen =0.8001, test_spe =0.9807, test_f1 =0.7924
[2024-11-22 14:46:11] Evaluate_03: epoch = 1000 train time = 9 s train loss = 0.026465 train acc = 1.0000, test acc = 0.8124, test_sen =0.8037, test_spe =0.9812, test_f1 =0.7947
[2024-11-22 14:46:21] Evaluate_04: epoch = 1000 train time = 9 s train loss = 0.018057 train acc = 1.0000, test acc = 0.8093, test_sen =0.8010, test_spe =0.9809, test_f1 =0.7926
