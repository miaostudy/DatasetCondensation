nohup: ignoring input
2024-11-21 20:46:46: eval_it_pool: [0, 500, 1000]
2024-11-21 20:46:47: 
================== Exp 0 ==================
 
2024-11-21 20:46:47: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'OrganSMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7ff1a58a6ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_OrganSMNIST (INFO)>}
2024-11-21 20:46:47: Evaluation model pool: ['ConvNet']
2024-11-21 20:46:51: class c = 0: 1148 real images
2024-11-21 20:46:51: class c = 1: 630 real images
2024-11-21 20:46:51: class c = 2: 614 real images
2024-11-21 20:46:51: class c = 3: 721 real images
2024-11-21 20:46:51: class c = 4: 1132 real images
2024-11-21 20:46:51: class c = 5: 1119 real images
2024-11-21 20:46:51: class c = 6: 3464 real images
2024-11-21 20:46:51: class c = 7: 741 real images
2024-11-21 20:46:51: class c = 8: 803 real images
2024-11-21 20:46:51: class c = 9: 2004 real images
2024-11-21 20:46:51: class c = 10: 1556 real images
2024-11-21 20:46:51: real images channel 0, mean = 0.4953, std = 0.2826
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
main_base.py:125: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1666642975312/work/torch/csrc/utils/tensor_new.cpp:230.)
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-21 20:46:51: initialize synthetic data from random real images
2024-11-21 20:46:51: [2024-11-21 20:46:51] training begins
2024-11-21 20:46:51: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-21 20:46:51: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-21 20:46:51: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1666642975312/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 20:48:53: Evaluate 5 random ConvNet, ACCmean = 0.4281 ACCstd = 0.0046
-------------------------
2024-11-21 20:48:53: Evaluate 5 random ConvNet, F1mean = 0.4245 F!std = 0.0053
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 20:49:09: [2024-11-21 20:49:09] iter = 0000, loss = 51.5966
2024-11-21 20:51:32: [2024-11-21 20:51:32] iter = 0010, loss = 41.9143
2024-11-21 20:53:54: [2024-11-21 20:53:54] iter = 0020, loss = 38.2965
2024-11-21 20:56:18: [2024-11-21 20:56:18] iter = 0030, loss = 44.8126
2024-11-21 20:58:34: [2024-11-21 20:58:34] iter = 0040, loss = 36.9216
2024-11-21 21:00:58: [2024-11-21 21:00:58] iter = 0050, loss = 37.6157
2024-11-21 21:03:34: [2024-11-21 21:03:34] iter = 0060, loss = 38.6886
2024-11-21 21:06:03: [2024-11-21 21:06:03] iter = 0070, loss = 35.0120
2024-11-21 21:08:29: [2024-11-21 21:08:29] iter = 0080, loss = 37.1468
2024-11-21 21:10:51: [2024-11-21 21:10:51] iter = 0090, loss = 33.7604
2024-11-21 21:13:14: [2024-11-21 21:13:14] iter = 0100, loss = 35.4303
2024-11-21 21:15:45: [2024-11-21 21:15:45] iter = 0110, loss = 31.6477
2024-11-21 21:18:16: [2024-11-21 21:18:16] iter = 0120, loss = 36.3916
2024-11-21 21:20:43: [2024-11-21 21:20:43] iter = 0130, loss = 42.2094
2024-11-21 21:23:07: [2024-11-21 21:23:07] iter = 0140, loss = 34.7219
2024-11-21 21:25:32: [2024-11-21 21:25:32] iter = 0150, loss = 36.0612
2024-11-21 21:28:00: [2024-11-21 21:28:00] iter = 0160, loss = 32.0011
2024-11-21 21:30:25: [2024-11-21 21:30:25] iter = 0170, loss = 36.1450
2024-11-21 21:32:43: [2024-11-21 21:32:43] iter = 0180, loss = 38.9426
2024-11-21 21:35:04: [2024-11-21 21:35:04] iter = 0190, loss = 31.5832
2024-11-21 21:37:30: [2024-11-21 21:37:30] iter = 0200, loss = 33.4327
2024-11-21 21:39:51: [2024-11-21 21:39:51] iter = 0210, loss = 31.5878
2024-11-21 21:42:17: [2024-11-21 21:42:17] iter = 0220, loss = 32.2242
2024-11-21 21:44:43: [2024-11-21 21:44:43] iter = 0230, loss = 33.3091
2024-11-21 21:47:10: [2024-11-21 21:47:10] iter = 0240, loss = 26.5818
2024-11-21 21:49:34: [2024-11-21 21:49:34] iter = 0250, loss = 31.5162
2024-11-21 21:51:55: [2024-11-21 21:51:55] iter = 0260, loss = 33.1538
2024-11-21 21:54:24: [2024-11-21 21:54:24] iter = 0270, loss = 32.5507
2024-11-21 21:56:48: [2024-11-21 21:56:48] iter = 0280, loss = 31.2432
2024-11-21 21:59:21: [2024-11-21 21:59:21] iter = 0290, loss = 35.9165
2024-11-21 22:01:51: [2024-11-21 22:01:51] iter = 0300, loss = 26.7632
2024-11-21 22:04:18: [2024-11-21 22:04:18] iter = 0310, loss = 32.7404
2024-11-21 22:06:49: [2024-11-21 22:06:49] iter = 0320, loss = 31.9739
2024-11-21 22:09:22: [2024-11-21 22:09:22] iter = 0330, loss = 30.9592
2024-11-21 22:11:39: [2024-11-21 22:11:39] iter = 0340, loss = 28.3568
2024-11-21 22:14:03: [2024-11-21 22:14:03] iter = 0350, loss = 32.6126
2024-11-21 22:16:32: [2024-11-21 22:16:32] iter = 0360, loss = 39.1804
2024-11-21 22:18:57: [2024-11-21 22:18:57] iter = 0370, loss = 24.4892
2024-11-21 22:21:29: [2024-11-21 22:21:29] iter = 0380, loss = 30.4831
2024-11-21 22:23:56: [2024-11-21 22:23:56] iter = 0390, loss = 26.2353
2024-11-21 22:26:24: [2024-11-21 22:26:24] iter = 0400, loss = 29.1126
2024-11-21 22:28:55: [2024-11-21 22:28:55] iter = 0410, loss = 31.4282
2024-11-21 22:31:20: [2024-11-21 22:31:20] iter = 0420, loss = 35.3223
2024-11-21 22:33:40: [2024-11-21 22:33:40] iter = 0430, loss = 36.7302
2024-11-21 22:36:00: [2024-11-21 22:36:00] iter = 0440, loss = 30.4568
2024-11-21 22:38:25: [2024-11-21 22:38:25] iter = 0450, loss = 27.3686
2024-11-21 22:40:36: [2024-11-21 22:40:36] iter = 0460, loss = 26.8047
2024-11-21 22:43:05: [2024-11-21 22:43:05] iter = 0470, loss = 30.9275
2024-11-21 22:45:28: [2024-11-21 22:45:28] iter = 0480, loss = 25.7053
2024-11-21 22:47:44: [2024-11-21 22:47:44] iter = 0490, loss = 29.9200
2024-11-21 22:49:52: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-21 22:49:52: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-21 22:49:52: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 92519}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 22:51:41: Evaluate 5 random ConvNet, ACCmean = 0.6152 ACCstd = 0.0023
-------------------------
2024-11-21 22:51:41: Evaluate 5 random ConvNet, F1mean = 0.5847 F!std = 0.0024
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 22:51:56: [2024-11-21 22:51:56] iter = 0500, loss = 37.8080
2024-11-21 22:54:14: [2024-11-21 22:54:14] iter = 0510, loss = 39.2094
2024-11-21 22:56:33: [2024-11-21 22:56:33] iter = 0520, loss = 36.7186
2024-11-21 22:58:45: [2024-11-21 22:58:45] iter = 0530, loss = 29.6209
2024-11-21 23:01:03: [2024-11-21 23:01:03] iter = 0540, loss = 40.0529
2024-11-21 23:03:20: [2024-11-21 23:03:20] iter = 0550, loss = 29.1829
2024-11-21 23:05:47: [2024-11-21 23:05:47] iter = 0560, loss = 26.8905
2024-11-21 23:08:09: [2024-11-21 23:08:09] iter = 0570, loss = 32.5020
2024-11-21 23:10:30: [2024-11-21 23:10:30] iter = 0580, loss = 27.1260
2024-11-21 23:12:46: [2024-11-21 23:12:46] iter = 0590, loss = 40.3505
2024-11-21 23:15:08: [2024-11-21 23:15:08] iter = 0600, loss = 32.7823
2024-11-21 23:17:29: [2024-11-21 23:17:29] iter = 0610, loss = 28.3634
2024-11-21 23:19:44: [2024-11-21 23:19:44] iter = 0620, loss = 24.1152
2024-11-21 23:22:07: [2024-11-21 23:22:07] iter = 0630, loss = 30.9689
2024-11-21 23:24:27: [2024-11-21 23:24:27] iter = 0640, loss = 33.3085
2024-11-21 23:26:44: [2024-11-21 23:26:44] iter = 0650, loss = 35.4693
2024-11-21 23:29:02: [2024-11-21 23:29:02] iter = 0660, loss = 21.7251
2024-11-21 23:31:28: [2024-11-21 23:31:28] iter = 0670, loss = 26.9166
2024-11-21 23:33:52: [2024-11-21 23:33:52] iter = 0680, loss = 33.2890
2024-11-21 23:36:20: [2024-11-21 23:36:20] iter = 0690, loss = 29.0265
2024-11-21 23:38:38: [2024-11-21 23:38:38] iter = 0700, loss = 27.1292
2024-11-21 23:41:03: [2024-11-21 23:41:03] iter = 0710, loss = 27.2195
2024-11-21 23:43:32: [2024-11-21 23:43:32] iter = 0720, loss = 29.1120
2024-11-21 23:46:07: [2024-11-21 23:46:06] iter = 0730, loss = 25.1902
2024-11-21 23:48:40: [2024-11-21 23:48:40] iter = 0740, loss = 25.1416
2024-11-21 23:51:13: [2024-11-21 23:51:13] iter = 0750, loss = 30.2024
2024-11-21 23:53:42: [2024-11-21 23:53:42] iter = 0760, loss = 31.5096
2024-11-21 23:56:09: [2024-11-21 23:56:09] iter = 0770, loss = 25.5489
2024-11-21 23:58:38: [2024-11-21 23:58:38] iter = 0780, loss = 32.0418
2024-11-22 00:01:03: [2024-11-22 00:01:03] iter = 0790, loss = 33.3515
2024-11-22 00:03:43: [2024-11-22 00:03:43] iter = 0800, loss = 28.8709
2024-11-22 00:06:12: [2024-11-22 00:06:12] iter = 0810, loss = 31.7111
2024-11-22 00:08:40: [2024-11-22 00:08:40] iter = 0820, loss = 31.6555
2024-11-22 00:11:12: [2024-11-22 00:11:12] iter = 0830, loss = 44.7254
2024-11-22 00:13:38: [2024-11-22 00:13:38] iter = 0840, loss = 34.2711
2024-11-22 00:16:02: [2024-11-22 00:16:02] iter = 0850, loss = 30.0662
2024-11-22 00:18:25: [2024-11-22 00:18:25] iter = 0860, loss = 29.5490
2024-11-22 00:20:50: [2024-11-22 00:20:50] iter = 0870, loss = 28.3111
2024-11-22 00:23:19: [2024-11-22 00:23:19] iter = 0880, loss = 37.0390
2024-11-22 00:25:50: [2024-11-22 00:25:50] iter = 0890, loss = 29.0516
2024-11-22 00:28:20: [2024-11-22 00:28:20] iter = 0900, loss = 27.6949
2024-11-22 00:30:45: [2024-11-22 00:30:45] iter = 0910, loss = 33.0624
2024-11-22 00:33:05: [2024-11-22 00:33:05] iter = 0920, loss = 24.2055
2024-11-22 00:35:26: [2024-11-22 00:35:26] iter = 0930, loss = 30.2473
2024-11-22 00:37:52: [2024-11-22 00:37:52] iter = 0940, loss = 27.8703
2024-11-22 00:40:25: [2024-11-22 00:40:25] iter = 0950, loss = 26.1344
2024-11-22 00:42:47: [2024-11-22 00:42:47] iter = 0960, loss = 29.7696
2024-11-22 00:45:08: [2024-11-22 00:45:08] iter = 0970, loss = 33.8130
2024-11-22 00:47:48: [2024-11-22 00:47:48] iter = 0980, loss = 27.8545
2024-11-22 00:50:22: [2024-11-22 00:50:22] iter = 0990, loss = 30.1774
2024-11-22 00:52:40: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 00:52:40: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 00:52:40: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 59766}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 00:54:36: Evaluate 5 random ConvNet, ACCmean = 0.6372 ACCstd = 0.0037
-------------------------
2024-11-22 00:54:36: Evaluate 5 random ConvNet, F1mean = 0.6050 F!std = 0.0052
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 00:54:51: [2024-11-22 00:54:51] iter = 1000, loss = 29.9037
2024-11-22 00:54:51: 
================== Exp 1 ==================
 
2024-11-22 00:54:51: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'OrganSMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7ff1a58a6ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_OrganSMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 00:54:51: Evaluation model pool: ['ConvNet']
2024-11-22 00:54:52: class c = 0: 1148 real images
2024-11-22 00:54:52: class c = 1: 630 real images
2024-11-22 00:54:52: class c = 2: 614 real images
2024-11-22 00:54:52: class c = 3: 721 real images
2024-11-22 00:54:52: class c = 4: 1132 real images
2024-11-22 00:54:52: class c = 5: 1119 real images
2024-11-22 00:54:52: class c = 6: 3464 real images
2024-11-22 00:54:52: class c = 7: 741 real images
2024-11-22 00:54:52: class c = 8: 803 real images
2024-11-22 00:54:52: class c = 9: 2004 real images
2024-11-22 00:54:52: class c = 10: 1556 real images
2024-11-22 00:54:52: real images channel 0, mean = 0.4953, std = 0.2826
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 00:54:52: initialize synthetic data from random real images
2024-11-22 00:54:52: [2024-11-22 00:54:52] training begins
2024-11-22 00:54:52: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 00:54:52: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 00:54:52: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 90802}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 00:56:42: Evaluate 5 random ConvNet, ACCmean = 0.4695 ACCstd = 0.0053
-------------------------
2024-11-22 00:56:42: Evaluate 5 random ConvNet, F1mean = 0.4544 F!std = 0.0058
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 00:56:58: [2024-11-22 00:56:58] iter = 0000, loss = 57.0478
2024-11-22 00:59:27: [2024-11-22 00:59:27] iter = 0010, loss = 41.9803
2024-11-22 01:01:39: [2024-11-22 01:01:39] iter = 0020, loss = 39.3429
2024-11-22 01:03:58: [2024-11-22 01:03:58] iter = 0030, loss = 34.3526
2024-11-22 01:06:18: [2024-11-22 01:06:18] iter = 0040, loss = 40.7686
2024-11-22 01:08:40: [2024-11-22 01:08:40] iter = 0050, loss = 32.2639
2024-11-22 01:11:04: [2024-11-22 01:11:04] iter = 0060, loss = 32.5157
2024-11-22 01:13:28: [2024-11-22 01:13:28] iter = 0070, loss = 31.7177
2024-11-22 01:15:51: [2024-11-22 01:15:51] iter = 0080, loss = 31.3784
2024-11-22 01:18:16: [2024-11-22 01:18:16] iter = 0090, loss = 35.4704
2024-11-22 01:20:39: [2024-11-22 01:20:39] iter = 0100, loss = 31.8641
2024-11-22 01:23:06: [2024-11-22 01:23:06] iter = 0110, loss = 33.4914
2024-11-22 01:25:36: [2024-11-22 01:25:36] iter = 0120, loss = 34.6496
2024-11-22 01:28:01: [2024-11-22 01:28:01] iter = 0130, loss = 27.6895
2024-11-22 01:30:30: [2024-11-22 01:30:30] iter = 0140, loss = 30.8933
2024-11-22 01:33:01: [2024-11-22 01:33:01] iter = 0150, loss = 29.8458
2024-11-22 01:35:15: [2024-11-22 01:35:15] iter = 0160, loss = 39.4300
2024-11-22 01:37:25: [2024-11-22 01:37:25] iter = 0170, loss = 33.3203
2024-11-22 01:39:42: [2024-11-22 01:39:42] iter = 0180, loss = 31.2542
2024-11-22 01:41:57: [2024-11-22 01:41:57] iter = 0190, loss = 40.9366
2024-11-22 01:44:22: [2024-11-22 01:44:22] iter = 0200, loss = 28.7665
2024-11-22 01:46:49: [2024-11-22 01:46:49] iter = 0210, loss = 44.6086
2024-11-22 01:49:09: [2024-11-22 01:49:09] iter = 0220, loss = 28.5997
2024-11-22 01:51:29: [2024-11-22 01:51:29] iter = 0230, loss = 35.6126
2024-11-22 01:53:46: [2024-11-22 01:53:46] iter = 0240, loss = 29.3787
2024-11-22 01:56:06: [2024-11-22 01:56:06] iter = 0250, loss = 27.9959
2024-11-22 01:58:23: [2024-11-22 01:58:23] iter = 0260, loss = 30.9584
2024-11-22 02:00:43: [2024-11-22 02:00:43] iter = 0270, loss = 31.5668
2024-11-22 02:03:03: [2024-11-22 02:03:03] iter = 0280, loss = 28.0574
2024-11-22 02:05:20: [2024-11-22 02:05:20] iter = 0290, loss = 34.2659
2024-11-22 02:07:47: [2024-11-22 02:07:47] iter = 0300, loss = 31.5774
2024-11-22 02:10:28: [2024-11-22 02:10:28] iter = 0310, loss = 30.0135
2024-11-22 02:12:51: [2024-11-22 02:12:51] iter = 0320, loss = 27.9460
2024-11-22 02:15:14: [2024-11-22 02:15:14] iter = 0330, loss = 31.6890
2024-11-22 02:17:34: [2024-11-22 02:17:34] iter = 0340, loss = 38.2028
2024-11-22 02:19:51: [2024-11-22 02:19:51] iter = 0350, loss = 31.9443
2024-11-22 02:22:08: [2024-11-22 02:22:08] iter = 0360, loss = 34.2409
2024-11-22 02:24:26: [2024-11-22 02:24:26] iter = 0370, loss = 32.0218
2024-11-22 02:26:57: [2024-11-22 02:26:57] iter = 0380, loss = 30.6364
2024-11-22 02:29:28: [2024-11-22 02:29:28] iter = 0390, loss = 31.9648
2024-11-22 02:31:54: [2024-11-22 02:31:54] iter = 0400, loss = 32.4263
2024-11-22 02:34:19: [2024-11-22 02:34:19] iter = 0410, loss = 36.6873
2024-11-22 02:36:53: [2024-11-22 02:36:53] iter = 0420, loss = 26.0322
2024-11-22 02:39:14: [2024-11-22 02:39:14] iter = 0430, loss = 27.4646
2024-11-22 02:41:43: [2024-11-22 02:41:43] iter = 0440, loss = 33.3238
2024-11-22 02:44:12: [2024-11-22 02:44:12] iter = 0450, loss = 34.4691
2024-11-22 02:46:33: [2024-11-22 02:46:33] iter = 0460, loss = 28.2634
2024-11-22 02:49:00: [2024-11-22 02:49:00] iter = 0470, loss = 30.0065
2024-11-22 02:51:19: [2024-11-22 02:51:19] iter = 0480, loss = 28.5036
2024-11-22 02:53:46: [2024-11-22 02:53:46] iter = 0490, loss = 29.3401
2024-11-22 02:55:57: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 02:55:57: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 02:55:57: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 57513}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 02:57:43: Evaluate 5 random ConvNet, ACCmean = 0.6132 ACCstd = 0.0038
-------------------------
2024-11-22 02:57:43: Evaluate 5 random ConvNet, F1mean = 0.5795 F!std = 0.0035
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 02:57:59: [2024-11-22 02:57:59] iter = 0500, loss = 38.9230
2024-11-22 03:00:25: [2024-11-22 03:00:25] iter = 0510, loss = 35.5647
2024-11-22 03:02:54: [2024-11-22 03:02:54] iter = 0520, loss = 25.9091
2024-11-22 03:05:19: [2024-11-22 03:05:19] iter = 0530, loss = 30.0233
2024-11-22 03:07:44: [2024-11-22 03:07:44] iter = 0540, loss = 22.7684
2024-11-22 03:10:08: [2024-11-22 03:10:08] iter = 0550, loss = 30.1620
2024-11-22 03:12:32: [2024-11-22 03:12:32] iter = 0560, loss = 29.0951
2024-11-22 03:14:59: [2024-11-22 03:14:59] iter = 0570, loss = 28.9489
2024-11-22 03:17:22: [2024-11-22 03:17:22] iter = 0580, loss = 30.8616
2024-11-22 03:19:43: [2024-11-22 03:19:43] iter = 0590, loss = 28.3711
2024-11-22 03:21:59: [2024-11-22 03:21:59] iter = 0600, loss = 32.2128
2024-11-22 03:24:20: [2024-11-22 03:24:20] iter = 0610, loss = 24.8546
2024-11-22 03:26:44: [2024-11-22 03:26:44] iter = 0620, loss = 26.7113
2024-11-22 03:29:10: [2024-11-22 03:29:10] iter = 0630, loss = 34.0388
2024-11-22 03:31:32: [2024-11-22 03:31:32] iter = 0640, loss = 29.7927
2024-11-22 03:33:52: [2024-11-22 03:33:52] iter = 0650, loss = 25.3100
2024-11-22 03:36:21: [2024-11-22 03:36:21] iter = 0660, loss = 33.6882
2024-11-22 03:38:45: [2024-11-22 03:38:45] iter = 0670, loss = 27.1475
2024-11-22 03:41:13: [2024-11-22 03:41:13] iter = 0680, loss = 33.8581
2024-11-22 03:43:37: [2024-11-22 03:43:37] iter = 0690, loss = 28.9327
2024-11-22 03:45:58: [2024-11-22 03:45:58] iter = 0700, loss = 27.5221
2024-11-22 03:48:19: [2024-11-22 03:48:19] iter = 0710, loss = 30.4124
2024-11-22 03:50:41: [2024-11-22 03:50:41] iter = 0720, loss = 24.3232
2024-11-22 03:53:04: [2024-11-22 03:53:04] iter = 0730, loss = 29.5519
2024-11-22 03:55:27: [2024-11-22 03:55:27] iter = 0740, loss = 30.4893
2024-11-22 03:57:55: [2024-11-22 03:57:55] iter = 0750, loss = 38.6202
2024-11-22 04:00:17: [2024-11-22 04:00:17] iter = 0760, loss = 32.0434
2024-11-22 04:02:39: [2024-11-22 04:02:39] iter = 0770, loss = 30.5567
2024-11-22 04:05:02: [2024-11-22 04:05:02] iter = 0780, loss = 34.6827
2024-11-22 04:07:26: [2024-11-22 04:07:26] iter = 0790, loss = 29.4256
2024-11-22 04:09:49: [2024-11-22 04:09:49] iter = 0800, loss = 21.9144
2024-11-22 04:12:12: [2024-11-22 04:12:12] iter = 0810, loss = 32.3557
2024-11-22 04:14:35: [2024-11-22 04:14:35] iter = 0820, loss = 28.7882
2024-11-22 04:17:02: [2024-11-22 04:17:02] iter = 0830, loss = 31.5100
2024-11-22 04:19:25: [2024-11-22 04:19:25] iter = 0840, loss = 27.5621
2024-11-22 04:21:49: [2024-11-22 04:21:49] iter = 0850, loss = 30.9046
2024-11-22 04:24:06: [2024-11-22 04:24:06] iter = 0860, loss = 36.0524
2024-11-22 04:26:29: [2024-11-22 04:26:29] iter = 0870, loss = 33.8706
2024-11-22 04:28:51: [2024-11-22 04:28:51] iter = 0880, loss = 27.9076
2024-11-22 04:31:13: [2024-11-22 04:31:13] iter = 0890, loss = 27.5049
2024-11-22 04:33:34: [2024-11-22 04:33:34] iter = 0900, loss = 31.5659
2024-11-22 04:35:52: [2024-11-22 04:35:52] iter = 0910, loss = 29.5349
2024-11-22 04:38:15: [2024-11-22 04:38:15] iter = 0920, loss = 27.5616
2024-11-22 04:40:34: [2024-11-22 04:40:34] iter = 0930, loss = 28.1926
2024-11-22 04:42:59: [2024-11-22 04:42:59] iter = 0940, loss = 33.9910
2024-11-22 04:45:22: [2024-11-22 04:45:22] iter = 0950, loss = 32.8197
2024-11-22 04:47:54: [2024-11-22 04:47:54] iter = 0960, loss = 29.6670
2024-11-22 04:50:13: [2024-11-22 04:50:13] iter = 0970, loss = 34.7491
2024-11-22 04:52:35: [2024-11-22 04:52:35] iter = 0980, loss = 29.7039
2024-11-22 04:54:59: [2024-11-22 04:54:59] iter = 0990, loss = 28.0401
2024-11-22 04:57:05: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 04:57:05: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 04:57:05: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 25715}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 04:58:54: Evaluate 5 random ConvNet, ACCmean = 0.6257 ACCstd = 0.0034
-------------------------
2024-11-22 04:58:54: Evaluate 5 random ConvNet, F1mean = 0.5988 F!std = 0.0042
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 04:59:09: [2024-11-22 04:59:09] iter = 1000, loss = 28.1435
2024-11-22 04:59:09: 
================== Exp 2 ==================
 
2024-11-22 04:59:09: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'OrganSMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7ff1a58a6ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_OrganSMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 04:59:09: Evaluation model pool: ['ConvNet']
2024-11-22 04:59:10: class c = 0: 1148 real images
2024-11-22 04:59:10: class c = 1: 630 real images
2024-11-22 04:59:10: class c = 2: 614 real images
2024-11-22 04:59:10: class c = 3: 721 real images
2024-11-22 04:59:10: class c = 4: 1132 real images
2024-11-22 04:59:10: class c = 5: 1119 real images
2024-11-22 04:59:10: class c = 6: 3464 real images
2024-11-22 04:59:10: class c = 7: 741 real images
2024-11-22 04:59:10: class c = 8: 803 real images
2024-11-22 04:59:10: class c = 9: 2004 real images
2024-11-22 04:59:10: class c = 10: 1556 real images
2024-11-22 04:59:10: real images channel 0, mean = 0.4953, std = 0.2826
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 04:59:10: initialize synthetic data from random real images
2024-11-22 04:59:10: [2024-11-22 04:59:10] training begins
2024-11-22 04:59:10: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 04:59:10: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 04:59:10: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 48929}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 05:00:58: Evaluate 5 random ConvNet, ACCmean = 0.4441 ACCstd = 0.0058
-------------------------
2024-11-22 05:00:58: Evaluate 5 random ConvNet, F1mean = 0.4289 F!std = 0.0051
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 05:01:13: [2024-11-22 05:01:13] iter = 0000, loss = 55.8582
2024-11-22 05:03:31: [2024-11-22 05:03:31] iter = 0010, loss = 34.0472
2024-11-22 05:05:48: [2024-11-22 05:05:48] iter = 0020, loss = 43.1072
2024-11-22 05:08:21: [2024-11-22 05:08:21] iter = 0030, loss = 33.9776
2024-11-22 05:10:44: [2024-11-22 05:10:44] iter = 0040, loss = 42.3158
2024-11-22 05:13:07: [2024-11-22 05:13:07] iter = 0050, loss = 36.0067
2024-11-22 05:15:39: [2024-11-22 05:15:39] iter = 0060, loss = 37.5453
2024-11-22 05:18:05: [2024-11-22 05:18:05] iter = 0070, loss = 34.7976
2024-11-22 05:20:34: [2024-11-22 05:20:34] iter = 0080, loss = 40.0857
2024-11-22 05:22:58: [2024-11-22 05:22:58] iter = 0090, loss = 33.2928
2024-11-22 05:25:25: [2024-11-22 05:25:25] iter = 0100, loss = 38.9099
2024-11-22 05:27:44: [2024-11-22 05:27:44] iter = 0110, loss = 35.2041
2024-11-22 05:30:04: [2024-11-22 05:30:04] iter = 0120, loss = 34.5368
2024-11-22 05:32:24: [2024-11-22 05:32:24] iter = 0130, loss = 34.3445
2024-11-22 05:34:52: [2024-11-22 05:34:52] iter = 0140, loss = 29.9192
2024-11-22 05:37:24: [2024-11-22 05:37:24] iter = 0150, loss = 34.7203
2024-11-22 05:39:49: [2024-11-22 05:39:49] iter = 0160, loss = 28.3585
2024-11-22 05:42:22: [2024-11-22 05:42:22] iter = 0170, loss = 33.4140
2024-11-22 05:44:30: [2024-11-22 05:44:30] iter = 0180, loss = 27.9642
2024-11-22 05:46:40: [2024-11-22 05:46:40] iter = 0190, loss = 24.1015
2024-11-22 05:48:49: [2024-11-22 05:48:49] iter = 0200, loss = 34.8120
2024-11-22 05:50:37: [2024-11-22 05:50:37] iter = 0210, loss = 30.9002
2024-11-22 05:52:25: [2024-11-22 05:52:25] iter = 0220, loss = 32.2343
2024-11-22 05:54:11: [2024-11-22 05:54:11] iter = 0230, loss = 34.8282
2024-11-22 05:56:00: [2024-11-22 05:56:00] iter = 0240, loss = 29.2486
2024-11-22 05:57:39: [2024-11-22 05:57:39] iter = 0250, loss = 32.4104
2024-11-22 05:59:22: [2024-11-22 05:59:22] iter = 0260, loss = 31.4682
2024-11-22 06:01:09: [2024-11-22 06:01:09] iter = 0270, loss = 33.6487
2024-11-22 06:02:42: [2024-11-22 06:02:42] iter = 0280, loss = 32.0312
2024-11-22 06:04:18: [2024-11-22 06:04:18] iter = 0290, loss = 34.0311
2024-11-22 06:06:01: [2024-11-22 06:06:01] iter = 0300, loss = 31.3140
2024-11-22 06:07:46: [2024-11-22 06:07:46] iter = 0310, loss = 29.3796
2024-11-22 06:09:28: [2024-11-22 06:09:28] iter = 0320, loss = 29.7684
2024-11-22 06:11:09: [2024-11-22 06:11:09] iter = 0330, loss = 41.0316
2024-11-22 06:12:50: [2024-11-22 06:12:50] iter = 0340, loss = 32.2016
2024-11-22 06:14:31: [2024-11-22 06:14:31] iter = 0350, loss = 35.0983
2024-11-22 06:16:18: [2024-11-22 06:16:18] iter = 0360, loss = 43.7180
2024-11-22 06:18:09: [2024-11-22 06:18:09] iter = 0370, loss = 33.6168
2024-11-22 06:19:47: [2024-11-22 06:19:47] iter = 0380, loss = 29.8613
2024-11-22 06:21:35: [2024-11-22 06:21:35] iter = 0390, loss = 36.3174
2024-11-22 06:23:25: [2024-11-22 06:23:25] iter = 0400, loss = 31.2750
2024-11-22 06:25:18: [2024-11-22 06:25:18] iter = 0410, loss = 36.5502
2024-11-22 06:27:13: [2024-11-22 06:27:13] iter = 0420, loss = 30.6381
2024-11-22 06:29:01: [2024-11-22 06:29:01] iter = 0430, loss = 34.5950
2024-11-22 06:30:48: [2024-11-22 06:30:48] iter = 0440, loss = 27.2815
2024-11-22 06:32:37: [2024-11-22 06:32:37] iter = 0450, loss = 31.3544
2024-11-22 06:34:27: [2024-11-22 06:34:27] iter = 0460, loss = 40.4553
2024-11-22 06:36:16: [2024-11-22 06:36:16] iter = 0470, loss = 26.5389
2024-11-22 06:38:05: [2024-11-22 06:38:05] iter = 0480, loss = 28.3307
2024-11-22 06:39:53: [2024-11-22 06:39:53] iter = 0490, loss = 29.9989
2024-11-22 06:41:30: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 06:41:30: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 06:41:30: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 90365}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 06:42:49: Evaluate 5 random ConvNet, ACCmean = 0.6138 ACCstd = 0.0017
-------------------------
2024-11-22 06:42:49: Evaluate 5 random ConvNet, F1mean = 0.5831 F!std = 0.0037
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 06:42:58: [2024-11-22 06:42:58] iter = 0500, loss = 29.1994
2024-11-22 06:44:51: [2024-11-22 06:44:51] iter = 0510, loss = 30.8487
2024-11-22 06:46:38: [2024-11-22 06:46:37] iter = 0520, loss = 30.1431
2024-11-22 06:48:27: [2024-11-22 06:48:27] iter = 0530, loss = 27.0905
2024-11-22 06:50:15: [2024-11-22 06:50:15] iter = 0540, loss = 26.5322
2024-11-22 06:51:58: [2024-11-22 06:51:58] iter = 0550, loss = 34.9347
2024-11-22 06:53:44: [2024-11-22 06:53:44] iter = 0560, loss = 29.4044
2024-11-22 06:55:29: [2024-11-22 06:55:29] iter = 0570, loss = 29.9348
2024-11-22 06:57:14: [2024-11-22 06:57:14] iter = 0580, loss = 27.2494
2024-11-22 06:59:09: [2024-11-22 06:59:09] iter = 0590, loss = 26.0798
2024-11-22 07:00:54: [2024-11-22 07:00:54] iter = 0600, loss = 32.3886
2024-11-22 07:02:46: [2024-11-22 07:02:46] iter = 0610, loss = 32.9136
2024-11-22 07:04:38: [2024-11-22 07:04:38] iter = 0620, loss = 24.9870
2024-11-22 07:06:29: [2024-11-22 07:06:29] iter = 0630, loss = 24.2003
2024-11-22 07:08:19: [2024-11-22 07:08:19] iter = 0640, loss = 37.8219
2024-11-22 07:10:09: [2024-11-22 07:10:09] iter = 0650, loss = 27.7043
2024-11-22 07:11:59: [2024-11-22 07:11:59] iter = 0660, loss = 30.9049
2024-11-22 07:13:50: [2024-11-22 07:13:50] iter = 0670, loss = 32.8331
2024-11-22 07:15:44: [2024-11-22 07:15:44] iter = 0680, loss = 31.5797
2024-11-22 07:17:30: [2024-11-22 07:17:30] iter = 0690, loss = 28.8747
2024-11-22 07:19:20: [2024-11-22 07:19:20] iter = 0700, loss = 39.3944
2024-11-22 07:21:08: [2024-11-22 07:21:08] iter = 0710, loss = 35.7818
2024-11-22 07:23:01: [2024-11-22 07:23:01] iter = 0720, loss = 25.9866
2024-11-22 07:24:53: [2024-11-22 07:24:53] iter = 0730, loss = 29.7560
2024-11-22 07:26:38: [2024-11-22 07:26:38] iter = 0740, loss = 27.0339
2024-11-22 07:28:29: [2024-11-22 07:28:29] iter = 0750, loss = 29.0250
2024-11-22 07:30:19: [2024-11-22 07:30:19] iter = 0760, loss = 25.4726
2024-11-22 07:32:11: [2024-11-22 07:32:11] iter = 0770, loss = 31.2110
2024-11-22 07:33:57: [2024-11-22 07:33:57] iter = 0780, loss = 29.0953
2024-11-22 07:35:44: [2024-11-22 07:35:44] iter = 0790, loss = 30.1106
2024-11-22 07:37:34: [2024-11-22 07:37:34] iter = 0800, loss = 29.8460
2024-11-22 07:39:21: [2024-11-22 07:39:21] iter = 0810, loss = 36.1839
2024-11-22 07:41:13: [2024-11-22 07:41:13] iter = 0820, loss = 32.3225
2024-11-22 07:43:05: [2024-11-22 07:43:05] iter = 0830, loss = 26.1999
2024-11-22 07:44:56: [2024-11-22 07:44:56] iter = 0840, loss = 31.6117
2024-11-22 07:46:53: [2024-11-22 07:46:53] iter = 0850, loss = 27.6894
2024-11-22 07:48:46: [2024-11-22 07:48:46] iter = 0860, loss = 26.9013
2024-11-22 07:50:39: [2024-11-22 07:50:39] iter = 0870, loss = 28.5741
2024-11-22 07:52:30: [2024-11-22 07:52:30] iter = 0880, loss = 31.4731
2024-11-22 07:54:19: [2024-11-22 07:54:19] iter = 0890, loss = 26.3370
2024-11-22 07:56:10: [2024-11-22 07:56:10] iter = 0900, loss = 30.5393
2024-11-22 07:57:54: [2024-11-22 07:57:54] iter = 0910, loss = 28.2953
2024-11-22 07:59:38: [2024-11-22 07:59:38] iter = 0920, loss = 21.2325
2024-11-22 08:01:21: [2024-11-22 08:01:21] iter = 0930, loss = 22.7872
2024-11-22 08:03:08: [2024-11-22 08:03:08] iter = 0940, loss = 37.5355
2024-11-22 08:04:51: [2024-11-22 08:04:51] iter = 0950, loss = 28.3626
2024-11-22 08:06:32: [2024-11-22 08:06:32] iter = 0960, loss = 26.1759
2024-11-22 08:08:16: [2024-11-22 08:08:16] iter = 0970, loss = 35.1048
2024-11-22 08:10:00: [2024-11-22 08:10:00] iter = 0980, loss = 26.4774
2024-11-22 08:11:41: [2024-11-22 08:11:41] iter = 0990, loss = 29.3249
2024-11-22 08:13:11: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 08:13:11: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 08:13:11: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 91338}
Using downloaded and verified file: /data/users/xiongyuxuan/.medmnist/organsmnist.npz
Using downloaded and verified file: /data/users/xiongyuxuan/.medmnist/organsmnist.npz
Loaded the dataset:OrganSMNIST
[2024-11-21 20:47:18] Evaluate_00: epoch = 1000 train time = 26 s train loss = 0.013420 train acc = 1.0000, test acc = 0.4338, test_sen =0.4337, test_spe =0.9421, test_f1 =0.4293
[2024-11-21 20:47:41] Evaluate_01: epoch = 1000 train time = 22 s train loss = 0.039476 train acc = 1.0000, test acc = 0.4202, test_sen =0.4222, test_spe =0.9410, test_f1 =0.4146
[2024-11-21 20:48:05] Evaluate_02: epoch = 1000 train time = 22 s train loss = 0.022139 train acc = 1.0000, test acc = 0.4306, test_sen =0.4328, test_spe =0.9418, test_f1 =0.4284
[2024-11-21 20:48:30] Evaluate_03: epoch = 1000 train time = 24 s train loss = 0.013370 train acc = 1.0000, test acc = 0.4261, test_sen =0.4301, test_spe =0.9415, test_f1 =0.4237
[2024-11-21 20:48:53] Evaluate_04: epoch = 1000 train time = 22 s train loss = 0.003217 train acc = 1.0000, test acc = 0.4297, test_sen =0.4349, test_spe =0.9419, test_f1 =0.4264
[2024-11-21 22:50:14] Evaluate_00: epoch = 1000 train time = 21 s train loss = 0.012776 train acc = 1.0000, test acc = 0.6145, test_sen =0.5990, test_spe =0.9609, test_f1 =0.5841
[2024-11-21 22:50:35] Evaluate_01: epoch = 1000 train time = 20 s train loss = 0.009734 train acc = 1.0000, test acc = 0.6172, test_sen =0.6018, test_spe =0.9613, test_f1 =0.5881
[2024-11-21 22:50:57] Evaluate_02: epoch = 1000 train time = 22 s train loss = 0.010422 train acc = 1.0000, test acc = 0.6180, test_sen =0.6031, test_spe =0.9612, test_f1 =0.5871
[2024-11-21 22:51:18] Evaluate_03: epoch = 1000 train time = 20 s train loss = 0.034075 train acc = 1.0000, test acc = 0.6115, test_sen =0.5955, test_spe =0.9605, test_f1 =0.5827
[2024-11-21 22:51:41] Evaluate_04: epoch = 1000 train time = 21 s train loss = 0.032162 train acc = 1.0000, test acc = 0.6146, test_sen =0.5963, test_spe =0.9609, test_f1 =0.5818
[2024-11-22 00:53:05] Evaluate_00: epoch = 1000 train time = 24 s train loss = 0.007537 train acc = 1.0000, test acc = 0.6372, test_sen =0.6082, test_spe =0.9632, test_f1 =0.5969
[2024-11-22 00:53:28] Evaluate_01: epoch = 1000 train time = 22 s train loss = 0.129916 train acc = 0.9818, test acc = 0.6359, test_sen =0.6113, test_spe =0.9630, test_f1 =0.6039
[2024-11-22 00:53:51] Evaluate_02: epoch = 1000 train time = 21 s train loss = 0.033588 train acc = 1.0000, test acc = 0.6326, test_sen =0.6177, test_spe =0.9628, test_f1 =0.6094
[2024-11-22 00:54:13] Evaluate_03: epoch = 1000 train time = 21 s train loss = 0.016016 train acc = 1.0000, test acc = 0.6438, test_sen =0.6165, test_spe =0.9636, test_f1 =0.6118
[2024-11-22 00:54:36] Evaluate_04: epoch = 1000 train time = 22 s train loss = 0.006666 train acc = 1.0000, test acc = 0.6363, test_sen =0.6120, test_spe =0.9630, test_f1 =0.6030
[2024-11-22 00:55:14] Evaluate_00: epoch = 1000 train time = 21 s train loss = 0.015038 train acc = 1.0000, test acc = 0.4672, test_sen =0.4570, test_spe =0.9459, test_f1 =0.4498
[2024-11-22 00:55:36] Evaluate_01: epoch = 1000 train time = 21 s train loss = 0.041566 train acc = 1.0000, test acc = 0.4700, test_sen =0.4654, test_spe =0.9463, test_f1 =0.4587
[2024-11-22 00:55:57] Evaluate_02: epoch = 1000 train time = 19 s train loss = 0.059491 train acc = 1.0000, test acc = 0.4788, test_sen =0.4687, test_spe =0.9470, test_f1 =0.4622
[2024-11-22 00:56:19] Evaluate_03: epoch = 1000 train time = 21 s train loss = 0.016497 train acc = 1.0000, test acc = 0.4624, test_sen =0.4564, test_spe =0.9454, test_f1 =0.4463
[2024-11-22 00:56:42] Evaluate_04: epoch = 1000 train time = 22 s train loss = 0.011211 train acc = 1.0000, test acc = 0.4689, test_sen =0.4650, test_spe =0.9463, test_f1 =0.4549
[2024-11-22 02:56:18] Evaluate_00: epoch = 1000 train time = 20 s train loss = 0.009276 train acc = 1.0000, test acc = 0.6112, test_sen =0.5865, test_spe =0.9605, test_f1 =0.5804
[2024-11-22 02:56:39] Evaluate_01: epoch = 1000 train time = 20 s train loss = 0.011398 train acc = 1.0000, test acc = 0.6144, test_sen =0.5901, test_spe =0.9607, test_f1 =0.5818
[2024-11-22 02:57:01] Evaluate_02: epoch = 1000 train time = 20 s train loss = 0.078651 train acc = 1.0000, test acc = 0.6133, test_sen =0.5795, test_spe =0.9605, test_f1 =0.5726
[2024-11-22 02:57:21] Evaluate_03: epoch = 1000 train time = 19 s train loss = 0.017127 train acc = 1.0000, test acc = 0.6192, test_sen =0.5905, test_spe =0.9613, test_f1 =0.5813
[2024-11-22 02:57:43] Evaluate_04: epoch = 1000 train time = 21 s train loss = 0.068451 train acc = 0.9909, test acc = 0.6077, test_sen =0.5851, test_spe =0.9600, test_f1 =0.5815
[2024-11-22 04:57:27] Evaluate_00: epoch = 1000 train time = 20 s train loss = 0.104260 train acc = 0.9909, test acc = 0.6278, test_sen =0.6099, test_spe =0.9622, test_f1 =0.5989
[2024-11-22 04:57:49] Evaluate_01: epoch = 1000 train time = 21 s train loss = 0.012506 train acc = 1.0000, test acc = 0.6255, test_sen =0.6050, test_spe =0.9618, test_f1 =0.5993
[2024-11-22 04:58:13] Evaluate_02: epoch = 1000 train time = 23 s train loss = 0.040371 train acc = 1.0000, test acc = 0.6195, test_sen =0.5975, test_spe =0.9611, test_f1 =0.5918
[2024-11-22 04:58:32] Evaluate_03: epoch = 1000 train time = 18 s train loss = 0.009177 train acc = 1.0000, test acc = 0.6266, test_sen =0.6044, test_spe =0.9618, test_f1 =0.5991
[2024-11-22 04:58:54] Evaluate_04: epoch = 1000 train time = 21 s train loss = 0.039791 train acc = 1.0000, test acc = 0.6292, test_sen =0.6137, test_spe =0.9624, test_f1 =0.6050
[2024-11-22 04:59:32] Evaluate_00: epoch = 1000 train time = 21 s train loss = 0.007452 train acc = 1.0000, test acc = 0.4444, test_sen =0.4445, test_spe =0.9436, test_f1 =0.4347
[2024-11-22 04:59:54] Evaluate_01: epoch = 1000 train time = 21 s train loss = 0.017964 train acc = 1.0000, test acc = 0.4464, test_sen =0.4436, test_spe =0.9439, test_f1 =0.4313
[2024-11-22 05:00:15] Evaluate_02: epoch = 1000 train time = 20 s train loss = 0.009554 train acc = 1.0000, test acc = 0.4515, test_sen =0.4421, test_spe =0.9443, test_f1 =0.4328
[2024-11-22 05:00:38] Evaluate_03: epoch = 1000 train time = 21 s train loss = 0.027477 train acc = 1.0000, test acc = 0.4336, test_sen =0.4351, test_spe =0.9424, test_f1 =0.4217
[2024-11-22 05:00:58] Evaluate_04: epoch = 1000 train time = 19 s train loss = 0.024951 train acc = 1.0000, test acc = 0.4445, test_sen =0.4327, test_spe =0.9435, test_f1 =0.4240
[2024-11-22 06:41:50] Evaluate_00: epoch = 1000 train time = 19 s train loss = 0.031436 train acc = 1.0000, test acc = 0.6154, test_sen =0.5957, test_spe =0.9608, test_f1 =0.5865
[2024-11-22 06:42:06] Evaluate_01: epoch = 1000 train time = 15 s train loss = 0.046061 train acc = 1.0000, test acc = 0.6113, test_sen =0.5899, test_spe =0.9604, test_f1 =0.5790
[2024-11-22 06:42:20] Evaluate_02: epoch = 1000 train time = 13 s train loss = 0.008437 train acc = 1.0000, test acc = 0.6138, test_sen =0.5874, test_spe =0.9604, test_f1 =0.5812
[2024-11-22 06:42:35] Evaluate_03: epoch = 1000 train time = 13 s train loss = 0.006611 train acc = 1.0000, test acc = 0.6126, test_sen =0.5894, test_spe =0.9605, test_f1 =0.5804
[2024-11-22 06:42:49] Evaluate_04: epoch = 1000 train time = 13 s train loss = 0.054566 train acc = 0.9909, test acc = 0.6160, test_sen =0.5994, test_spe =0.9609, test_f1 =0.5883
[2024-11-22 08:13:27] Evaluate_00: epoch = 1000 train time = 15 s train loss = 0.132609 train acc = 0.9909, test acc = 0.6292, test_sen =0.6106, test_spe =0.9623, test_f1 =0.6036
[2024-11-22 08:13:42] Evaluate_01: epoch = 1000 train time = 14 s train loss = 0.067177 train acc = 0.9818, test acc = 0.6254, test_sen =0.6100, test_spe =0.9619, test_f1 =0.6005
[2024-11-22 08:13:58] Evaluate_02: epoch = 1000 train time = 15 s train loss = 0.005909 train acc = 1.0000, test acc = 0.6255, test_sen =0.6046, test_spe =0.9618, test_f1 =0.6007
[2024-11-22 08:14:14] Evaluate_03: epoch = 1000 train time = 15 s train loss = 0.011818 train acc = 1.0000, test acc = 0.6334, test_sen =0.6150, test_spe =0.9626, test_f1 =0.6091
[2024-11-22 08:14:28] Evaluate_04: epoch = 1000 train time = 13 s train loss = 0.010716 train acc = 1.0000, test acc = 0.6365, test_sen =0.6114, test_spe =0.9629, test_f1 =0.6061/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 08:14:28: Evaluate 5 random ConvNet, ACCmean = 0.6300 ACCstd = 0.0044
-------------------------
2024-11-22 08:14:28: Evaluate 5 random ConvNet, F1mean = 0.6040 F!std = 0.0033
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 08:14:37: [2024-11-22 08:14:37] iter = 1000, loss = 29.8258
2024-11-22 08:14:37: 
================== Exp 3 ==================
 
2024-11-22 08:14:37: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'OrganSMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7ff1a58a6ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_OrganSMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 08:14:37: Evaluation model pool: ['ConvNet']
2024-11-22 08:14:38: class c = 0: 1148 real images
2024-11-22 08:14:38: class c = 1: 630 real images
2024-11-22 08:14:38: class c = 2: 614 real images
2024-11-22 08:14:38: class c = 3: 721 real images
2024-11-22 08:14:38: class c = 4: 1132 real images
2024-11-22 08:14:38: class c = 5: 1119 real images
2024-11-22 08:14:38: class c = 6: 3464 real images
2024-11-22 08:14:38: class c = 7: 741 real images
2024-11-22 08:14:38: class c = 8: 803 real images
2024-11-22 08:14:38: class c = 9: 2004 real images
2024-11-22 08:14:38: class c = 10: 1556 real images
2024-11-22 08:14:38: real images channel 0, mean = 0.4953, std = 0.2826
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 08:14:38: initialize synthetic data from random real images
2024-11-22 08:14:38: [2024-11-22 08:14:38] training begins
2024-11-22 08:14:38: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 08:14:38: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 08:14:38: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 77219}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 08:15:58: Evaluate 5 random ConvNet, ACCmean = 0.4798 ACCstd = 0.0097
-------------------------
2024-11-22 08:15:58: Evaluate 5 random ConvNet, F1mean = 0.4593 F!std = 0.0060
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 08:16:09: [2024-11-22 08:16:09] iter = 0000, loss = 57.3211
2024-11-22 08:17:33: [2024-11-22 08:17:33] iter = 0010, loss = 46.8154
2024-11-22 08:18:56: [2024-11-22 08:18:56] iter = 0020, loss = 32.2190
2024-11-22 08:20:15: [2024-11-22 08:20:15] iter = 0030, loss = 31.5302
2024-11-22 08:21:38: [2024-11-22 08:21:38] iter = 0040, loss = 31.9567
2024-11-22 08:23:02: [2024-11-22 08:23:02] iter = 0050, loss = 32.7860
2024-11-22 08:24:25: [2024-11-22 08:24:25] iter = 0060, loss = 32.7854
2024-11-22 08:25:50: [2024-11-22 08:25:50] iter = 0070, loss = 37.1646
2024-11-22 08:27:13: [2024-11-22 08:27:13] iter = 0080, loss = 39.4535
2024-11-22 08:28:40: [2024-11-22 08:28:40] iter = 0090, loss = 31.8617
2024-11-22 08:30:06: [2024-11-22 08:30:06] iter = 0100, loss = 36.0693
2024-11-22 08:31:28: [2024-11-22 08:31:28] iter = 0110, loss = 29.0499
2024-11-22 08:32:54: [2024-11-22 08:32:54] iter = 0120, loss = 31.1564
2024-11-22 08:34:14: [2024-11-22 08:34:14] iter = 0130, loss = 31.8980
2024-11-22 08:35:36: [2024-11-22 08:35:36] iter = 0140, loss = 37.4989
2024-11-22 08:37:00: [2024-11-22 08:37:00] iter = 0150, loss = 31.0044
2024-11-22 08:38:27: [2024-11-22 08:38:27] iter = 0160, loss = 28.8096
2024-11-22 08:39:50: [2024-11-22 08:39:50] iter = 0170, loss = 33.2627
2024-11-22 08:41:16: [2024-11-22 08:41:16] iter = 0180, loss = 35.0967
2024-11-22 08:42:39: [2024-11-22 08:42:39] iter = 0190, loss = 30.0268
2024-11-22 08:44:01: [2024-11-22 08:44:01] iter = 0200, loss = 29.6994
2024-11-22 08:45:25: [2024-11-22 08:45:25] iter = 0210, loss = 27.1581
2024-11-22 08:46:50: [2024-11-22 08:46:50] iter = 0220, loss = 31.6749
2024-11-22 08:48:13: [2024-11-22 08:48:13] iter = 0230, loss = 35.7521
2024-11-22 08:49:39: [2024-11-22 08:49:39] iter = 0240, loss = 40.8129
2024-11-22 08:51:02: [2024-11-22 08:51:02] iter = 0250, loss = 33.0713
2024-11-22 08:52:24: [2024-11-22 08:52:24] iter = 0260, loss = 27.6734
2024-11-22 08:53:52: [2024-11-22 08:53:52] iter = 0270, loss = 27.5437
2024-11-22 08:55:18: [2024-11-22 08:55:18] iter = 0280, loss = 30.2679
2024-11-22 08:56:47: [2024-11-22 08:56:47] iter = 0290, loss = 25.8729
2024-11-22 08:58:12: [2024-11-22 08:58:12] iter = 0300, loss = 31.6754
2024-11-22 08:59:34: [2024-11-22 08:59:34] iter = 0310, loss = 26.2721
2024-11-22 09:00:54: [2024-11-22 09:00:54] iter = 0320, loss = 24.4991
2024-11-22 09:02:16: [2024-11-22 09:02:16] iter = 0330, loss = 26.9513
2024-11-22 09:03:40: [2024-11-22 09:03:40] iter = 0340, loss = 29.1977
2024-11-22 09:05:01: [2024-11-22 09:05:01] iter = 0350, loss = 34.4214
2024-11-22 09:06:23: [2024-11-22 09:06:23] iter = 0360, loss = 31.3715
2024-11-22 09:07:51: [2024-11-22 09:07:51] iter = 0370, loss = 35.4854
2024-11-22 09:09:21: [2024-11-22 09:09:21] iter = 0380, loss = 35.6830
2024-11-22 09:10:51: [2024-11-22 09:10:51] iter = 0390, loss = 34.5395
2024-11-22 09:12:16: [2024-11-22 09:12:16] iter = 0400, loss = 28.3316
2024-11-22 09:13:42: [2024-11-22 09:13:42] iter = 0410, loss = 29.0921
2024-11-22 09:15:09: [2024-11-22 09:15:09] iter = 0420, loss = 30.5714
2024-11-22 09:16:36: [2024-11-22 09:16:36] iter = 0430, loss = 28.7268
2024-11-22 09:17:58: [2024-11-22 09:17:58] iter = 0440, loss = 33.3459
2024-11-22 09:19:25: [2024-11-22 09:19:25] iter = 0450, loss = 27.5748
2024-11-22 09:20:48: [2024-11-22 09:20:48] iter = 0460, loss = 38.3038
2024-11-22 09:22:08: [2024-11-22 09:22:08] iter = 0470, loss = 31.0447
2024-11-22 09:23:28: [2024-11-22 09:23:28] iter = 0480, loss = 39.2423
2024-11-22 09:24:57: [2024-11-22 09:24:57] iter = 0490, loss = 26.8176
2024-11-22 09:26:16: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 09:26:16: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 09:26:16: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 76785}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 09:27:20: Evaluate 5 random ConvNet, ACCmean = 0.6188 ACCstd = 0.0047
-------------------------
2024-11-22 09:27:20: Evaluate 5 random ConvNet, F1mean = 0.5887 F!std = 0.0059
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 09:27:28: [2024-11-22 09:27:28] iter = 0500, loss = 27.8190
2024-11-22 09:28:45: [2024-11-22 09:28:45] iter = 0510, loss = 23.6505
2024-11-22 09:30:10: [2024-11-22 09:30:10] iter = 0520, loss = 33.0540
2024-11-22 09:31:34: [2024-11-22 09:31:34] iter = 0530, loss = 33.4361
2024-11-22 09:32:57: [2024-11-22 09:32:57] iter = 0540, loss = 31.8505
2024-11-22 09:34:25: [2024-11-22 09:34:25] iter = 0550, loss = 28.1172
2024-11-22 09:35:50: [2024-11-22 09:35:50] iter = 0560, loss = 35.3164
2024-11-22 09:37:19: [2024-11-22 09:37:19] iter = 0570, loss = 31.5094
2024-11-22 09:38:38: [2024-11-22 09:38:38] iter = 0580, loss = 29.9280
2024-11-22 09:40:07: [2024-11-22 09:40:07] iter = 0590, loss = 30.8135
2024-11-22 09:41:28: [2024-11-22 09:41:28] iter = 0600, loss = 30.4115
2024-11-22 09:42:54: [2024-11-22 09:42:54] iter = 0610, loss = 24.2609
2024-11-22 09:44:22: [2024-11-22 09:44:22] iter = 0620, loss = 34.1116
2024-11-22 09:45:52: [2024-11-22 09:45:52] iter = 0630, loss = 34.9157
2024-11-22 09:47:20: [2024-11-22 09:47:20] iter = 0640, loss = 25.7725
2024-11-22 09:48:47: [2024-11-22 09:48:47] iter = 0650, loss = 32.5552
2024-11-22 09:50:12: [2024-11-22 09:50:12] iter = 0660, loss = 30.4866
2024-11-22 09:51:38: [2024-11-22 09:51:38] iter = 0670, loss = 23.4029
2024-11-22 09:53:06: [2024-11-22 09:53:06] iter = 0680, loss = 36.9196
2024-11-22 09:54:34: [2024-11-22 09:54:34] iter = 0690, loss = 25.4579
2024-11-22 09:56:00: [2024-11-22 09:56:00] iter = 0700, loss = 31.3732
2024-11-22 09:57:30: [2024-11-22 09:57:30] iter = 0710, loss = 31.4878
2024-11-22 09:59:00: [2024-11-22 09:59:00] iter = 0720, loss = 34.3999
2024-11-22 10:00:26: [2024-11-22 10:00:26] iter = 0730, loss = 40.6561
2024-11-22 10:01:54: [2024-11-22 10:01:54] iter = 0740, loss = 31.9542
2024-11-22 10:03:25: [2024-11-22 10:03:25] iter = 0750, loss = 30.9381
2024-11-22 10:05:00: [2024-11-22 10:05:00] iter = 0760, loss = 42.2311
2024-11-22 10:06:24: [2024-11-22 10:06:24] iter = 0770, loss = 30.1733
2024-11-22 10:07:48: [2024-11-22 10:07:48] iter = 0780, loss = 29.2966
2024-11-22 10:09:16: [2024-11-22 10:09:16] iter = 0790, loss = 28.3267
2024-11-22 10:10:45: [2024-11-22 10:10:45] iter = 0800, loss = 31.5427
2024-11-22 10:12:10: [2024-11-22 10:12:10] iter = 0810, loss = 33.1208
2024-11-22 10:13:38: [2024-11-22 10:13:38] iter = 0820, loss = 32.5717
2024-11-22 10:15:10: [2024-11-22 10:15:10] iter = 0830, loss = 32.8382
2024-11-22 10:16:42: [2024-11-22 10:16:42] iter = 0840, loss = 30.3590
2024-11-22 10:18:07: [2024-11-22 10:18:07] iter = 0850, loss = 34.3361
2024-11-22 10:19:39: [2024-11-22 10:19:39] iter = 0860, loss = 28.5736
2024-11-22 10:21:01: [2024-11-22 10:21:01] iter = 0870, loss = 31.2172
2024-11-22 10:22:28: [2024-11-22 10:22:28] iter = 0880, loss = 31.0834
2024-11-22 10:23:50: [2024-11-22 10:23:50] iter = 0890, loss = 22.3299
2024-11-22 10:25:15: [2024-11-22 10:25:15] iter = 0900, loss = 24.3465
2024-11-22 10:26:44: [2024-11-22 10:26:44] iter = 0910, loss = 26.5171
2024-11-22 10:28:05: [2024-11-22 10:28:05] iter = 0920, loss = 31.0450
2024-11-22 10:29:28: [2024-11-22 10:29:28] iter = 0930, loss = 26.1309
2024-11-22 10:30:55: [2024-11-22 10:30:55] iter = 0940, loss = 28.6667
2024-11-22 10:32:21: [2024-11-22 10:32:21] iter = 0950, loss = 32.2594
2024-11-22 10:33:44: [2024-11-22 10:33:44] iter = 0960, loss = 26.7504
2024-11-22 10:35:04: [2024-11-22 10:35:04] iter = 0970, loss = 27.2988
2024-11-22 10:36:26: [2024-11-22 10:36:26] iter = 0980, loss = 32.8088
2024-11-22 10:37:48: [2024-11-22 10:37:48] iter = 0990, loss = 26.7780
2024-11-22 10:39:03: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 10:39:03: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 10:39:03: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 43212}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 10:40:12: Evaluate 5 random ConvNet, ACCmean = 0.6207 ACCstd = 0.0044
-------------------------
2024-11-22 10:40:12: Evaluate 5 random ConvNet, F1mean = 0.5881 F!std = 0.0052
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 10:40:21: [2024-11-22 10:40:21] iter = 1000, loss = 30.3763
2024-11-22 10:40:21: 
================== Exp 4 ==================
 
2024-11-22 10:40:21: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'OrganSMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7ff1a58a6ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_OrganSMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 10:40:21: Evaluation model pool: ['ConvNet']
2024-11-22 10:40:21: class c = 0: 1148 real images
2024-11-22 10:40:21: class c = 1: 630 real images
2024-11-22 10:40:21: class c = 2: 614 real images
2024-11-22 10:40:21: class c = 3: 721 real images
2024-11-22 10:40:21: class c = 4: 1132 real images
2024-11-22 10:40:21: class c = 5: 1119 real images
2024-11-22 10:40:21: class c = 6: 3464 real images
2024-11-22 10:40:21: class c = 7: 741 real images
2024-11-22 10:40:21: class c = 8: 803 real images
2024-11-22 10:40:21: class c = 9: 2004 real images
2024-11-22 10:40:21: class c = 10: 1556 real images
2024-11-22 10:40:21: real images channel 0, mean = 0.4953, std = 0.2826
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 10:40:21: initialize synthetic data from random real images
2024-11-22 10:40:21: [2024-11-22 10:40:21] training begins
2024-11-22 10:40:21: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 10:40:21: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 10:40:21: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 20851}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 10:41:18: Evaluate 5 random ConvNet, ACCmean = 0.4876 ACCstd = 0.0103
-------------------------
2024-11-22 10:41:18: Evaluate 5 random ConvNet, F1mean = 0.4658 F!std = 0.0069
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 10:41:26: [2024-11-22 10:41:26] iter = 0000, loss = 64.0572
2024-11-22 10:42:54: [2024-11-22 10:42:54] iter = 0010, loss = 43.4571
2024-11-22 10:44:15: [2024-11-22 10:44:15] iter = 0020, loss = 37.0397
2024-11-22 10:45:39: [2024-11-22 10:45:39] iter = 0030, loss = 35.9216
2024-11-22 10:46:59: [2024-11-22 10:46:59] iter = 0040, loss = 36.8034
2024-11-22 10:48:24: [2024-11-22 10:48:24] iter = 0050, loss = 32.5163
2024-11-22 10:49:50: [2024-11-22 10:49:50] iter = 0060, loss = 30.9022
2024-11-22 10:51:21: [2024-11-22 10:51:21] iter = 0070, loss = 36.3489
2024-11-22 10:52:47: [2024-11-22 10:52:47] iter = 0080, loss = 38.1778
2024-11-22 10:54:10: [2024-11-22 10:54:10] iter = 0090, loss = 35.2472
2024-11-22 10:55:39: [2024-11-22 10:55:39] iter = 0100, loss = 34.8180
2024-11-22 10:57:11: [2024-11-22 10:57:11] iter = 0110, loss = 39.2008
2024-11-22 10:58:38: [2024-11-22 10:58:38] iter = 0120, loss = 31.6400
2024-11-22 11:00:02: [2024-11-22 11:00:02] iter = 0130, loss = 34.9847
2024-11-22 11:01:31: [2024-11-22 11:01:31] iter = 0140, loss = 38.6634
2024-11-22 11:03:02: [2024-11-22 11:03:02] iter = 0150, loss = 30.1778
2024-11-22 11:04:30: [2024-11-22 11:04:30] iter = 0160, loss = 31.5829
2024-11-22 11:05:59: [2024-11-22 11:05:59] iter = 0170, loss = 30.0725
2024-11-22 11:07:29: [2024-11-22 11:07:29] iter = 0180, loss = 30.5015
2024-11-22 11:08:59: [2024-11-22 11:08:59] iter = 0190, loss = 29.2063
2024-11-22 11:10:27: [2024-11-22 11:10:27] iter = 0200, loss = 28.4599
2024-11-22 11:11:59: [2024-11-22 11:11:59] iter = 0210, loss = 25.7199
2024-11-22 11:13:30: [2024-11-22 11:13:30] iter = 0220, loss = 39.6057
2024-11-22 11:14:58: [2024-11-22 11:14:58] iter = 0230, loss = 32.5084
2024-11-22 11:16:28: [2024-11-22 11:16:28] iter = 0240, loss = 37.4673
2024-11-22 11:17:57: [2024-11-22 11:17:57] iter = 0250, loss = 31.1338
2024-11-22 11:19:23: [2024-11-22 11:19:23] iter = 0260, loss = 31.3728
2024-11-22 11:20:51: [2024-11-22 11:20:51] iter = 0270, loss = 25.9641
2024-11-22 11:22:13: [2024-11-22 11:22:13] iter = 0280, loss = 33.7465
2024-11-22 11:23:36: [2024-11-22 11:23:36] iter = 0290, loss = 33.9512
2024-11-22 11:24:59: [2024-11-22 11:24:59] iter = 0300, loss = 34.5507
2024-11-22 11:26:23: [2024-11-22 11:26:23] iter = 0310, loss = 29.8798
2024-11-22 11:27:56: [2024-11-22 11:27:56] iter = 0320, loss = 30.9816
2024-11-22 11:29:17: [2024-11-22 11:29:17] iter = 0330, loss = 25.1788
2024-11-22 11:30:39: [2024-11-22 11:30:38] iter = 0340, loss = 28.7741
2024-11-22 11:31:56: [2024-11-22 11:31:56] iter = 0350, loss = 37.8746
2024-11-22 11:33:21: [2024-11-22 11:33:21] iter = 0360, loss = 36.4569
2024-11-22 11:34:38: [2024-11-22 11:34:38] iter = 0370, loss = 31.3815
2024-11-22 11:36:05: [2024-11-22 11:36:05] iter = 0380, loss = 28.9779
2024-11-22 11:37:26: [2024-11-22 11:37:26] iter = 0390, loss = 25.5904
2024-11-22 11:38:56: [2024-11-22 11:38:56] iter = 0400, loss = 29.1889
2024-11-22 11:40:24: [2024-11-22 11:40:24] iter = 0410, loss = 30.4906
2024-11-22 11:41:53: [2024-11-22 11:41:53] iter = 0420, loss = 27.6842
2024-11-22 11:43:15: [2024-11-22 11:43:15] iter = 0430, loss = 33.6094
2024-11-22 11:44:42: [2024-11-22 11:44:42] iter = 0440, loss = 32.0923
2024-11-22 11:46:06: [2024-11-22 11:46:06] iter = 0450, loss = 28.7555
2024-11-22 11:47:27: [2024-11-22 11:47:27] iter = 0460, loss = 42.0774
2024-11-22 11:48:53: [2024-11-22 11:48:53] iter = 0470, loss = 33.7365
2024-11-22 11:50:23: [2024-11-22 11:50:23] iter = 0480, loss = 29.2371
2024-11-22 11:51:43: [2024-11-22 11:51:43] iter = 0490, loss = 30.1630
2024-11-22 11:52:57: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 11:52:57: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 11:52:57: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 77534}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 11:54:05: Evaluate 5 random ConvNet, ACCmean = 0.6279 ACCstd = 0.0051
-------------------------
2024-11-22 11:54:05: Evaluate 5 random ConvNet, F1mean = 0.5997 F!std = 0.0033
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 11:54:15: [2024-11-22 11:54:15] iter = 0500, loss = 29.4325
2024-11-22 11:55:43: [2024-11-22 11:55:43] iter = 0510, loss = 32.6659
2024-11-22 11:57:04: [2024-11-22 11:57:04] iter = 0520, loss = 33.3374
2024-11-22 11:58:27: [2024-11-22 11:58:27] iter = 0530, loss = 32.5051
2024-11-22 11:59:48: [2024-11-22 11:59:48] iter = 0540, loss = 33.9246
2024-11-22 12:01:16: [2024-11-22 12:01:16] iter = 0550, loss = 28.1022
2024-11-22 12:02:43: [2024-11-22 12:02:43] iter = 0560, loss = 25.9336
2024-11-22 12:04:10: [2024-11-22 12:04:10] iter = 0570, loss = 35.2332
2024-11-22 12:05:37: [2024-11-22 12:05:37] iter = 0580, loss = 28.2744
2024-11-22 12:07:01: [2024-11-22 12:07:01] iter = 0590, loss = 22.5029
2024-11-22 12:08:29: [2024-11-22 12:08:29] iter = 0600, loss = 30.2576
2024-11-22 12:09:51: [2024-11-22 12:09:51] iter = 0610, loss = 32.1514
2024-11-22 12:11:24: [2024-11-22 12:11:24] iter = 0620, loss = 26.2725
2024-11-22 12:12:35: [2024-11-22 12:12:35] iter = 0630, loss = 26.7444
2024-11-22 12:13:39: [2024-11-22 12:13:39] iter = 0640, loss = 28.1985
2024-11-22 12:14:41: [2024-11-22 12:14:41] iter = 0650, loss = 29.8029
2024-11-22 12:15:45: [2024-11-22 12:15:45] iter = 0660, loss = 29.7433
2024-11-22 12:16:50: [2024-11-22 12:16:50] iter = 0670, loss = 26.8312
2024-11-22 12:17:55: [2024-11-22 12:17:55] iter = 0680, loss = 34.2150
2024-11-22 12:19:00: [2024-11-22 12:19:00] iter = 0690, loss = 27.4959
2024-11-22 12:20:09: [2024-11-22 12:20:09] iter = 0700, loss = 31.9113
2024-11-22 12:21:14: [2024-11-22 12:21:14] iter = 0710, loss = 24.3073
2024-11-22 12:22:18: [2024-11-22 12:22:18] iter = 0720, loss = 28.0386
2024-11-22 12:23:30: [2024-11-22 12:23:30] iter = 0730, loss = 41.2648
2024-11-22 12:24:34: [2024-11-22 12:24:34] iter = 0740, loss = 30.2567
2024-11-22 12:25:45: [2024-11-22 12:25:45] iter = 0750, loss = 27.9143
2024-11-22 12:26:53: [2024-11-22 12:26:53] iter = 0760, loss = 34.2407
2024-11-22 12:28:02: [2024-11-22 12:28:02] iter = 0770, loss = 28.1738
2024-11-22 12:29:09: [2024-11-22 12:29:09] iter = 0780, loss = 35.8821
2024-11-22 12:30:15: [2024-11-22 12:30:15] iter = 0790, loss = 26.7872
2024-11-22 12:31:19: [2024-11-22 12:31:19] iter = 0800, loss = 33.3821
2024-11-22 12:32:27: [2024-11-22 12:32:27] iter = 0810, loss = 29.4333
2024-11-22 12:33:36: [2024-11-22 12:33:36] iter = 0820, loss = 27.5496
2024-11-22 12:34:48: [2024-11-22 12:34:48] iter = 0830, loss = 30.2445
2024-11-22 12:35:58: [2024-11-22 12:35:58] iter = 0840, loss = 35.9367
2024-11-22 12:37:05: [2024-11-22 12:37:05] iter = 0850, loss = 29.6499
2024-11-22 12:38:08: [2024-11-22 12:38:08] iter = 0860, loss = 28.5916
2024-11-22 12:39:14: [2024-11-22 12:39:14] iter = 0870, loss = 28.5490
2024-11-22 12:40:19: [2024-11-22 12:40:19] iter = 0880, loss = 32.3163
2024-11-22 12:41:25: [2024-11-22 12:41:25] iter = 0890, loss = 26.6374
2024-11-22 12:42:32: [2024-11-22 12:42:32] iter = 0900, loss = 31.0487
2024-11-22 12:43:36: [2024-11-22 12:43:36] iter = 0910, loss = 31.3652
2024-11-22 12:44:39: [2024-11-22 12:44:39] iter = 0920, loss = 26.1445
2024-11-22 12:45:44: [2024-11-22 12:45:44] iter = 0930, loss = 38.0097
2024-11-22 12:46:48: [2024-11-22 12:46:48] iter = 0940, loss = 27.8458
2024-11-22 12:47:45: [2024-11-22 12:47:45] iter = 0950, loss = 33.5266
2024-11-22 12:48:49: [2024-11-22 12:48:49] iter = 0960, loss = 32.9300
2024-11-22 12:49:49: [2024-11-22 12:49:49] iter = 0970, loss = 29.7446
2024-11-22 12:50:52: [2024-11-22 12:50:52] iter = 0980, loss = 24.2646
2024-11-22 12:51:51: [2024-11-22 12:51:51] iter = 0990, loss = 26.4497
2024-11-22 12:52:46: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 12:52:46: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 12:52:46: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 66604}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 12:53:31: Evaluate 5 random ConvNet, ACCmean = 0.6209 ACCstd = 0.0039
-------------------------
2024-11-22 12:53:31: Evaluate 5 random ConvNet, F1mean = 0.5930 F!std = 0.0032
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 12:53:37: [2024-11-22 12:53:37] iter = 1000, loss = 25.1503
2024-11-22 12:53:37: 
==================== Final Results ====================

2024-11-22 12:53:37: Run 5 experiments, train on ConvNet, evaluate 25 random ConvNet, mean  = 62.69%  std = 0.74%

[2024-11-22 08:14:53] Evaluate_00: epoch = 1000 train time = 14 s train loss = 0.008104 train acc = 1.0000, test acc = 0.4896, test_sen =0.4796, test_spe =0.9484, test_f1 =0.4629
[2024-11-22 08:15:11] Evaluate_01: epoch = 1000 train time = 17 s train loss = 0.057457 train acc = 1.0000, test acc = 0.4913, test_sen =0.4840, test_spe =0.9488, test_f1 =0.4674
[2024-11-22 08:15:26] Evaluate_02: epoch = 1000 train time = 14 s train loss = 0.038769 train acc = 1.0000, test acc = 0.4708, test_sen =0.4736, test_spe =0.9468, test_f1 =0.4538
[2024-11-22 08:15:42] Evaluate_03: epoch = 1000 train time = 14 s train loss = 0.033937 train acc = 1.0000, test acc = 0.4672, test_sen =0.4734, test_spe =0.9465, test_f1 =0.4512
[2024-11-22 08:15:58] Evaluate_04: epoch = 1000 train time = 15 s train loss = 0.053611 train acc = 0.9909, test acc = 0.4799, test_sen =0.4773, test_spe =0.9476, test_f1 =0.4611
[2024-11-22 09:26:28] Evaluate_00: epoch = 1000 train time = 11 s train loss = 0.049298 train acc = 1.0000, test acc = 0.6203, test_sen =0.6033, test_spe =0.9613, test_f1 =0.5908
[2024-11-22 09:26:41] Evaluate_01: epoch = 1000 train time = 12 s train loss = 0.007547 train acc = 1.0000, test acc = 0.6095, test_sen =0.5908, test_spe =0.9603, test_f1 =0.5779
[2024-11-22 09:26:54] Evaluate_02: epoch = 1000 train time = 12 s train loss = 0.005558 train acc = 1.0000, test acc = 0.6206, test_sen =0.6037, test_spe =0.9613, test_f1 =0.5953
[2024-11-22 09:27:08] Evaluate_03: epoch = 1000 train time = 13 s train loss = 0.009000 train acc = 1.0000, test acc = 0.6223, test_sen =0.6012, test_spe =0.9615, test_f1 =0.5919
[2024-11-22 09:27:20] Evaluate_04: epoch = 1000 train time = 11 s train loss = 0.133611 train acc = 0.9818, test acc = 0.6214, test_sen =0.5997, test_spe =0.9614, test_f1 =0.5878
[2024-11-22 10:39:18] Evaluate_00: epoch = 1000 train time = 14 s train loss = 0.040887 train acc = 1.0000, test acc = 0.6204, test_sen =0.6013, test_spe =0.9614, test_f1 =0.5896
[2024-11-22 10:39:33] Evaluate_01: epoch = 1000 train time = 14 s train loss = 0.025409 train acc = 1.0000, test acc = 0.6280, test_sen =0.6031, test_spe =0.9622, test_f1 =0.5921
[2024-11-22 10:39:46] Evaluate_02: epoch = 1000 train time = 13 s train loss = 0.043379 train acc = 1.0000, test acc = 0.6145, test_sen =0.5908, test_spe =0.9608, test_f1 =0.5825
[2024-11-22 10:39:59] Evaluate_03: epoch = 1000 train time = 12 s train loss = 0.070744 train acc = 1.0000, test acc = 0.6222, test_sen =0.6037, test_spe =0.9615, test_f1 =0.5948
[2024-11-22 10:40:12] Evaluate_04: epoch = 1000 train time = 12 s train loss = 0.010690 train acc = 1.0000, test acc = 0.6184, test_sen =0.5936, test_spe =0.9613, test_f1 =0.5816
[2024-11-22 10:40:34] Evaluate_00: epoch = 1000 train time = 12 s train loss = 0.008564 train acc = 1.0000, test acc = 0.4827, test_sen =0.4693, test_spe =0.9477, test_f1 =0.4674
[2024-11-22 10:40:45] Evaluate_01: epoch = 1000 train time = 11 s train loss = 0.015031 train acc = 1.0000, test acc = 0.4734, test_sen =0.4628, test_spe =0.9469, test_f1 =0.4536
[2024-11-22 10:40:56] Evaluate_02: epoch = 1000 train time = 10 s train loss = 0.003962 train acc = 1.0000, test acc = 0.4846, test_sen =0.4728, test_spe =0.9482, test_f1 =0.4638
[2024-11-22 10:41:08] Evaluate_03: epoch = 1000 train time = 11 s train loss = 0.007573 train acc = 1.0000, test acc = 0.5040, test_sen =0.4756, test_spe =0.9497, test_f1 =0.4738
[2024-11-22 10:41:18] Evaluate_04: epoch = 1000 train time = 10 s train loss = 0.016557 train acc = 1.0000, test acc = 0.4931, test_sen =0.4784, test_spe =0.9488, test_f1 =0.4703
[2024-11-22 11:53:11] Evaluate_00: epoch = 1000 train time = 13 s train loss = 0.007459 train acc = 1.0000, test acc = 0.6188, test_sen =0.6009, test_spe =0.9613, test_f1 =0.5938
[2024-11-22 11:53:26] Evaluate_01: epoch = 1000 train time = 13 s train loss = 0.009146 train acc = 1.0000, test acc = 0.6268, test_sen =0.6018, test_spe =0.9619, test_f1 =0.5991
[2024-11-22 11:53:41] Evaluate_02: epoch = 1000 train time = 15 s train loss = 0.051186 train acc = 1.0000, test acc = 0.6323, test_sen =0.6111, test_spe =0.9627, test_f1 =0.6035
[2024-11-22 11:53:54] Evaluate_03: epoch = 1000 train time = 12 s train loss = 0.060244 train acc = 1.0000, test acc = 0.6291, test_sen =0.6075, test_spe =0.9623, test_f1 =0.6009
[2024-11-22 11:54:05] Evaluate_04: epoch = 1000 train time = 10 s train loss = 0.004894 train acc = 1.0000, test acc = 0.6327, test_sen =0.6075, test_spe =0.9627, test_f1 =0.6010
[2024-11-22 12:52:54] Evaluate_00: epoch = 1000 train time = 7 s train loss = 0.011687 train acc = 1.0000, test acc = 0.6244, test_sen =0.5990, test_spe =0.9616, test_f1 =0.5931
[2024-11-22 12:53:04] Evaluate_01: epoch = 1000 train time = 9 s train loss = 0.005605 train acc = 1.0000, test acc = 0.6197, test_sen =0.6021, test_spe =0.9613, test_f1 =0.5944
[2024-11-22 12:53:12] Evaluate_02: epoch = 1000 train time = 8 s train loss = 0.009126 train acc = 1.0000, test acc = 0.6150, test_sen =0.5919, test_spe =0.9608, test_f1 =0.5868
[2024-11-22 12:53:21] Evaluate_03: epoch = 1000 train time = 8 s train loss = 0.069899 train acc = 0.9909, test acc = 0.6193, test_sen =0.5992, test_spe =0.9612, test_f1 =0.5951
[2024-11-22 12:53:31] Evaluate_04: epoch = 1000 train time = 9 s train loss = 0.040747 train acc = 1.0000, test acc = 0.6258, test_sen =0.6030, test_spe =0.9619, test_f1 =0.5957
