nohup: ignoring input
2024-11-21 20:39:23: eval_it_pool: [0, 500, 1000]
2024-11-21 20:39:27: 
================== Exp 0 ==================
 
2024-11-21 20:39:27: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'TissueMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f1850325ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_TissueMNIST (INFO)>}
2024-11-21 20:39:27: Evaluation model pool: ['ConvNet']
2024-11-21 20:39:34: class c = 0: 53075 real images
2024-11-21 20:39:34: class c = 1: 7814 real images
2024-11-21 20:39:34: class c = 2: 5866 real images
2024-11-21 20:39:34: class c = 3: 15406 real images
2024-11-21 20:39:34: class c = 4: 11789 real images
2024-11-21 20:39:35: class c = 5: 7705 real images
2024-11-21 20:39:35: class c = 6: 39203 real images
2024-11-21 20:39:35: class c = 7: 24608 real images
2024-11-21 20:39:35: real images channel 0, mean = 0.1020, std = 0.1000
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
main_base.py:125: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1666642975312/work/torch/csrc/utils/tensor_new.cpp:230.)
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-21 20:39:35: initialize synthetic data from random real images
2024-11-21 20:39:35: [2024-11-21 20:39:35] training begins
2024-11-21 20:39:35: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-21 20:39:35: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-21 20:39:35: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1666642975312/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 20:40:40: Evaluate 5 random ConvNet, ACCmean = 0.2946 ACCstd = 0.0039
-------------------------
2024-11-21 20:40:40: Evaluate 5 random ConvNet, F1mean = 0.2426 F!std = 0.0017
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 20:40:50: [2024-11-21 20:40:50] iter = 0000, loss = 122.4945
2024-11-21 20:42:24: [2024-11-21 20:42:24] iter = 0010, loss = 71.6741
2024-11-21 20:44:04: [2024-11-21 20:44:04] iter = 0020, loss = 70.0177
2024-11-21 20:45:48: [2024-11-21 20:45:48] iter = 0030, loss = 74.4706
2024-11-21 20:48:06: [2024-11-21 20:48:06] iter = 0040, loss = 44.1130
2024-11-21 20:50:31: [2024-11-21 20:50:31] iter = 0050, loss = 54.9649
2024-11-21 20:52:58: [2024-11-21 20:52:58] iter = 0060, loss = 61.1297
2024-11-21 20:55:22: [2024-11-21 20:55:22] iter = 0070, loss = 56.1534
2024-11-21 20:57:58: [2024-11-21 20:57:58] iter = 0080, loss = 64.0895
2024-11-21 21:00:27: [2024-11-21 21:00:27] iter = 0090, loss = 59.3412
2024-11-21 21:02:54: [2024-11-21 21:02:54] iter = 0100, loss = 62.1221
2024-11-21 21:05:26: [2024-11-21 21:05:26] iter = 0110, loss = 61.1181
2024-11-21 21:07:55: [2024-11-21 21:07:55] iter = 0120, loss = 64.5343
2024-11-21 21:10:25: [2024-11-21 21:10:25] iter = 0130, loss = 52.3709
2024-11-21 21:12:57: [2024-11-21 21:12:57] iter = 0140, loss = 52.2468
2024-11-21 21:15:26: [2024-11-21 21:15:26] iter = 0150, loss = 37.5534
2024-11-21 21:18:04: [2024-11-21 21:18:04] iter = 0160, loss = 43.5448
2024-11-21 21:20:31: [2024-11-21 21:20:31] iter = 0170, loss = 68.6252
2024-11-21 21:23:07: [2024-11-21 21:23:07] iter = 0180, loss = 47.4222
2024-11-21 21:25:35: [2024-11-21 21:25:35] iter = 0190, loss = 63.0350
2024-11-21 21:27:58: [2024-11-21 21:27:58] iter = 0200, loss = 64.3504
2024-11-21 21:30:21: [2024-11-21 21:30:21] iter = 0210, loss = 47.7327
2024-11-21 21:32:48: [2024-11-21 21:32:48] iter = 0220, loss = 75.5569
2024-11-21 21:35:17: [2024-11-21 21:35:17] iter = 0230, loss = 67.8260
2024-11-21 21:37:46: [2024-11-21 21:37:46] iter = 0240, loss = 42.9195
2024-11-21 21:40:10: [2024-11-21 21:40:10] iter = 0250, loss = 76.5402
2024-11-21 21:42:37: [2024-11-21 21:42:37] iter = 0260, loss = 73.2931
2024-11-21 21:45:06: [2024-11-21 21:45:06] iter = 0270, loss = 54.4435
2024-11-21 21:47:33: [2024-11-21 21:47:33] iter = 0280, loss = 51.0243
2024-11-21 21:50:00: [2024-11-21 21:50:00] iter = 0290, loss = 54.0555
2024-11-21 21:52:28: [2024-11-21 21:52:28] iter = 0300, loss = 62.6718
2024-11-21 21:54:51: [2024-11-21 21:54:51] iter = 0310, loss = 68.6869
2024-11-21 21:57:13: [2024-11-21 21:57:13] iter = 0320, loss = 54.8379
2024-11-21 21:59:39: [2024-11-21 21:59:39] iter = 0330, loss = 52.2492
2024-11-21 22:02:05: [2024-11-21 22:02:05] iter = 0340, loss = 55.6424
2024-11-21 22:04:30: [2024-11-21 22:04:30] iter = 0350, loss = 55.6253
2024-11-21 22:06:53: [2024-11-21 22:06:53] iter = 0360, loss = 48.7137
2024-11-21 22:09:23: [2024-11-21 22:09:23] iter = 0370, loss = 52.7870
2024-11-21 22:11:44: [2024-11-21 22:11:44] iter = 0380, loss = 46.3886
2024-11-21 22:14:15: [2024-11-21 22:14:15] iter = 0390, loss = 38.7661
2024-11-21 22:16:44: [2024-11-21 22:16:44] iter = 0400, loss = 72.2976
2024-11-21 22:19:13: [2024-11-21 22:19:13] iter = 0410, loss = 57.3142
2024-11-21 22:21:34: [2024-11-21 22:21:34] iter = 0420, loss = 48.4879
2024-11-21 22:23:53: [2024-11-21 22:23:53] iter = 0430, loss = 51.6094
2024-11-21 22:26:14: [2024-11-21 22:26:14] iter = 0440, loss = 56.9851
2024-11-21 22:28:42: [2024-11-21 22:28:42] iter = 0450, loss = 47.0205
2024-11-21 22:31:10: [2024-11-21 22:31:10] iter = 0460, loss = 61.9493
2024-11-21 22:33:37: [2024-11-21 22:33:37] iter = 0470, loss = 42.9731
2024-11-21 22:36:00: [2024-11-21 22:36:00] iter = 0480, loss = 54.9473
2024-11-21 22:38:21: [2024-11-21 22:38:21] iter = 0490, loss = 55.0580
2024-11-21 22:40:31: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-21 22:40:31: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-21 22:40:31: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 31082}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 22:42:31: Evaluate 5 random ConvNet, ACCmean = 0.3427 ACCstd = 0.0122
-------------------------
2024-11-21 22:42:31: Evaluate 5 random ConvNet, F1mean = 0.2867 F!std = 0.0070
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-21 22:42:46: [2024-11-21 22:42:46] iter = 0500, loss = 56.2354
2024-11-21 22:45:09: [2024-11-21 22:45:09] iter = 0510, loss = 63.7097
2024-11-21 22:47:33: [2024-11-21 22:47:33] iter = 0520, loss = 59.8300
2024-11-21 22:49:54: [2024-11-21 22:49:54] iter = 0530, loss = 53.4928
2024-11-21 22:52:25: [2024-11-21 22:52:25] iter = 0540, loss = 39.9091
2024-11-21 22:54:46: [2024-11-21 22:54:46] iter = 0550, loss = 57.6938
2024-11-21 22:57:09: [2024-11-21 22:57:09] iter = 0560, loss = 64.6503
2024-11-21 22:59:36: [2024-11-21 22:59:36] iter = 0570, loss = 44.1326
2024-11-21 23:02:06: [2024-11-21 23:02:06] iter = 0580, loss = 64.8258
2024-11-21 23:04:34: [2024-11-21 23:04:34] iter = 0590, loss = 49.2052
2024-11-21 23:07:01: [2024-11-21 23:07:01] iter = 0600, loss = 56.7154
2024-11-21 23:09:22: [2024-11-21 23:09:22] iter = 0610, loss = 61.9847
2024-11-21 23:11:37: [2024-11-21 23:11:37] iter = 0620, loss = 59.7990
2024-11-21 23:14:04: [2024-11-21 23:14:04] iter = 0630, loss = 45.0423
2024-11-21 23:16:27: [2024-11-21 23:16:27] iter = 0640, loss = 51.3506
2024-11-21 23:18:52: [2024-11-21 23:18:52] iter = 0650, loss = 79.7759
2024-11-21 23:21:19: [2024-11-21 23:21:19] iter = 0660, loss = 52.6565
2024-11-21 23:23:40: [2024-11-21 23:23:40] iter = 0670, loss = 48.5155
2024-11-21 23:26:07: [2024-11-21 23:26:07] iter = 0680, loss = 58.5199
2024-11-21 23:28:34: [2024-11-21 23:28:34] iter = 0690, loss = 56.0615
2024-11-21 23:30:57: [2024-11-21 23:30:57] iter = 0700, loss = 63.8336
2024-11-21 23:33:24: [2024-11-21 23:33:24] iter = 0710, loss = 60.3029
2024-11-21 23:35:48: [2024-11-21 23:35:48] iter = 0720, loss = 46.7566
2024-11-21 23:38:14: [2024-11-21 23:38:14] iter = 0730, loss = 47.1267
2024-11-21 23:40:40: [2024-11-21 23:40:40] iter = 0740, loss = 42.8407
2024-11-21 23:43:00: [2024-11-21 23:43:00] iter = 0750, loss = 69.8954
2024-11-21 23:45:06: [2024-11-21 23:45:06] iter = 0760, loss = 49.7945
2024-11-21 23:47:18: [2024-11-21 23:47:18] iter = 0770, loss = 58.9086
2024-11-21 23:49:33: [2024-11-21 23:49:33] iter = 0780, loss = 54.5116
2024-11-21 23:51:45: [2024-11-21 23:51:45] iter = 0790, loss = 65.3678
2024-11-21 23:53:59: [2024-11-21 23:53:59] iter = 0800, loss = 70.7319
2024-11-21 23:56:11: [2024-11-21 23:56:11] iter = 0810, loss = 59.9006
2024-11-21 23:58:27: [2024-11-21 23:58:27] iter = 0820, loss = 84.4233
2024-11-22 00:00:40: [2024-11-22 00:00:40] iter = 0830, loss = 51.8131
2024-11-22 00:02:51: [2024-11-22 00:02:51] iter = 0840, loss = 58.4580
2024-11-22 00:05:03: [2024-11-22 00:05:03] iter = 0850, loss = 61.0801
2024-11-22 00:07:17: [2024-11-22 00:07:17] iter = 0860, loss = 50.3821
2024-11-22 00:09:32: [2024-11-22 00:09:32] iter = 0870, loss = 59.8305
2024-11-22 00:11:48: [2024-11-22 00:11:48] iter = 0880, loss = 58.9434
2024-11-22 00:14:10: [2024-11-22 00:14:10] iter = 0890, loss = 47.9581
2024-11-22 00:16:32: [2024-11-22 00:16:32] iter = 0900, loss = 35.3155
2024-11-22 00:18:56: [2024-11-22 00:18:56] iter = 0910, loss = 43.6869
2024-11-22 00:21:21: [2024-11-22 00:21:21] iter = 0920, loss = 55.1945
2024-11-22 00:23:43: [2024-11-22 00:23:43] iter = 0930, loss = 68.8720
2024-11-22 00:26:08: [2024-11-22 00:26:08] iter = 0940, loss = 56.6648
2024-11-22 00:28:36: [2024-11-22 00:28:36] iter = 0950, loss = 53.4832
2024-11-22 00:30:56: [2024-11-22 00:30:56] iter = 0960, loss = 56.7162
2024-11-22 00:33:22: [2024-11-22 00:33:22] iter = 0970, loss = 55.6590
2024-11-22 00:35:45: [2024-11-22 00:35:45] iter = 0980, loss = 49.1349
2024-11-22 00:38:06: [2024-11-22 00:38:06] iter = 0990, loss = 48.7434
2024-11-22 00:40:14: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 00:40:14: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 00:40:14: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 14455}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 00:42:15: Evaluate 5 random ConvNet, ACCmean = 0.3670 ACCstd = 0.0119
-------------------------
2024-11-22 00:42:15: Evaluate 5 random ConvNet, F1mean = 0.3019 F!std = 0.0047
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 00:42:29: [2024-11-22 00:42:28] iter = 1000, loss = 30.9173
2024-11-22 00:42:29: 
================== Exp 1 ==================
 
2024-11-22 00:42:29: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'TissueMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f1850325ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_TissueMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 00:42:29: Evaluation model pool: ['ConvNet']
2024-11-22 00:42:45: class c = 0: 53075 real images
2024-11-22 00:42:45: class c = 1: 7814 real images
2024-11-22 00:42:45: class c = 2: 5866 real images
2024-11-22 00:42:45: class c = 3: 15406 real images
2024-11-22 00:42:45: class c = 4: 11789 real images
2024-11-22 00:42:45: class c = 5: 7705 real images
2024-11-22 00:42:45: class c = 6: 39203 real images
2024-11-22 00:42:45: class c = 7: 24608 real images
2024-11-22 00:42:45: real images channel 0, mean = 0.1020, std = 0.1000
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 00:42:45: initialize synthetic data from random real images
2024-11-22 00:42:45: [2024-11-22 00:42:45] training begins
2024-11-22 00:42:45: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 00:42:45: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 00:42:45: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 48836}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 00:44:50: Evaluate 5 random ConvNet, ACCmean = 0.2911 ACCstd = 0.0052
-------------------------
2024-11-22 00:44:50: Evaluate 5 random ConvNet, F1mean = 0.2377 F!std = 0.0025
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 00:45:06: [2024-11-22 00:45:06] iter = 0000, loss = 102.0754
2024-11-22 00:47:37: [2024-11-22 00:47:37] iter = 0010, loss = 64.3193
2024-11-22 00:50:07: [2024-11-22 00:50:07] iter = 0020, loss = 66.8900
2024-11-22 00:52:37: [2024-11-22 00:52:37] iter = 0030, loss = 67.4324
2024-11-22 00:55:02: [2024-11-22 00:55:02] iter = 0040, loss = 62.8659
2024-11-22 00:57:29: [2024-11-22 00:57:29] iter = 0050, loss = 93.8580
2024-11-22 00:59:48: [2024-11-22 00:59:48] iter = 0060, loss = 54.5594
2024-11-22 01:02:15: [2024-11-22 01:02:15] iter = 0070, loss = 64.4415
2024-11-22 01:04:43: [2024-11-22 01:04:43] iter = 0080, loss = 57.2256
2024-11-22 01:07:12: [2024-11-22 01:07:12] iter = 0090, loss = 50.4170
2024-11-22 01:09:34: [2024-11-22 01:09:34] iter = 0100, loss = 59.9036
2024-11-22 01:11:56: [2024-11-22 01:11:56] iter = 0110, loss = 49.6304
2024-11-22 01:14:02: [2024-11-22 01:14:02] iter = 0120, loss = 65.5205
2024-11-22 01:16:14: [2024-11-22 01:16:14] iter = 0130, loss = 51.9029
2024-11-22 01:18:29: [2024-11-22 01:18:29] iter = 0140, loss = 59.1359
2024-11-22 01:20:48: [2024-11-22 01:20:48] iter = 0150, loss = 46.3573
2024-11-22 01:23:09: [2024-11-22 01:23:09] iter = 0160, loss = 69.6542
2024-11-22 01:25:29: [2024-11-22 01:25:29] iter = 0170, loss = 60.0592
2024-11-22 01:27:49: [2024-11-22 01:27:49] iter = 0180, loss = 57.7999
2024-11-22 01:30:08: [2024-11-22 01:30:08] iter = 0190, loss = 62.3116
2024-11-22 01:32:28: [2024-11-22 01:32:28] iter = 0200, loss = 74.7747
2024-11-22 01:34:47: [2024-11-22 01:34:47] iter = 0210, loss = 58.6939
2024-11-22 01:37:16: [2024-11-22 01:37:16] iter = 0220, loss = 56.1988
2024-11-22 01:39:44: [2024-11-22 01:39:44] iter = 0230, loss = 61.3331
2024-11-22 01:42:07: [2024-11-22 01:42:07] iter = 0240, loss = 48.2700
2024-11-22 01:44:29: [2024-11-22 01:44:29] iter = 0250, loss = 56.4789
2024-11-22 01:46:50: [2024-11-22 01:46:50] iter = 0260, loss = 57.6711
2024-11-22 01:49:16: [2024-11-22 01:49:16] iter = 0270, loss = 44.6200
2024-11-22 01:51:40: [2024-11-22 01:51:40] iter = 0280, loss = 65.6599
2024-11-22 01:54:04: [2024-11-22 01:54:04] iter = 0290, loss = 50.5919
2024-11-22 01:56:26: [2024-11-22 01:56:26] iter = 0300, loss = 38.0971
2024-11-22 01:58:49: [2024-11-22 01:58:49] iter = 0310, loss = 57.2430
2024-11-22 02:01:09: [2024-11-22 02:01:09] iter = 0320, loss = 70.2946
2024-11-22 02:03:30: [2024-11-22 02:03:30] iter = 0330, loss = 61.1775
2024-11-22 02:05:54: [2024-11-22 02:05:54] iter = 0340, loss = 62.6554
2024-11-22 02:08:11: [2024-11-22 02:08:11] iter = 0350, loss = 46.7592
2024-11-22 02:10:22: [2024-11-22 02:10:22] iter = 0360, loss = 61.7171
2024-11-22 02:12:43: [2024-11-22 02:12:43] iter = 0370, loss = 63.8021
2024-11-22 02:15:12: [2024-11-22 02:15:12] iter = 0380, loss = 52.2831
2024-11-22 02:17:43: [2024-11-22 02:17:43] iter = 0390, loss = 46.8296
2024-11-22 02:20:05: [2024-11-22 02:20:05] iter = 0400, loss = 59.3584
2024-11-22 02:22:24: [2024-11-22 02:22:24] iter = 0410, loss = 63.0729
2024-11-22 02:24:49: [2024-11-22 02:24:49] iter = 0420, loss = 51.3762
2024-11-22 02:26:52: [2024-11-22 02:26:52] iter = 0430, loss = 64.1774
2024-11-22 02:29:09: [2024-11-22 02:29:09] iter = 0440, loss = 66.4241
2024-11-22 02:31:33: [2024-11-22 02:31:33] iter = 0450, loss = 72.5152
2024-11-22 02:33:50: [2024-11-22 02:33:50] iter = 0460, loss = 69.3932
2024-11-22 02:36:11: [2024-11-22 02:36:11] iter = 0470, loss = 46.2184
2024-11-22 02:38:28: [2024-11-22 02:38:28] iter = 0480, loss = 61.9593
2024-11-22 02:40:47: [2024-11-22 02:40:47] iter = 0490, loss = 66.4212
2024-11-22 02:42:47: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 02:42:47: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 02:42:47: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 67686}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 02:44:38: Evaluate 5 random ConvNet, ACCmean = 0.3322 ACCstd = 0.0127
-------------------------
2024-11-22 02:44:38: Evaluate 5 random ConvNet, F1mean = 0.2826 F!std = 0.0059
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 02:44:53: [2024-11-22 02:44:53] iter = 0500, loss = 54.6425
2024-11-22 02:47:16: [2024-11-22 02:47:16] iter = 0510, loss = 60.1464
2024-11-22 02:49:36: [2024-11-22 02:49:36] iter = 0520, loss = 42.1449
2024-11-22 02:51:58: [2024-11-22 02:51:58] iter = 0530, loss = 34.6132
2024-11-22 02:54:19: [2024-11-22 02:54:19] iter = 0540, loss = 62.4549
2024-11-22 02:56:37: [2024-11-22 02:56:37] iter = 0550, loss = 52.8441
2024-11-22 02:58:42: [2024-11-22 02:58:42] iter = 0560, loss = 48.6089
2024-11-22 03:00:56: [2024-11-22 03:00:56] iter = 0570, loss = 61.5288
2024-11-22 03:03:13: [2024-11-22 03:03:13] iter = 0580, loss = 65.9512
2024-11-22 03:05:28: [2024-11-22 03:05:28] iter = 0590, loss = 42.4967
2024-11-22 03:07:47: [2024-11-22 03:07:47] iter = 0600, loss = 48.4629
2024-11-22 03:10:06: [2024-11-22 03:10:06] iter = 0610, loss = 46.3444
2024-11-22 03:12:29: [2024-11-22 03:12:29] iter = 0620, loss = 71.1814
2024-11-22 03:14:51: [2024-11-22 03:14:51] iter = 0630, loss = 54.0631
2024-11-22 03:17:08: [2024-11-22 03:17:08] iter = 0640, loss = 84.7013
2024-11-22 03:19:31: [2024-11-22 03:19:31] iter = 0650, loss = 51.7793
2024-11-22 03:22:03: [2024-11-22 03:22:03] iter = 0660, loss = 64.7497
2024-11-22 03:24:24: [2024-11-22 03:24:24] iter = 0670, loss = 58.2098
2024-11-22 03:26:41: [2024-11-22 03:26:41] iter = 0680, loss = 39.6627
2024-11-22 03:29:00: [2024-11-22 03:29:00] iter = 0690, loss = 54.2966
2024-11-22 03:31:23: [2024-11-22 03:31:23] iter = 0700, loss = 46.4915
2024-11-22 03:33:41: [2024-11-22 03:33:41] iter = 0710, loss = 47.5408
2024-11-22 03:36:01: [2024-11-22 03:36:01] iter = 0720, loss = 50.4862
2024-11-22 03:38:23: [2024-11-22 03:38:23] iter = 0730, loss = 70.5106
2024-11-22 03:40:45: [2024-11-22 03:40:45] iter = 0740, loss = 45.8491
2024-11-22 03:43:07: [2024-11-22 03:43:07] iter = 0750, loss = 53.9211
2024-11-22 03:45:30: [2024-11-22 03:45:30] iter = 0760, loss = 45.6717
2024-11-22 03:47:56: [2024-11-22 03:47:56] iter = 0770, loss = 45.7738
2024-11-22 03:50:16: [2024-11-22 03:50:16] iter = 0780, loss = 57.8217
2024-11-22 03:52:30: [2024-11-22 03:52:30] iter = 0790, loss = 46.5621
2024-11-22 03:54:51: [2024-11-22 03:54:51] iter = 0800, loss = 61.6406
2024-11-22 03:57:10: [2024-11-22 03:57:10] iter = 0810, loss = 53.3247
2024-11-22 03:59:37: [2024-11-22 03:59:37] iter = 0820, loss = 55.8451
2024-11-22 04:01:58: [2024-11-22 04:01:58] iter = 0830, loss = 70.3483
2024-11-22 04:04:22: [2024-11-22 04:04:22] iter = 0840, loss = 64.2922
2024-11-22 04:06:46: [2024-11-22 04:06:46] iter = 0850, loss = 52.2976
2024-11-22 04:09:11: [2024-11-22 04:09:11] iter = 0860, loss = 64.1964
2024-11-22 04:11:30: [2024-11-22 04:11:30] iter = 0870, loss = 40.8206
2024-11-22 04:13:42: [2024-11-22 04:13:42] iter = 0880, loss = 63.2224
2024-11-22 04:16:06: [2024-11-22 04:16:06] iter = 0890, loss = 78.8650
2024-11-22 04:18:32: [2024-11-22 04:18:32] iter = 0900, loss = 58.1769
2024-11-22 04:20:50: [2024-11-22 04:20:50] iter = 0910, loss = 46.7613
2024-11-22 04:23:11: [2024-11-22 04:23:11] iter = 0920, loss = 77.8006
2024-11-22 04:25:30: [2024-11-22 04:25:30] iter = 0930, loss = 52.8325
2024-11-22 04:27:50: [2024-11-22 04:27:50] iter = 0940, loss = 50.7537
2024-11-22 04:30:06: [2024-11-22 04:30:06] iter = 0950, loss = 54.3600
2024-11-22 04:32:26: [2024-11-22 04:32:26] iter = 0960, loss = 59.5352
2024-11-22 04:34:48: [2024-11-22 04:34:48] iter = 0970, loss = 50.7116
2024-11-22 04:37:07: [2024-11-22 04:37:07] iter = 0980, loss = 46.5237
2024-11-22 04:39:30: [2024-11-22 04:39:30] iter = 0990, loss = 62.7094
2024-11-22 04:41:37: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 04:41:37: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 04:41:37: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 97550}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 04:43:28: Evaluate 5 random ConvNet, ACCmean = 0.3928 ACCstd = 0.0079
-------------------------
2024-11-22 04:43:28: Evaluate 5 random ConvNet, F1mean = 0.3084 F!std = 0.0023
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 04:43:42: [2024-11-22 04:43:42] iter = 1000, loss = 51.8017
2024-11-22 04:43:42: 
================== Exp 2 ==================
 
2024-11-22 04:43:42: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'TissueMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f1850325ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_TissueMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 04:43:42: Evaluation model pool: ['ConvNet']
2024-11-22 04:44:02: class c = 0: 53075 real images
2024-11-22 04:44:02: class c = 1: 7814 real images
2024-11-22 04:44:02: class c = 2: 5866 real images
2024-11-22 04:44:02: class c = 3: 15406 real images
2024-11-22 04:44:02: class c = 4: 11789 real images
2024-11-22 04:44:02: class c = 5: 7705 real images
2024-11-22 04:44:02: class c = 6: 39203 real images
2024-11-22 04:44:02: class c = 7: 24608 real images
2024-11-22 04:44:02: real images channel 0, mean = 0.1020, std = 0.1000
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 04:44:02: initialize synthetic data from random real images
2024-11-22 04:44:02: [2024-11-22 04:44:02] training begins
2024-11-22 04:44:02: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 04:44:02: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 04:44:02: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 22453}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 04:45:54: Evaluate 5 random ConvNet, ACCmean = 0.2481 ACCstd = 0.0036
-------------------------
2024-11-22 04:45:54: Evaluate 5 random ConvNet, F1mean = 0.2191 F!std = 0.0030
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 04:46:10: [2024-11-22 04:46:10] iter = 0000, loss = 104.1563
2024-11-22 04:48:28: [2024-11-22 04:48:28] iter = 0010, loss = 69.4761
2024-11-22 04:50:49: [2024-11-22 04:50:49] iter = 0020, loss = 54.9539
2024-11-22 04:53:08: [2024-11-22 04:53:08] iter = 0030, loss = 66.4444
2024-11-22 04:55:28: [2024-11-22 04:55:28] iter = 0040, loss = 63.4754
2024-11-22 04:57:55: [2024-11-22 04:57:55] iter = 0050, loss = 41.9079
2024-11-22 05:00:15: [2024-11-22 05:00:15] iter = 0060, loss = 54.2558
2024-11-22 05:02:37: [2024-11-22 05:02:37] iter = 0070, loss = 54.6939
2024-11-22 05:04:58: [2024-11-22 05:04:58] iter = 0080, loss = 59.4080
2024-11-22 05:07:14: [2024-11-22 05:07:14] iter = 0090, loss = 60.0567
2024-11-22 05:09:36: [2024-11-22 05:09:36] iter = 0100, loss = 51.0081
2024-11-22 05:12:02: [2024-11-22 05:12:02] iter = 0110, loss = 86.2563
2024-11-22 05:14:22: [2024-11-22 05:14:22] iter = 0120, loss = 77.2105
2024-11-22 05:16:42: [2024-11-22 05:16:42] iter = 0130, loss = 47.4669
2024-11-22 05:19:02: [2024-11-22 05:19:02] iter = 0140, loss = 51.1145
2024-11-22 05:21:20: [2024-11-22 05:21:20] iter = 0150, loss = 72.1130
2024-11-22 05:23:44: [2024-11-22 05:23:44] iter = 0160, loss = 56.4107
2024-11-22 05:26:05: [2024-11-22 05:26:05] iter = 0170, loss = 60.8956
2024-11-22 05:28:27: [2024-11-22 05:28:27] iter = 0180, loss = 57.3358
2024-11-22 05:30:50: [2024-11-22 05:30:50] iter = 0190, loss = 61.1059
2024-11-22 05:33:05: [2024-11-22 05:33:05] iter = 0200, loss = 75.3086
2024-11-22 05:35:22: [2024-11-22 05:35:22] iter = 0210, loss = 56.5878
2024-11-22 05:37:32: [2024-11-22 05:37:32] iter = 0220, loss = 56.1518
2024-11-22 05:39:52: [2024-11-22 05:39:52] iter = 0230, loss = 53.2307
2024-11-22 05:42:05: [2024-11-22 05:42:05] iter = 0240, loss = 67.0795
2024-11-22 05:44:09: [2024-11-22 05:44:09] iter = 0250, loss = 77.6173
2024-11-22 05:46:09: [2024-11-22 05:46:09] iter = 0260, loss = 58.0257
2024-11-22 05:48:12: [2024-11-22 05:48:12] iter = 0270, loss = 56.1786
2024-11-22 05:50:01: [2024-11-22 05:50:01] iter = 0280, loss = 62.7399
2024-11-22 05:51:36: [2024-11-22 05:51:36] iter = 0290, loss = 49.0059
2024-11-22 05:53:12: [2024-11-22 05:53:12] iter = 0300, loss = 57.7224
2024-11-22 05:54:52: [2024-11-22 05:54:52] iter = 0310, loss = 65.4964
2024-11-22 05:56:38: [2024-11-22 05:56:38] iter = 0320, loss = 57.7404
2024-11-22 05:58:27: [2024-11-22 05:58:27] iter = 0330, loss = 39.5873
2024-11-22 06:00:14: [2024-11-22 06:00:14] iter = 0340, loss = 61.9365
2024-11-22 06:02:06: [2024-11-22 06:02:06] iter = 0350, loss = 54.6289
2024-11-22 06:03:58: [2024-11-22 06:03:58] iter = 0360, loss = 53.5815
2024-11-22 06:05:40: [2024-11-22 06:05:40] iter = 0370, loss = 38.5492
2024-11-22 06:07:23: [2024-11-22 06:07:23] iter = 0380, loss = 38.2426
2024-11-22 06:09:06: [2024-11-22 06:09:06] iter = 0390, loss = 59.6812
2024-11-22 06:10:52: [2024-11-22 06:10:52] iter = 0400, loss = 64.2986
2024-11-22 06:12:36: [2024-11-22 06:12:36] iter = 0410, loss = 63.4058
2024-11-22 06:14:21: [2024-11-22 06:14:21] iter = 0420, loss = 65.0026
2024-11-22 06:15:58: [2024-11-22 06:15:58] iter = 0430, loss = 50.9837
2024-11-22 06:17:44: [2024-11-22 06:17:44] iter = 0440, loss = 47.0432
2024-11-22 06:19:31: [2024-11-22 06:19:31] iter = 0450, loss = 52.5059
2024-11-22 06:21:11: [2024-11-22 06:21:11] iter = 0460, loss = 55.1823
2024-11-22 06:22:49: [2024-11-22 06:22:49] iter = 0470, loss = 69.1912
2024-11-22 06:24:32: [2024-11-22 06:24:32] iter = 0480, loss = 55.7696
2024-11-22 06:26:12: [2024-11-22 06:26:12] iter = 0490, loss = 56.2067
2024-11-22 06:27:44: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 06:27:44: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 06:27:44: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 63884}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 06:29:02: Evaluate 5 random ConvNet, ACCmean = 0.3570 ACCstd = 0.0073
-------------------------
2024-11-22 06:29:02: Evaluate 5 random ConvNet, F1mean = 0.2919 F!std = 0.0026
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 06:29:11: [2024-11-22 06:29:11] iter = 0500, loss = 57.2406
2024-11-22 06:30:50: [2024-11-22 06:30:50] iter = 0510, loss = 47.6519
2024-11-22 06:32:26: [2024-11-22 06:32:26] iter = 0520, loss = 49.2837
2024-11-22 06:34:00: [2024-11-22 06:34:00] iter = 0530, loss = 67.2607
2024-11-22 06:35:38: [2024-11-22 06:35:38] iter = 0540, loss = 43.1242
2024-11-22 06:37:20: [2024-11-22 06:37:20] iter = 0550, loss = 73.8550
2024-11-22 06:38:56: [2024-11-22 06:38:56] iter = 0560, loss = 58.8867
2024-11-22 06:40:36: [2024-11-22 06:40:36] iter = 0570, loss = 52.7312
2024-11-22 06:42:14: [2024-11-22 06:42:14] iter = 0580, loss = 51.0922
2024-11-22 06:43:55: [2024-11-22 06:43:55] iter = 0590, loss = 48.0828
2024-11-22 06:45:36: [2024-11-22 06:45:36] iter = 0600, loss = 54.9391
2024-11-22 06:47:18: [2024-11-22 06:47:18] iter = 0610, loss = 44.1499
2024-11-22 06:48:53: [2024-11-22 06:48:53] iter = 0620, loss = 53.1043
2024-11-22 06:50:30: [2024-11-22 06:50:30] iter = 0630, loss = 67.1202
2024-11-22 06:52:01: [2024-11-22 06:52:01] iter = 0640, loss = 60.3018
2024-11-22 06:53:39: [2024-11-22 06:53:39] iter = 0650, loss = 57.8887
2024-11-22 06:55:13: [2024-11-22 06:55:13] iter = 0660, loss = 40.4653
2024-11-22 06:56:55: [2024-11-22 06:56:55] iter = 0670, loss = 50.5913
2024-11-22 06:58:36: [2024-11-22 06:58:36] iter = 0680, loss = 59.7554
2024-11-22 07:00:13: [2024-11-22 07:00:13] iter = 0690, loss = 53.1997
2024-11-22 07:01:47: [2024-11-22 07:01:47] iter = 0700, loss = 69.5069
2024-11-22 07:03:24: [2024-11-22 07:03:24] iter = 0710, loss = 42.7560
2024-11-22 07:05:03: [2024-11-22 07:05:03] iter = 0720, loss = 50.3614
2024-11-22 07:06:38: [2024-11-22 07:06:38] iter = 0730, loss = 53.3315
2024-11-22 07:08:20: [2024-11-22 07:08:20] iter = 0740, loss = 49.4081
2024-11-22 07:10:02: [2024-11-22 07:10:02] iter = 0750, loss = 71.1833
2024-11-22 07:11:41: [2024-11-22 07:11:41] iter = 0760, loss = 62.3234
2024-11-22 07:13:20: [2024-11-22 07:13:20] iter = 0770, loss = 86.5757
2024-11-22 07:14:59: [2024-11-22 07:14:59] iter = 0780, loss = 52.5046
2024-11-22 07:16:36: [2024-11-22 07:16:36] iter = 0790, loss = 60.1295
2024-11-22 07:18:14: [2024-11-22 07:18:14] iter = 0800, loss = 53.3130
2024-11-22 07:19:48: [2024-11-22 07:19:48] iter = 0810, loss = 57.2924
2024-11-22 07:21:29: [2024-11-22 07:21:29] iter = 0820, loss = 51.3053
2024-11-22 07:23:08: [2024-11-22 07:23:08] iter = 0830, loss = 43.3645
2024-11-22 07:24:46: [2024-11-22 07:24:46] iter = 0840, loss = 48.6879
2024-11-22 07:26:21: [2024-11-22 07:26:21] iter = 0850, loss = 69.8510
2024-11-22 07:28:00: [2024-11-22 07:28:00] iter = 0860, loss = 50.6841
2024-11-22 07:29:35: [2024-11-22 07:29:35] iter = 0870, loss = 63.0147
2024-11-22 07:31:15: [2024-11-22 07:31:15] iter = 0880, loss = 67.0993
2024-11-22 07:32:55: [2024-11-22 07:32:55] iter = 0890, loss = 55.6427
2024-11-22 07:34:38: [2024-11-22 07:34:38] iter = 0900, loss = 75.4047
2024-11-22 07:36:19: [2024-11-22 07:36:19] iter = 0910, loss = 46.3439
2024-11-22 07:38:02: [2024-11-22 07:38:02] iter = 0920, loss = 44.0284
2024-11-22 07:39:43: [2024-11-22 07:39:43] iter = 0930, loss = 51.6393
2024-11-22 07:41:27: [2024-11-22 07:41:27] iter = 0940, loss = 55.2517
2024-11-22 07:43:07: [2024-11-22 07:43:07] iter = 0950, loss = 45.6617
2024-11-22 07:44:45: [2024-11-22 07:44:45] iter = 0960, loss = 46.5990
2024-11-22 07:46:20: [2024-11-22 07:46:20] iter = 0970, loss = 54.1147
2024-11-22 07:47:50: [2024-11-22 07:47:50] iter = 0980, loss = 69.9384
2024-11-22 07:49:26: [2024-11-22 07:49:26] iter = 0990, loss = 62.7152
2024-11-22 07:50:55: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 07:50:55: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 07:50:55: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 55039}
Using downloaded and verified file: /data/users/xiongyuxuan/.medmnist/tissuemnist.npz
Using downloaded and verified file: /data/users/xiongyuxuan/.medmnist/tissuemnist.npz
Loaded the dataset:TissueMNIST
[2024-11-21 20:39:51] Evaluate_00: epoch = 1000 train time = 13 s train loss = 0.032837 train acc = 1.0000, test acc = 0.2943, test_sen =0.2526, test_spe =0.8975, test_f1 =0.2406
[2024-11-21 20:40:05] Evaluate_01: epoch = 1000 train time = 11 s train loss = 0.002667 train acc = 1.0000, test acc = 0.2940, test_sen =0.2592, test_spe =0.8980, test_f1 =0.2437
[2024-11-21 20:40:17] Evaluate_02: epoch = 1000 train time = 9 s train loss = 0.002337 train acc = 1.0000, test acc = 0.3002, test_sen =0.2558, test_spe =0.8982, test_f1 =0.2446
[2024-11-21 20:40:29] Evaluate_03: epoch = 1000 train time = 9 s train loss = 0.001290 train acc = 1.0000, test acc = 0.2880, test_sen =0.2551, test_spe =0.8970, test_f1 =0.2406
[2024-11-21 20:40:40] Evaluate_04: epoch = 1000 train time = 9 s train loss = 0.019197 train acc = 1.0000, test acc = 0.2963, test_sen =0.2596, test_spe =0.8982, test_f1 =0.2435
[2024-11-21 22:40:56] Evaluate_00: epoch = 1000 train time = 20 s train loss = 0.018822 train acc = 1.0000, test acc = 0.3511, test_sen =0.3244, test_spe =0.9068, test_f1 =0.2946
[2024-11-21 22:41:21] Evaluate_01: epoch = 1000 train time = 20 s train loss = 0.008700 train acc = 1.0000, test acc = 0.3590, test_sen =0.3249, test_spe =0.9078, test_f1 =0.2925
[2024-11-21 22:41:43] Evaluate_02: epoch = 1000 train time = 17 s train loss = 0.146585 train acc = 0.9875, test acc = 0.3331, test_sen =0.3200, test_spe =0.9051, test_f1 =0.2820
[2024-11-21 22:42:08] Evaluate_03: epoch = 1000 train time = 19 s train loss = 0.007024 train acc = 1.0000, test acc = 0.3251, test_sen =0.3137, test_spe =0.9043, test_f1 =0.2757
[2024-11-21 22:42:31] Evaluate_04: epoch = 1000 train time = 19 s train loss = 0.028641 train acc = 1.0000, test acc = 0.3450, test_sen =0.3221, test_spe =0.9067, test_f1 =0.2888
[2024-11-22 00:40:37] Evaluate_00: epoch = 1000 train time = 18 s train loss = 0.011501 train acc = 1.0000, test acc = 0.3695, test_sen =0.3347, test_spe =0.9095, test_f1 =0.3055
[2024-11-22 00:41:02] Evaluate_01: epoch = 1000 train time = 20 s train loss = 0.015901 train acc = 1.0000, test acc = 0.3496, test_sen =0.3303, test_spe =0.9074, test_f1 =0.2947
[2024-11-22 00:41:25] Evaluate_02: epoch = 1000 train time = 19 s train loss = 0.023816 train acc = 1.0000, test acc = 0.3864, test_sen =0.3398, test_spe =0.9109, test_f1 =0.3082
[2024-11-22 00:41:49] Evaluate_03: epoch = 1000 train time = 19 s train loss = 0.012914 train acc = 1.0000, test acc = 0.3628, test_sen =0.3317, test_spe =0.9086, test_f1 =0.2994
[2024-11-22 00:42:15] Evaluate_04: epoch = 1000 train time = 21 s train loss = 0.141850 train acc = 0.9875, test acc = 0.3665, test_sen =0.3289, test_spe =0.9087, test_f1 =0.3016
[2024-11-22 00:43:13] Evaluate_00: epoch = 1000 train time = 23 s train loss = 0.014443 train acc = 1.0000, test acc = 0.2827, test_sen =0.2484, test_spe =0.8956, test_f1 =0.2330
[2024-11-22 00:43:38] Evaluate_01: epoch = 1000 train time = 21 s train loss = 0.033265 train acc = 1.0000, test acc = 0.2980, test_sen =0.2520, test_spe =0.8970, test_f1 =0.2401
[2024-11-22 00:44:00] Evaluate_02: epoch = 1000 train time = 17 s train loss = 0.003580 train acc = 1.0000, test acc = 0.2889, test_sen =0.2509, test_spe =0.8958, test_f1 =0.2372
[2024-11-22 00:44:26] Evaluate_03: epoch = 1000 train time = 21 s train loss = 0.056127 train acc = 0.9875, test acc = 0.2916, test_sen =0.2514, test_spe =0.8965, test_f1 =0.2385
[2024-11-22 00:44:50] Evaluate_04: epoch = 1000 train time = 19 s train loss = 0.031359 train acc = 1.0000, test acc = 0.2944, test_sen =0.2520, test_spe =0.8962, test_f1 =0.2396
[2024-11-22 02:43:10] Evaluate_00: epoch = 1000 train time = 18 s train loss = 0.220541 train acc = 0.9750, test acc = 0.3275, test_sen =0.3092, test_spe =0.9047, test_f1 =0.2807
[2024-11-22 02:43:32] Evaluate_01: epoch = 1000 train time = 19 s train loss = 0.004396 train acc = 1.0000, test acc = 0.3277, test_sen =0.3097, test_spe =0.9044, test_f1 =0.2822
[2024-11-22 02:43:54] Evaluate_02: epoch = 1000 train time = 18 s train loss = 0.006954 train acc = 1.0000, test acc = 0.3421, test_sen =0.3167, test_spe =0.9063, test_f1 =0.2893
[2024-11-22 02:44:18] Evaluate_03: epoch = 1000 train time = 19 s train loss = 0.008853 train acc = 1.0000, test acc = 0.3136, test_sen =0.3009, test_spe =0.9032, test_f1 =0.2730
[2024-11-22 02:44:38] Evaluate_04: epoch = 1000 train time = 15 s train loss = 0.011443 train acc = 1.0000, test acc = 0.3500, test_sen =0.3105, test_spe =0.9065, test_f1 =0.2880
[2024-11-22 04:42:00] Evaluate_00: epoch = 1000 train time = 19 s train loss = 0.056833 train acc = 1.0000, test acc = 0.3898, test_sen =0.3316, test_spe =0.9111, test_f1 =0.3091
[2024-11-22 04:42:25] Evaluate_01: epoch = 1000 train time = 20 s train loss = 0.239179 train acc = 0.9750, test acc = 0.4065, test_sen =0.3276, test_spe =0.9122, test_f1 =0.3095
[2024-11-22 04:42:48] Evaluate_02: epoch = 1000 train time = 19 s train loss = 0.176610 train acc = 0.9875, test acc = 0.3912, test_sen =0.3291, test_spe =0.9110, test_f1 =0.3087
[2024-11-22 04:43:09] Evaluate_03: epoch = 1000 train time = 17 s train loss = 0.002084 train acc = 1.0000, test acc = 0.3946, test_sen =0.3313, test_spe =0.9116, test_f1 =0.3106
[2024-11-22 04:43:28] Evaluate_04: epoch = 1000 train time = 14 s train loss = 0.013449 train acc = 1.0000, test acc = 0.3821, test_sen =0.3247, test_spe =0.9102, test_f1 =0.3040
[2024-11-22 04:44:23] Evaluate_00: epoch = 1000 train time = 16 s train loss = 0.084590 train acc = 1.0000, test acc = 0.2495, test_sen =0.2415, test_spe =0.8918, test_f1 =0.2200
[2024-11-22 04:44:46] Evaluate_01: epoch = 1000 train time = 18 s train loss = 0.002263 train acc = 1.0000, test acc = 0.2517, test_sen =0.2478, test_spe =0.8930, test_f1 =0.2233
[2024-11-22 04:45:10] Evaluate_02: epoch = 1000 train time = 19 s train loss = 0.021151 train acc = 1.0000, test acc = 0.2496, test_sen =0.2382, test_spe =0.8918, test_f1 =0.2191
[2024-11-22 04:45:34] Evaluate_03: epoch = 1000 train time = 20 s train loss = 0.110924 train acc = 0.9875, test acc = 0.2412, test_sen =0.2369, test_spe =0.8908, test_f1 =0.2141
[2024-11-22 04:45:54] Evaluate_04: epoch = 1000 train time = 16 s train loss = 0.156357 train acc = 0.9375, test acc = 0.2487, test_sen =0.2397, test_spe =0.8920, test_f1 =0.2193
[2024-11-22 06:27:59] Evaluate_00: epoch = 1000 train time = 12 s train loss = 0.015625 train acc = 1.0000, test acc = 0.3549, test_sen =0.3187, test_spe =0.9074, test_f1 =0.2889
[2024-11-22 06:28:14] Evaluate_01: epoch = 1000 train time = 13 s train loss = 0.003076 train acc = 1.0000, test acc = 0.3550, test_sen =0.3187, test_spe =0.9071, test_f1 =0.2938
[2024-11-22 06:28:31] Evaluate_02: epoch = 1000 train time = 13 s train loss = 0.201484 train acc = 0.9875, test acc = 0.3711, test_sen =0.3240, test_spe =0.9087, test_f1 =0.2956
[2024-11-22 06:28:47] Evaluate_03: epoch = 1000 train time = 12 s train loss = 0.009482 train acc = 1.0000, test acc = 0.3541, test_sen =0.3244, test_spe =0.9075, test_f1 =0.2924
[2024-11-22 06:29:02] Evaluate_04: epoch = 1000 train time = 11 s train loss = 0.009799 train acc = 1.0000, test acc = 0.3497, test_sen =0.3163, test_spe =0.9068, test_f1 =0.2890
[2024-11-22 07:51:09] Evaluate_00: epoch = 1000 train time = 11 s train loss = 0.055508 train acc = 1.0000, test acc = 0.3419, test_sen =0.3114, test_spe =0.9062, test_f1 =0.2867
[2024-11-22 07:51:26] Evaluate_01: epoch = 1000 train time = 14 s train loss = 0.058532 train acc = 1.0000, test acc = 0.3880, test_sen =0.3209, test_spe =0.9106, test_f1 =0.3032
[2024-11-22 07:51:45] Evaluate_02: epoch = 1000 train time = 15 s train loss = 0.010008 train acc = 1.0000, test acc = 0.3714, test_sen =0.3188, test_spe =0.9093, test_f1 =0.2947
[2024-11-22 07:52:02] Evaluate_03: epoch = 1000 train time = 13 s train loss = 0.228883 train acc = 0.9625, test acc = 0.3614, test_sen =0.3234, test_spe =0.9089, test_f1 =0.2943
[2024-11-22 07:52:19] Evaluate_04: epoch = 1000 train time = 15 s train loss = 0.015485 train acc = 1.0000, test acc = 0.3710, test_sen =0.3160, test_spe =0.9089, test_f1 =0.2915/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 07:52:19: Evaluate 5 random ConvNet, ACCmean = 0.3667 ACCstd = 0.0151
-------------------------
2024-11-22 07:52:19: Evaluate 5 random ConvNet, F1mean = 0.2941 F!std = 0.0054
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 07:52:29: [2024-11-22 07:52:29] iter = 1000, loss = 56.6028
2024-11-22 07:52:29: 
================== Exp 3 ==================
 
2024-11-22 07:52:29: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'TissueMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f1850325ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_TissueMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 07:52:29: Evaluation model pool: ['ConvNet']
2024-11-22 07:52:37: class c = 0: 53075 real images
2024-11-22 07:52:37: class c = 1: 7814 real images
2024-11-22 07:52:37: class c = 2: 5866 real images
2024-11-22 07:52:37: class c = 3: 15406 real images
2024-11-22 07:52:37: class c = 4: 11789 real images
2024-11-22 07:52:37: class c = 5: 7705 real images
2024-11-22 07:52:37: class c = 6: 39203 real images
2024-11-22 07:52:37: class c = 7: 24608 real images
2024-11-22 07:52:37: real images channel 0, mean = 0.1020, std = 0.1000
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 07:52:37: initialize synthetic data from random real images
2024-11-22 07:52:38: [2024-11-22 07:52:38] training begins
2024-11-22 07:52:38: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 07:52:38: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 07:52:38: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 49079}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 07:53:59: Evaluate 5 random ConvNet, ACCmean = 0.2605 ACCstd = 0.0047
-------------------------
2024-11-22 07:53:59: Evaluate 5 random ConvNet, F1mean = 0.2135 F!std = 0.0025
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 07:54:10: [2024-11-22 07:54:10] iter = 0000, loss = 111.7701
2024-11-22 07:55:53: [2024-11-22 07:55:53] iter = 0010, loss = 78.0038
2024-11-22 07:57:37: [2024-11-22 07:57:37] iter = 0020, loss = 70.1507
2024-11-22 07:59:18: [2024-11-22 07:59:18] iter = 0030, loss = 62.1005
2024-11-22 08:01:03: [2024-11-22 08:01:03] iter = 0040, loss = 65.4106
2024-11-22 08:02:53: [2024-11-22 08:02:53] iter = 0050, loss = 59.7032
2024-11-22 08:04:38: [2024-11-22 08:04:38] iter = 0060, loss = 80.4942
2024-11-22 08:06:22: [2024-11-22 08:06:22] iter = 0070, loss = 64.9724
2024-11-22 08:08:03: [2024-11-22 08:08:03] iter = 0080, loss = 67.0812
2024-11-22 08:09:48: [2024-11-22 08:09:48] iter = 0090, loss = 66.3675
2024-11-22 08:11:23: [2024-11-22 08:11:23] iter = 0100, loss = 52.8745
2024-11-22 08:13:05: [2024-11-22 08:13:05] iter = 0110, loss = 46.7322
2024-11-22 08:14:49: [2024-11-22 08:14:49] iter = 0120, loss = 43.9569
2024-11-22 08:16:31: [2024-11-22 08:16:31] iter = 0130, loss = 52.2852
2024-11-22 08:17:45: [2024-11-22 08:17:45] iter = 0140, loss = 46.9252
2024-11-22 08:19:05: [2024-11-22 08:19:05] iter = 0150, loss = 55.4219
2024-11-22 08:20:24: [2024-11-22 08:20:24] iter = 0160, loss = 55.5171
2024-11-22 08:21:38: [2024-11-22 08:21:38] iter = 0170, loss = 54.7141
2024-11-22 08:22:56: [2024-11-22 08:22:56] iter = 0180, loss = 66.5189
2024-11-22 08:24:13: [2024-11-22 08:24:13] iter = 0190, loss = 57.9461
2024-11-22 08:25:20: [2024-11-22 08:25:20] iter = 0200, loss = 50.6274
2024-11-22 08:26:35: [2024-11-22 08:26:35] iter = 0210, loss = 66.4896
2024-11-22 08:27:49: [2024-11-22 08:27:49] iter = 0220, loss = 50.8727
2024-11-22 08:28:58: [2024-11-22 08:28:58] iter = 0230, loss = 38.7192
2024-11-22 08:30:07: [2024-11-22 08:30:07] iter = 0240, loss = 65.9208
2024-11-22 08:31:21: [2024-11-22 08:31:21] iter = 0250, loss = 57.5423
2024-11-22 08:32:32: [2024-11-22 08:32:32] iter = 0260, loss = 49.4399
2024-11-22 08:33:45: [2024-11-22 08:33:45] iter = 0270, loss = 73.0795
2024-11-22 08:35:04: [2024-11-22 08:35:04] iter = 0280, loss = 52.1931
2024-11-22 08:36:18: [2024-11-22 08:36:18] iter = 0290, loss = 80.1034
2024-11-22 08:37:37: [2024-11-22 08:37:37] iter = 0300, loss = 53.6316
2024-11-22 08:38:48: [2024-11-22 08:38:48] iter = 0310, loss = 71.9355
2024-11-22 08:40:01: [2024-11-22 08:40:01] iter = 0320, loss = 46.5606
2024-11-22 08:41:17: [2024-11-22 08:41:17] iter = 0330, loss = 55.5167
2024-11-22 08:42:28: [2024-11-22 08:42:28] iter = 0340, loss = 55.7289
2024-11-22 08:43:41: [2024-11-22 08:43:41] iter = 0350, loss = 44.9509
2024-11-22 08:44:51: [2024-11-22 08:44:51] iter = 0360, loss = 59.0526
2024-11-22 08:46:06: [2024-11-22 08:46:06] iter = 0370, loss = 56.2958
2024-11-22 08:47:26: [2024-11-22 08:47:26] iter = 0380, loss = 47.1611
2024-11-22 08:48:42: [2024-11-22 08:48:42] iter = 0390, loss = 66.3112
2024-11-22 08:49:51: [2024-11-22 08:49:51] iter = 0400, loss = 60.8015
2024-11-22 08:51:08: [2024-11-22 08:51:08] iter = 0410, loss = 67.3976
2024-11-22 08:52:22: [2024-11-22 08:52:22] iter = 0420, loss = 58.7675
2024-11-22 08:53:35: [2024-11-22 08:53:35] iter = 0430, loss = 51.8176
2024-11-22 08:54:46: [2024-11-22 08:54:46] iter = 0440, loss = 57.5354
2024-11-22 08:55:58: [2024-11-22 08:55:58] iter = 0450, loss = 53.6207
2024-11-22 08:57:13: [2024-11-22 08:57:13] iter = 0460, loss = 57.7825
2024-11-22 08:58:26: [2024-11-22 08:58:26] iter = 0470, loss = 52.7203
2024-11-22 08:59:39: [2024-11-22 08:59:39] iter = 0480, loss = 54.6049
2024-11-22 09:00:59: [2024-11-22 09:00:59] iter = 0490, loss = 77.3912
2024-11-22 09:02:08: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 09:02:08: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 09:02:08: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 28767}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 09:03:09: Evaluate 5 random ConvNet, ACCmean = 0.3478 ACCstd = 0.0100
-------------------------
2024-11-22 09:03:09: Evaluate 5 random ConvNet, F1mean = 0.2806 F!std = 0.0036
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 09:03:16: [2024-11-22 09:03:16] iter = 0500, loss = 56.9722
2024-11-22 09:04:29: [2024-11-22 09:04:29] iter = 0510, loss = 54.6053
2024-11-22 09:05:47: [2024-11-22 09:05:47] iter = 0520, loss = 59.8921
2024-11-22 09:07:02: [2024-11-22 09:07:02] iter = 0530, loss = 48.1755
2024-11-22 09:08:18: [2024-11-22 09:08:18] iter = 0540, loss = 62.0288
2024-11-22 09:09:32: [2024-11-22 09:09:32] iter = 0550, loss = 67.5604
2024-11-22 09:10:45: [2024-11-22 09:10:45] iter = 0560, loss = 64.6165
2024-11-22 09:11:58: [2024-11-22 09:11:58] iter = 0570, loss = 65.6569
2024-11-22 09:13:11: [2024-11-22 09:13:11] iter = 0580, loss = 61.4612
2024-11-22 09:14:23: [2024-11-22 09:14:23] iter = 0590, loss = 63.0985
2024-11-22 09:15:34: [2024-11-22 09:15:34] iter = 0600, loss = 72.1035
2024-11-22 09:16:47: [2024-11-22 09:16:47] iter = 0610, loss = 65.8720
2024-11-22 09:18:03: [2024-11-22 09:18:03] iter = 0620, loss = 67.5839
2024-11-22 09:19:17: [2024-11-22 09:19:17] iter = 0630, loss = 64.2136
2024-11-22 09:20:30: [2024-11-22 09:20:30] iter = 0640, loss = 42.6920
2024-11-22 09:21:48: [2024-11-22 09:21:48] iter = 0650, loss = 58.3274
2024-11-22 09:23:02: [2024-11-22 09:23:02] iter = 0660, loss = 76.6097
2024-11-22 09:24:19: [2024-11-22 09:24:19] iter = 0670, loss = 47.0892
2024-11-22 09:25:38: [2024-11-22 09:25:38] iter = 0680, loss = 67.2284
2024-11-22 09:26:54: [2024-11-22 09:26:54] iter = 0690, loss = 49.8004
2024-11-22 09:28:10: [2024-11-22 09:28:10] iter = 0700, loss = 39.4886
2024-11-22 09:29:23: [2024-11-22 09:29:23] iter = 0710, loss = 78.6978
2024-11-22 09:30:38: [2024-11-22 09:30:38] iter = 0720, loss = 61.9516
2024-11-22 09:31:53: [2024-11-22 09:31:53] iter = 0730, loss = 56.5158
2024-11-22 09:33:02: [2024-11-22 09:33:02] iter = 0740, loss = 51.6252
2024-11-22 09:34:11: [2024-11-22 09:34:11] iter = 0750, loss = 48.8700
2024-11-22 09:35:23: [2024-11-22 09:35:23] iter = 0760, loss = 60.1471
2024-11-22 09:36:33: [2024-11-22 09:36:33] iter = 0770, loss = 61.2167
2024-11-22 09:37:52: [2024-11-22 09:37:52] iter = 0780, loss = 62.0024
2024-11-22 09:39:08: [2024-11-22 09:39:08] iter = 0790, loss = 49.2759
2024-11-22 09:40:24: [2024-11-22 09:40:24] iter = 0800, loss = 55.7873
2024-11-22 09:41:39: [2024-11-22 09:41:39] iter = 0810, loss = 50.6864
2024-11-22 09:42:52: [2024-11-22 09:42:52] iter = 0820, loss = 49.1563
2024-11-22 09:44:02: [2024-11-22 09:44:02] iter = 0830, loss = 71.9524
2024-11-22 09:45:18: [2024-11-22 09:45:18] iter = 0840, loss = 52.1725
2024-11-22 09:46:33: [2024-11-22 09:46:33] iter = 0850, loss = 67.8582
2024-11-22 09:47:48: [2024-11-22 09:47:48] iter = 0860, loss = 58.8203
2024-11-22 09:49:00: [2024-11-22 09:49:00] iter = 0870, loss = 45.0123
2024-11-22 09:50:18: [2024-11-22 09:50:18] iter = 0880, loss = 51.1180
2024-11-22 09:51:30: [2024-11-22 09:51:30] iter = 0890, loss = 51.9157
2024-11-22 09:52:40: [2024-11-22 09:52:40] iter = 0900, loss = 38.3750
2024-11-22 09:53:56: [2024-11-22 09:53:56] iter = 0910, loss = 60.9142
2024-11-22 09:55:09: [2024-11-22 09:55:09] iter = 0920, loss = 56.1192
2024-11-22 09:56:20: [2024-11-22 09:56:20] iter = 0930, loss = 42.3521
2024-11-22 09:57:27: [2024-11-22 09:57:27] iter = 0940, loss = 57.2635
2024-11-22 09:58:39: [2024-11-22 09:58:39] iter = 0950, loss = 54.7549
2024-11-22 09:59:53: [2024-11-22 09:59:53] iter = 0960, loss = 59.3474
2024-11-22 10:01:09: [2024-11-22 10:01:09] iter = 0970, loss = 58.4823
2024-11-22 10:02:21: [2024-11-22 10:02:21] iter = 0980, loss = 56.5915
2024-11-22 10:03:38: [2024-11-22 10:03:38] iter = 0990, loss = 59.9884
2024-11-22 10:04:42: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 10:04:42: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 10:04:42: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 82635}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 10:05:41: Evaluate 5 random ConvNet, ACCmean = 0.3622 ACCstd = 0.0107
-------------------------
2024-11-22 10:05:41: Evaluate 5 random ConvNet, F1mean = 0.2952 F!std = 0.0044
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 10:05:49: [2024-11-22 10:05:49] iter = 1000, loss = 55.4724
2024-11-22 10:05:49: 
================== Exp 4 ==================
 
2024-11-22 10:05:49: Hyper-parameters: 
{'method': 'DSA', 'dataset': 'TissueMNIST', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 5, 'epoch_eval_train': 1000, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'real', 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f1850325ca0>, 'dsa': True, 'mode': 'DSA', 'logger': <Logger DSA_IPC_10_limg_0.1_Data_TissueMNIST (INFO)>, 'dc_aug_param': None}
2024-11-22 10:05:49: Evaluation model pool: ['ConvNet']
2024-11-22 10:05:55: class c = 0: 53075 real images
2024-11-22 10:05:55: class c = 1: 7814 real images
2024-11-22 10:05:55: class c = 2: 5866 real images
2024-11-22 10:05:55: class c = 3: 15406 real images
2024-11-22 10:05:55: class c = 4: 11789 real images
2024-11-22 10:05:55: class c = 5: 7705 real images
2024-11-22 10:05:55: class c = 6: 39203 real images
2024-11-22 10:05:55: class c = 7: 24608 real images
2024-11-22 10:05:55: real images channel 0, mean = 0.1020, std = 0.1000
main_base.py:125: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
2024-11-22 10:05:55: initialize synthetic data from random real images
2024-11-22 10:05:55: [2024-11-22 10:05:55] training begins
2024-11-22 10:05:55: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
2024-11-22 10:05:55: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 10:05:55: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 48954}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 10:07:01: Evaluate 5 random ConvNet, ACCmean = 0.3013 ACCstd = 0.0039
-------------------------
2024-11-22 10:07:01: Evaluate 5 random ConvNet, F1mean = 0.2496 F!std = 0.0011
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 10:07:10: [2024-11-22 10:07:10] iter = 0000, loss = 105.4694
2024-11-22 10:08:27: [2024-11-22 10:08:27] iter = 0010, loss = 53.5713
2024-11-22 10:09:39: [2024-11-22 10:09:39] iter = 0020, loss = 52.5678
2024-11-22 10:10:57: [2024-11-22 10:10:57] iter = 0030, loss = 86.0398
2024-11-22 10:12:13: [2024-11-22 10:12:13] iter = 0040, loss = 65.0698
2024-11-22 10:13:30: [2024-11-22 10:13:30] iter = 0050, loss = 67.3056
2024-11-22 10:14:43: [2024-11-22 10:14:43] iter = 0060, loss = 80.3673
2024-11-22 10:15:51: [2024-11-22 10:15:51] iter = 0070, loss = 53.8038
2024-11-22 10:17:03: [2024-11-22 10:17:03] iter = 0080, loss = 56.8901
2024-11-22 10:18:13: [2024-11-22 10:18:13] iter = 0090, loss = 61.9224
2024-11-22 10:19:19: [2024-11-22 10:19:19] iter = 0100, loss = 52.3713
2024-11-22 10:20:31: [2024-11-22 10:20:31] iter = 0110, loss = 75.4467
2024-11-22 10:21:42: [2024-11-22 10:21:42] iter = 0120, loss = 53.4984
2024-11-22 10:22:53: [2024-11-22 10:22:53] iter = 0130, loss = 54.0338
2024-11-22 10:24:05: [2024-11-22 10:24:05] iter = 0140, loss = 46.8003
2024-11-22 10:25:17: [2024-11-22 10:25:17] iter = 0150, loss = 33.1184
2024-11-22 10:26:30: [2024-11-22 10:26:30] iter = 0160, loss = 64.4742
2024-11-22 10:27:46: [2024-11-22 10:27:46] iter = 0170, loss = 64.6935
2024-11-22 10:28:59: [2024-11-22 10:28:59] iter = 0180, loss = 62.6637
2024-11-22 10:30:04: [2024-11-22 10:30:04] iter = 0190, loss = 57.3452
2024-11-22 10:31:17: [2024-11-22 10:31:17] iter = 0200, loss = 57.4356
2024-11-22 10:32:35: [2024-11-22 10:32:35] iter = 0210, loss = 68.7870
2024-11-22 10:33:47: [2024-11-22 10:33:47] iter = 0220, loss = 56.1850
2024-11-22 10:35:02: [2024-11-22 10:35:02] iter = 0230, loss = 51.6737
2024-11-22 10:36:17: [2024-11-22 10:36:17] iter = 0240, loss = 53.2234
2024-11-22 10:37:36: [2024-11-22 10:37:36] iter = 0250, loss = 46.7451
2024-11-22 10:38:50: [2024-11-22 10:38:50] iter = 0260, loss = 69.9155
2024-11-22 10:40:01: [2024-11-22 10:40:01] iter = 0270, loss = 43.4489
2024-11-22 10:41:14: [2024-11-22 10:41:14] iter = 0280, loss = 59.6372
2024-11-22 10:42:24: [2024-11-22 10:42:24] iter = 0290, loss = 57.0415
2024-11-22 10:43:37: [2024-11-22 10:43:37] iter = 0300, loss = 47.2803
2024-11-22 10:44:51: [2024-11-22 10:44:51] iter = 0310, loss = 59.6503
2024-11-22 10:46:08: [2024-11-22 10:46:08] iter = 0320, loss = 46.8840
2024-11-22 10:47:20: [2024-11-22 10:47:20] iter = 0330, loss = 42.6899
2024-11-22 10:48:36: [2024-11-22 10:48:36] iter = 0340, loss = 41.4120
2024-11-22 10:49:55: [2024-11-22 10:49:55] iter = 0350, loss = 71.1759
2024-11-22 10:51:11: [2024-11-22 10:51:11] iter = 0360, loss = 69.0061
2024-11-22 10:52:23: [2024-11-22 10:52:23] iter = 0370, loss = 52.5700
2024-11-22 10:53:40: [2024-11-22 10:53:40] iter = 0380, loss = 56.0151
2024-11-22 10:54:52: [2024-11-22 10:54:52] iter = 0390, loss = 55.3473
2024-11-22 10:56:12: [2024-11-22 10:56:12] iter = 0400, loss = 68.0449
2024-11-22 10:57:26: [2024-11-22 10:57:26] iter = 0410, loss = 61.3027
2024-11-22 10:58:38: [2024-11-22 10:58:38] iter = 0420, loss = 56.4699
2024-11-22 10:59:47: [2024-11-22 10:59:47] iter = 0430, loss = 58.9166
2024-11-22 11:00:57: [2024-11-22 11:00:57] iter = 0440, loss = 41.2455
2024-11-22 11:02:18: [2024-11-22 11:02:18] iter = 0450, loss = 39.4353
2024-11-22 11:03:38: [2024-11-22 11:03:38] iter = 0460, loss = 86.0413
2024-11-22 11:04:55: [2024-11-22 11:04:55] iter = 0470, loss = 56.0991
2024-11-22 11:06:09: [2024-11-22 11:06:09] iter = 0480, loss = 51.4500
2024-11-22 11:07:20: [2024-11-22 11:07:20] iter = 0490, loss = 44.5643
2024-11-22 11:08:26: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
2024-11-22 11:08:26: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 11:08:26: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 5972}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 11:09:28: Evaluate 5 random ConvNet, ACCmean = 0.3626 ACCstd = 0.0048
-------------------------
2024-11-22 11:09:28: Evaluate 5 random ConvNet, F1mean = 0.2925 F!std = 0.0013
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 11:09:35: [2024-11-22 11:09:35] iter = 0500, loss = 66.6733
2024-11-22 11:10:52: [2024-11-22 11:10:52] iter = 0510, loss = 55.2835
2024-11-22 11:11:58: [2024-11-22 11:11:58] iter = 0520, loss = 60.2755
2024-11-22 11:13:09: [2024-11-22 11:13:09] iter = 0530, loss = 61.1877
2024-11-22 11:14:19: [2024-11-22 11:14:19] iter = 0540, loss = 47.0946
2024-11-22 11:15:31: [2024-11-22 11:15:31] iter = 0550, loss = 63.8890
2024-11-22 11:16:40: [2024-11-22 11:16:40] iter = 0560, loss = 66.5008
2024-11-22 11:17:52: [2024-11-22 11:17:52] iter = 0570, loss = 57.3755
2024-11-22 11:19:03: [2024-11-22 11:19:03] iter = 0580, loss = 69.7761
2024-11-22 11:20:16: [2024-11-22 11:20:16] iter = 0590, loss = 57.1685
2024-11-22 11:21:26: [2024-11-22 11:21:26] iter = 0600, loss = 50.9978
2024-11-22 11:22:37: [2024-11-22 11:22:37] iter = 0610, loss = 49.0845
2024-11-22 11:23:52: [2024-11-22 11:23:52] iter = 0620, loss = 55.7183
2024-11-22 11:25:07: [2024-11-22 11:25:07] iter = 0630, loss = 46.4134
2024-11-22 11:26:19: [2024-11-22 11:26:19] iter = 0640, loss = 53.2945
2024-11-22 11:27:31: [2024-11-22 11:27:31] iter = 0650, loss = 67.1616
2024-11-22 11:28:43: [2024-11-22 11:28:43] iter = 0660, loss = 47.3422
2024-11-22 11:29:54: [2024-11-22 11:29:54] iter = 0670, loss = 57.3606
2024-11-22 11:31:09: [2024-11-22 11:31:09] iter = 0680, loss = 62.1348
2024-11-22 11:32:30: [2024-11-22 11:32:30] iter = 0690, loss = 57.2240
2024-11-22 11:33:43: [2024-11-22 11:33:43] iter = 0700, loss = 52.0804
2024-11-22 11:35:00: [2024-11-22 11:35:00] iter = 0710, loss = 56.5265
2024-11-22 11:36:19: [2024-11-22 11:36:19] iter = 0720, loss = 40.7107
2024-11-22 11:37:38: [2024-11-22 11:37:38] iter = 0730, loss = 53.6069
2024-11-22 11:38:46: [2024-11-22 11:38:46] iter = 0740, loss = 52.2221
2024-11-22 11:39:59: [2024-11-22 11:39:59] iter = 0750, loss = 51.7128
2024-11-22 11:41:13: [2024-11-22 11:41:13] iter = 0760, loss = 54.8753
2024-11-22 11:42:25: [2024-11-22 11:42:25] iter = 0770, loss = 43.5270
2024-11-22 11:43:42: [2024-11-22 11:43:42] iter = 0780, loss = 51.3262
2024-11-22 11:45:00: [2024-11-22 11:45:00] iter = 0790, loss = 58.4734
2024-11-22 11:46:15: [2024-11-22 11:46:15] iter = 0800, loss = 50.7154
2024-11-22 11:47:27: [2024-11-22 11:47:27] iter = 0810, loss = 65.3006
2024-11-22 11:48:41: [2024-11-22 11:48:41] iter = 0820, loss = 61.4307
2024-11-22 11:49:54: [2024-11-22 11:49:54] iter = 0830, loss = 68.9022
2024-11-22 11:51:08: [2024-11-22 11:51:08] iter = 0840, loss = 50.5835
2024-11-22 11:52:19: [2024-11-22 11:52:19] iter = 0850, loss = 53.1037
2024-11-22 11:53:28: [2024-11-22 11:53:28] iter = 0860, loss = 49.8180
2024-11-22 11:54:42: [2024-11-22 11:54:42] iter = 0870, loss = 49.7338
2024-11-22 11:55:55: [2024-11-22 11:55:55] iter = 0880, loss = 66.5941
2024-11-22 11:57:09: [2024-11-22 11:57:09] iter = 0890, loss = 52.2710
2024-11-22 11:58:23: [2024-11-22 11:58:23] iter = 0900, loss = 44.3814
2024-11-22 11:59:36: [2024-11-22 11:59:36] iter = 0910, loss = 56.9367
2024-11-22 12:00:52: [2024-11-22 12:00:52] iter = 0920, loss = 63.8661
2024-11-22 12:02:02: [2024-11-22 12:02:02] iter = 0930, loss = 46.3492
2024-11-22 12:03:13: [2024-11-22 12:03:13] iter = 0940, loss = 55.4580
2024-11-22 12:04:24: [2024-11-22 12:04:24] iter = 0950, loss = 64.1756
2024-11-22 12:05:40: [2024-11-22 12:05:40] iter = 0960, loss = 52.7397
2024-11-22 12:06:57: [2024-11-22 12:06:57] iter = 0970, loss = 52.7206
2024-11-22 12:08:06: [2024-11-22 12:08:06] iter = 0980, loss = 50.0794
2024-11-22 12:09:19: [2024-11-22 12:09:19] iter = 0990, loss = 63.3366
2024-11-22 12:10:22: -------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
2024-11-22 12:10:22: DSA augmentation strategy: 
color_crop_cutout_flip_scale_rotate
2024-11-22 12:10:22: DSA augmentation parameters: 
{'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'Siamese': True, 'latestseed': 22430}
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 12:11:21: Evaluate 5 random ConvNet, ACCmean = 0.3575 ACCstd = 0.0135
-------------------------
2024-11-22 12:11:21: Evaluate 5 random ConvNet, F1mean = 0.2888 F!std = 0.0052
-------------------------
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4289: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
/data/users/xiongyuxuan/anaconda3/envs/DD/lib/python3.8/site-packages/torch/nn/functional.py:4227: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
2024-11-22 12:11:28: [2024-11-22 12:11:28] iter = 1000, loss = 55.4744
2024-11-22 12:11:28: 
==================== Final Results ====================

2024-11-22 12:11:28: Run 5 experiments, train on ConvNet, evaluate 25 random ConvNet, mean  = 36.93%  std = 1.72%

[2024-11-22 07:52:55] Evaluate_00: epoch = 1000 train time = 14 s train loss = 0.011830 train acc = 1.0000, test acc = 0.2545, test_sen =0.2383, test_spe =0.8934, test_f1 =0.2098
[2024-11-22 07:53:11] Evaluate_01: epoch = 1000 train time = 14 s train loss = 0.013229 train acc = 1.0000, test acc = 0.2646, test_sen =0.2401, test_spe =0.8941, test_f1 =0.2146
[2024-11-22 07:53:28] Evaluate_02: epoch = 1000 train time = 13 s train loss = 0.014089 train acc = 1.0000, test acc = 0.2668, test_sen =0.2401, test_spe =0.8944, test_f1 =0.2171
[2024-11-22 07:53:44] Evaluate_03: epoch = 1000 train time = 14 s train loss = 0.041322 train acc = 1.0000, test acc = 0.2560, test_sen =0.2408, test_spe =0.8935, test_f1 =0.2139
[2024-11-22 07:53:59] Evaluate_04: epoch = 1000 train time = 11 s train loss = 0.001358 train acc = 1.0000, test acc = 0.2607, test_sen =0.2387, test_spe =0.8938, test_f1 =0.2121
[2024-11-22 09:02:21] Evaluate_00: epoch = 1000 train time = 10 s train loss = 0.011676 train acc = 1.0000, test acc = 0.3605, test_sen =0.3096, test_spe =0.9079, test_f1 =0.2829
[2024-11-22 09:02:33] Evaluate_01: epoch = 1000 train time = 9 s train loss = 0.031413 train acc = 1.0000, test acc = 0.3452, test_sen =0.3013, test_spe =0.9053, test_f1 =0.2761
[2024-11-22 09:02:44] Evaluate_02: epoch = 1000 train time = 9 s train loss = 0.008396 train acc = 1.0000, test acc = 0.3579, test_sen =0.3119, test_spe =0.9077, test_f1 =0.2862
[2024-11-22 09:02:58] Evaluate_03: epoch = 1000 train time = 11 s train loss = 0.010008 train acc = 1.0000, test acc = 0.3409, test_sen =0.3055, test_spe =0.9060, test_f1 =0.2780
[2024-11-22 09:03:09] Evaluate_04: epoch = 1000 train time = 8 s train loss = 0.035112 train acc = 1.0000, test acc = 0.3343, test_sen =0.3084, test_spe =0.9052, test_f1 =0.2799
[2024-11-22 10:04:55] Evaluate_00: epoch = 1000 train time = 10 s train loss = 0.034424 train acc = 1.0000, test acc = 0.3577, test_sen =0.3205, test_spe =0.9080, test_f1 =0.2915
[2024-11-22 10:05:06] Evaluate_01: epoch = 1000 train time = 9 s train loss = 0.008051 train acc = 1.0000, test acc = 0.3682, test_sen =0.3285, test_spe =0.9093, test_f1 =0.2986
[2024-11-22 10:05:18] Evaluate_02: epoch = 1000 train time = 9 s train loss = 0.013886 train acc = 1.0000, test acc = 0.3431, test_sen =0.3303, test_spe =0.9072, test_f1 =0.2884
[2024-11-22 10:05:30] Evaluate_03: epoch = 1000 train time = 9 s train loss = 0.175492 train acc = 0.9875, test acc = 0.3722, test_sen =0.3305, test_spe =0.9095, test_f1 =0.2992
[2024-11-22 10:05:41] Evaluate_04: epoch = 1000 train time = 9 s train loss = 0.018657 train acc = 1.0000, test acc = 0.3697, test_sen =0.3312, test_spe =0.9098, test_f1 =0.2983
[2024-11-22 10:06:10] Evaluate_00: epoch = 1000 train time = 12 s train loss = 0.017704 train acc = 1.0000, test acc = 0.2979, test_sen =0.2633, test_spe =0.8996, test_f1 =0.2499
[2024-11-22 10:06:24] Evaluate_01: epoch = 1000 train time = 11 s train loss = 0.037447 train acc = 1.0000, test acc = 0.3068, test_sen =0.2596, test_spe =0.9000, test_f1 =0.2501
[2024-11-22 10:06:35] Evaluate_02: epoch = 1000 train time = 9 s train loss = 0.001093 train acc = 1.0000, test acc = 0.3032, test_sen =0.2628, test_spe =0.9000, test_f1 =0.2512
[2024-11-22 10:06:47] Evaluate_03: epoch = 1000 train time = 10 s train loss = 0.002475 train acc = 1.0000, test acc = 0.3026, test_sen =0.2612, test_spe =0.8998, test_f1 =0.2484
[2024-11-22 10:07:01] Evaluate_04: epoch = 1000 train time = 10 s train loss = 0.035647 train acc = 0.9875, test acc = 0.2959, test_sen =0.2599, test_spe =0.8994, test_f1 =0.2485
[2024-11-22 11:08:39] Evaluate_00: epoch = 1000 train time = 10 s train loss = 0.002063 train acc = 1.0000, test acc = 0.3576, test_sen =0.3229, test_spe =0.9079, test_f1 =0.2908
[2024-11-22 11:08:51] Evaluate_01: epoch = 1000 train time = 10 s train loss = 0.002205 train acc = 1.0000, test acc = 0.3577, test_sen =0.3202, test_spe =0.9077, test_f1 =0.2943
[2024-11-22 11:09:03] Evaluate_02: epoch = 1000 train time = 9 s train loss = 0.029904 train acc = 1.0000, test acc = 0.3635, test_sen =0.3181, test_spe =0.9075, test_f1 =0.2921
[2024-11-22 11:09:15] Evaluate_03: epoch = 1000 train time = 10 s train loss = 0.150224 train acc = 0.9750, test acc = 0.3636, test_sen =0.3217, test_spe =0.9083, test_f1 =0.2917
[2024-11-22 11:09:28] Evaluate_04: epoch = 1000 train time = 10 s train loss = 0.070296 train acc = 0.9875, test acc = 0.3706, test_sen =0.3213, test_spe =0.9084, test_f1 =0.2935
[2024-11-22 12:10:32] Evaluate_00: epoch = 1000 train time = 7 s train loss = 0.014349 train acc = 1.0000, test acc = 0.3615, test_sen =0.3141, test_spe =0.9074, test_f1 =0.2903
[2024-11-22 12:10:45] Evaluate_01: epoch = 1000 train time = 10 s train loss = 0.071273 train acc = 1.0000, test acc = 0.3823, test_sen =0.3189, test_spe =0.9096, test_f1 =0.2983
[2024-11-22 12:10:58] Evaluate_02: epoch = 1000 train time = 10 s train loss = 0.038411 train acc = 1.0000, test acc = 0.3480, test_sen =0.3114, test_spe =0.9060, test_f1 =0.2853
[2024-11-22 12:11:09] Evaluate_03: epoch = 1000 train time = 9 s train loss = 0.038047 train acc = 1.0000, test acc = 0.3476, test_sen =0.3095, test_spe =0.9058, test_f1 =0.2835
[2024-11-22 12:11:21] Evaluate_04: epoch = 1000 train time = 9 s train loss = 0.026634 train acc = 1.0000, test acc = 0.3482, test_sen =0.3126, test_spe =0.9063, test_f1 =0.2867
